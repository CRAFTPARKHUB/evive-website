import{a as fm,b as $m}from"https://app.framerstatic.com/chunk-7MXPQYQK.mjs";import{d as kn,n as Rm}from"https://app.framerstatic.com/chunk-Z2TAP7WE.mjs";import{e as Ia}from"https://app.framerstatic.com/chunk-6463HVPD.mjs";import{a as ym}from"https://app.framerstatic.com/chunk-WAFDZ45U.mjs";import{a as Gm}from"https://app.framerstatic.com/chunk-KIBZKUHS.mjs";import{a as hm}from"https://app.framerstatic.com/chunk-YE25YANI.mjs";import{b as TA,c as cm}from"https://app.framerstatic.com/chunk-WHMMCPJJ.mjs";import{a as Uj}from"https://app.framerstatic.com/chunk-D7MEQ7Y3.mjs";import{d as Ba}from"https://app.framerstatic.com/chunk-FBQARHEO.mjs";import{e as sm,g as sl,q as lm}from"https://app.framerstatic.com/chunk-E345PSYW.mjs";import{a as Ls,b as xd,c as qs,e as dm,f as pm,g as rh,h as Hj,i as mm,k as Em,n as Bm}from"https://app.framerstatic.com/chunk-7DKW2K2C.mjs";import{a as Jj}from"https://app.framerstatic.com/chunk-EZ7MH3HB.mjs";import{a as um,d as ga,g as $r,l as Sa}from"https://app.framerstatic.com/chunk-3ASAZPNM.mjs";import{$ as Yr,$a as fu,A as Ak,B as jk,Cb as Y6,Cf as Er,E as ht,Ee as jt,F as ek,Fa as $k,Fc as ua,Fe as Vj,G as ja,H as eh,I as lk,Ic as vu,J as ck,Kc as Tu,Kg as nm,Lc as Pu,Ld as Ea,M as ea,Ma as ka,Md as Uu,N as P6,Nc as Mu,O as M6,Oa as z6,Pa as cu,Pe as Zu,Qa as du,Ra as pu,Rf as fa,Sc as _u,Ta as ku,Tc as bt,U as dk,Ub as pe,Uc as kr,Ue as Am,Ug as dn,V as Ye,Ve as ur,Vg as im,We as jm,Wg as $a,Xe as em,Ya as uu,Yg as am,Za as mu,_a as Eu,_e as tm,a as rr,ab as Bu,ac as Gu,ad as Du,af as el,ag as ol,bd as Nu,bg as rm,cb as gu,cd as xu,cg as cn,dc as Su,dd as Ou,dg as nl,e as I6,ec as yu,ed as wu,ef as mr,eg as om,fc as bu,fe as Wu,gb as X6,gc as Z6,gd as Al,ha as kk,ib as hu,ig as il,ja as uk,jd as qu,jf as tl,ka as Ek,ld as oo,m as zo,md as Pj,ne as zu,p as G6,pa as jn,q as S6,qb as Ru,qd as Ku,r as or,ra as en,rb as Iu,rd as ma,s as y6,sa as ta,t as b6,u as Yo,v as C6,vd as Vu,w as v6,wd as Ju,we as Xu,x as Zo,xc as Cu,xe as Yu,y as Wr,yd as Hu,yf as rl,zd as Qu}from"https://app.framerstatic.com/chunk-2FGNEAA5.mjs";import{e as tr,g as Wo,h as R6,q as $u,u as Fu,v as At}from"https://app.framerstatic.com/chunk-5E2OZGDR.mjs";import{a as jl,d as Lu}from"https://app.framerstatic.com/chunk-UJZ2TDVM.mjs";import{a as th,f as BA}from"https://app.framerstatic.com/chunk-VZFPCGNJ.mjs";import{Ee as al}from"https://app.framerstatic.com/chunk-N4BEROE5.mjs";import{a as ki,b as Od,c as Im,d as Fa,e as Ga,g as Fm,h as XA,i as ya,l as pl,n as Qj}from"https://app.framerstatic.com/chunk-HHZD2RYV.mjs";import{a as pn,b as ha,c as Ra,d as gm}from"https://app.framerstatic.com/chunk-RLD2AJHB.mjs";import{a as dl,b as fr}from"https://app.framerstatic.com/chunk-L4JV7UON.mjs";import{m as Sm}from"https://app.framerstatic.com/chunk-XUXA5YDO.mjs";import{$c as sr,Ac as Ck,Ag as pa,Bb as te,Bc as vk,Bg as sn,C as It,Cb as fk,Cc as nn,Cd as to,Cg as Ze,Db as N6,Dc as q6,E as Bj,Ec as Tk,F as An,Fb as St,Fc as Zr,Fd as Jk,Ff as hj,Gc as Ao,Gd as Hk,Gf as H6,Gg as dr,Hc as jo,Ic as Pk,Jb as Bk,Jc as Mk,Je as Xk,Kb as ra,Kc as _k,Ke as la,L as T6,La as Gt,Lb as x6,Ld as Qk,Le as ca,Ma as _6,Mb as gk,Me as Yk,Mg as oe,Ne as da,Oc as Dk,Pc as Nk,Qd as Uk,Rb as hk,S as nk,Sc as ce,Ta as ir,Tb as oa,Tc as K6,U as ik,Uc as bA,V as ak,Vc as ia,Vf as ru,W as sk,Wb as na,We as de,Xb as Rk,Xc as eo,Xd as Wk,Yb as Ik,Yc as xk,Yf as ou,Zc as ar,_c as Ok,a as Yi,ad as wk,af as ju,ag as nu,b as Yp,bh as au,c as Zp,cg as Q6,e as Xo,eb as pk,ef as eu,eg as iu,fc as Fk,g as F6,ga as Tj,hc as O6,he as an,if as V6,ig as U6,ih as su,jc as w6,jd as Lk,ji as W6,k as vA,kh as ln,l as zr,lg as ro,mf as tu,mh as lu,o as Zi,p as Aa,pc as Gk,pd as qk,r as Ge,rb as D6,rc as re,ri as pr,sd as aa,sf as cr,td as Kk,te as sa,tf as yt,ua as ze,ub as bj,uc as L6,ue as zk,v as Xr,vc as yk,wb as mk,wc as tn,xc as rn,xd as Vk,y as Rt,yc as on,yd as ye,yf as J6,zc as bk,zg as DA}from"https://app.framerstatic.com/chunk-WAL5VQWN.mjs";import{$c as E7,$h as x7,$i as U7,$p as Qe,Ad as rA,Ae as y7,Ai as Ko,Aj as je,An as fp,Ao as Rp,As as qp,Bd as oj,Be as b7,Bg as Pi,Bh as Wt,Bj as ij,Bn as ft,Bq as Tp,Bs as Kp,Cb as hi,Cd as Ae,Ch as mt,Cn as $j,Cr as Uo,Cs as Vp,Db as vj,Dd as J,Dh as N7,Dj as GA,Dn as Vi,Do as Ip,Ds as Jp,Eb as _r,Ed as qj,En as Ji,Ep as Cp,Es as Hp,Fb as _o,Fd as sj,Fi as Vo,Fn as $t,Fp as Wi,Gb as e7,Gd as Nr,Gi as J7,Go as Fp,Hb as QA,Hd as Qt,He as C7,Hg as Mi,Hi as zt,Hm as ee,Hr as We,Id as qA,Ii as H7,Ij as X7,Ik as Nj,Iq as gt,Jb as jj,Jd as z,Jg as ut,Jm as Qo,Js as Qp,Kb as hA,Kd as xo,Ke as WA,Ki as i6,Km as Li,Lb as t7,Ld as xr,Lg as _i,Lj as Kr,Lt as OA,Mb as r7,Md as ej,Me as $A,Mt as q,N as rj,Nb as Do,Nd as le,Ne as t6,Nm as Zt,Nn as $p,O as Us,Od as SA,Ok as Ke,Op as k6,Oq as Pp,Os as Up,Ot as yj,P as Ws,Pd as Oo,Po as Gp,Q as sA,Qc as m7,Qd as lt,Qm as uA,Qn as Hr,Qo as Ar,Qt as gj,R as Ud,Rj as Y7,Rq as Mp,Rt as B,Sc as A6,Sj as s6,Sl as rp,Sp as u6,St as nr,Tb as o7,Tq as $6,U as $i,Ub as Ri,Uc as UA,Uh as pj,Ul as c6,Un as Qr,Vh as qo,Vi as Q7,Vj as Z7,Vm as Jr,W as Wd,Wb as n7,Wd as f7,Wh as kj,Wo as Sp,Wq as zi,X as w,Xb as Ii,Xc as j6,Xd as $7,Xi as a6,Xj as l6,Xm as lp,Xn as Bp,Xt as Se,Y as zs,Yc as Dj,Yt as Ft,Ze as v7,_b as i7,_d as bi,_j as Ap,_o as p6,ad as Gi,ai as O7,aj as Oi,ak as jp,bb as Zd,bc as No,bd as ge,bu as tk,c as Ks,cb as Xs,ce as B7,ci as w7,cj as qe,cm as Vr,cr as Ue,cs as xp,ct as Ur,d as Ne,db as Ys,dc as Ht,de as g7,dh as _7,dn as Ie,dr as B6,dt as Xi,e as Vs,eb as A7,ec as a7,ed as ie,ee as h7,eg as Ut,eh as Lo,ei as Di,eq as vp,et as er,fb as Zs,fd as ae,fe as Or,fi as L7,fm as Xt,fp as yp,ga as Gj,gc as Be,gd as Si,gi as Ni,gj as W7,gq as Fe,gr as _p,gu as rk,h as wd,he as ct,hi as n6,hl as Ve,hu as ok,ic as Fi,ie as wr,ir as g6,jc as pA,je as R7,ji as VA,jp as He,jq as m6,k as Ld,kc as Lj,ke as dt,ki as Lr,kl as tp,km as Yt,kn as cp,kr as Dp,ks as Op,kt as Wp,l as V,la as Bi,le as I7,lh as D7,lk as ep,lm as op,lo as gp,m as _A,me as Ci,mm as np,mo as Hi,mt as zp,nc as c7,ne as F7,nm as Je,nn as dp,no as Qi,om as ip,op as jr,ou as Xe,pe as vi,pm as ap,pn as pp,pq as E6,pr as Np,pu as lr,qe as pt,qg as fj,qi as q7,qn as kp,r as Mo,rc as d7,rd as he,re as kt,rg as wo,rj as z7,rn as qi,ro as Kj,rr as h6,ru as Zk,s as Js,sb as j7,sc as p7,sd as Dr,si as K7,sj as CA,su as Au,td as fA,te as Ti,tj as nj,tm as sp,to as hp,ua as gi,uc as k7,ud as LA,ue as we,ug as T7,ui as V7,uj as wi,um as Ho,un as Ki,vd as Oe,vi as JA,vj as qr,vq as f6,wd as se,we as Re,wi as xi,wn as d6,wo as Bt,wp as bp,xd as e6,xe as G7,xn as up,ye as S7,yg as P7,yn as mp,yo as Ui,ys as wp,yt as Xp,zc as u7,zd as yi,ze as Le,zg as M7,zj as Jo,zn as Ep,zs as Lp}from"https://app.framerstatic.com/chunk-YIQ5HVZM.mjs";import{s as s7,u as l7}from"https://app.framerstatic.com/chunk-XAFQO7US.mjs";import{a as Sk}from"https://app.framerstatic.com/chunk-4I3XDWXC.mjs";import{a as Jt,b as mi}from"https://app.framerstatic.com/chunk-4AQCMAAQ.mjs";import{a as km,c as ll,d as cl}from"https://app.framerstatic.com/chunk-WAAMG33M.mjs";import{b as tj}from"https://app.framerstatic.com/chunk-AUNF3KWQ.mjs";import{H as zA,b as Ei,d as qd,e as Hs,f as Kd,j as fi,l as Qs,n as Vd,o as Jd,p as Hd,r as Qd,u as r6,w as o6}from"https://app.framerstatic.com/chunk-5NKPNTS7.mjs";import{a as st,b as M,d as Z,e as _j,f as Aj,i as oA,j as Zj,k as Xd,l as Sj,o as xe,q as Yd}from"https://app.framerstatic.com/chunk-ZQUNXESX.mjs";import{Xd as Et,a as ui,b as Mr,zc as zd}from"https://app.framerstatic.com/chunk-M7LXWNTO.mjs";import{f as Ej}from"https://app.framerstatic.com/chunk-PFHOMMMY.mjs";import{a as at,b as _d,c as Dd,d as Nd,e as Pr,g as pi}from"https://app.framerstatic.com/chunk-72P4HPJP.mjs";import{c as ws,f as De}from"https://app.framerstatic.com/chunk-WIUFUKXG.mjs";import{A as ne,B as KA,C as aj,E as Yj,F as li,G as _e,H as ci,I as Kt,J as jA,K as Td,L as Tr,O as di,P as Os,Q as Pd,R as fe,S as To,T as Po,Y as $e,a as Sd,aa as Md,ba as Vt,e as xs,i as yd,k as yA,n as bd,o as me,q as Cd,t as mA,x as qt,y as Xj,z as vd}from"https://app.framerstatic.com/chunk-GQILM44Y.mjs";import{a as E,b as cA}from"https://app.framerstatic.com/chunk-WNSBRACC.mjs";import{a as Ee}from"https://app.framerstatic.com/chunk-LQILWJHN.mjs";import{e as Fj,j as R,k as tA,l as xA,m as FA,n as vo,o as Ns}from"https://app.framerstatic.com/chunk-AHQIRSXG.mjs";var Cm=Fj(th());var vm=Fj(ui());var zy=vm.default.createContext("not-defined");var bm={store_internal:2,store_browse:2,store_use_installed:2},kl={},ba=new Cm.FramerTracking({sourceName:"framer-x",trackingURL:Ee().events+"/track",verbose:window.localStorage&&window.localStorage.getItem("debug-metrics")==="active",addContext:A=>{for(let j in kl)A[j]===void 0&&(A[j]=kl[j])}}),oh;(t=>(t.init=function(r){let{appVersion:o,projectId:n}=r;Object.assign(kl,{appVersion:o,projectId:n}),ba.setUserId(r.userId)},t.push=function(r){let{name:o,type:n,...a}=r;r.type==="store_internal"?(delete a.action,ba.track({type:"track",event:o,version:2,...a})):ba.track({type:"track",event:n,version:bm[n],name:o,...a})},t.pushEvent=function(r){let{event:o,...n}=r;ba.track({...n,type:"track",event:o,version:bm[o]})}))(oh||={});var nh=new Set(No({fillImageLocalized:!0,formInputPlaceholderLocalized:!0,htmlLocalized:!0,altAttributeLocalized:!0,titleLocalized:!0,descriptionLocalized:!0,linkLocalized:!0}));function ul(A){return nh.has(A)}function Ca(A){return A.map(j=>_j(j)?va(j):Aj(j)?Ca(j):j)}function ih(A){return A.endsWith("Localized")}function va(A){let j={};for(let e in A){if(ih(e))continue;let t=A[e];_j(t)?j[e]=va(t):Aj(t)?j[e]=Ca(t):j[e]=t}return j}function tb(A){let j={};for(let e in A){if(ul(e))continue;if(!n6(e)){j[e]=A[e];continue}let t=A[e];_j(t)?j[e]=va(t):Aj(t)?j[e]=Ca(t):j[e]=t}return j}function Tm(A){let j={};for(let e in A){if(ul(e))continue;if(!n6(e)){j[e]=A[e];continue}let t=A[e];_j(t)?j[e]=va(t):Aj(t)?j[e]=Ca(t):j[e]=t}return j}var{onewayMethodTemplate:Eb,voidMethodTemplate:Pm,valueMethodTemplate:ml,streamMethodTemplate:fb}=pi,El;(j=>j.service={id:"__ElectronWebRendering__",fingerprint:"55e7a2685b81eb6008c3d91a35ec44f1",methods:{collectMetrics:{},openSaveDialog:{},willOpenWindow:{},writeToClipboard:{},writeToDisk:{}},newOutgoingWrapper:e=>({collectMetrics:ml.bind(-1,"collectMetrics",!1,e),openSaveDialog:ml.bind(-1,"openSaveDialog",!0,e),willOpenWindow:ml.bind(-1,"willOpenWindow",!0,e),writeToClipboard:Pm.bind(-1,"writeToClipboard",!0,e),writeToDisk:Pm.bind(-1,"writeToDisk",!0,e)})})(El||={});var fl;(t=>{t.service=El.service;function j(r){let o=at.shared();return{expect:()=>o.expectWithoutDiscovery(t.service,r),discover:n=>o.discover(t.service,r,n),register:n=>o.register({channel:r,service:t.service,implementation:n})}}t.on=j;async function e(r){at.shared().unregister(r)}t.unregister=e})(fl||={});var{onewayMethodTemplate:_b,voidMethodTemplate:Mm,valueMethodTemplate:Ta,streamMethodTemplate:Db}=pi,$l;(j=>j.service={id:"__ElectronWebRenderingV2__",fingerprint:"6c902a5850607b51714e2b27dafbde81",methods:{collectMetrics:{},openSaveDialog:{},willOpenWindow:{},writeToClipboard:{},writeToDisk:{},getImageData:{}},newOutgoingWrapper:e=>({collectMetrics:Ta.bind(-1,"collectMetrics",!1,e),openSaveDialog:Ta.bind(-1,"openSaveDialog",!0,e),willOpenWindow:Ta.bind(-1,"willOpenWindow",!0,e),writeToClipboard:Mm.bind(-1,"writeToClipboard",!0,e),writeToDisk:Mm.bind(-1,"writeToDisk",!0,e),getImageData:Ta.bind(-1,"getImageData",!0,e)})})($l||={});var Bl;(t=>{t.service=$l.service;function j(r){let o=at.shared();return{expect:()=>o.expectWithoutDiscovery(t.service,r),discover:n=>o.discover(t.service,r,n),register:n=>o.register({channel:r,service:t.service,implementation:n})}}t.on=j;async function e(r){at.shared().unregister(r)}t.unregister=e})(Bl||={});function Vb(A,j){if(!A||A.changes.length===0)return!1;for(let e of A.changes){let t=j.get(e.id);if(!$7(t)&&!f7(t)&&!(!t&&e.added==="RedirectRouteNode"))return!1}return!0}function _m(A,j){if(!A||A.changes.length===0)return!1;for(let e of A.changes){let t=j.get(e.id);return!t||!Ue(t)?!1:"variables"in e.from}return!0}function Dm(A,j){if(!A||A.changes.length===0)return!1;for(let e of A.changes){let t=j.get(e.id);if(!Dr(t))return!1;let r="locales";return!!(r in e.from||e.from._deleted?.includes(r))}return!0}var sh=mA("EngineChanges");var Nm=class{constructor(){R(this,"changes",new Set);R(this,"addChanges",(...j)=>{for(let e of j)this.changes.add(e)});R(this,"changeObserverFlags",[]);R(this,"changeObservers",[]);R(this,"inSignalAllObservers",!1);R(this,"observersToRemove",[])}get flags(){return this.changes}has(...j){for(let e of j)if(this.changes.has(e))return!0;return!1}observe(...j){let e=j.pop(),t=j;return Ej.isDebugBuild&&t.some(r=>r===void 0)&&sh.warn("changes.observe was called with undefined as one of the flags. It might be caused by observing a store that hasn't been instantiated yet."),this.changeObserverFlags.push(t),this.changeObservers.push(e),e}observeWithComponent(j,e,t){this.changeObserverFlags.push(j);let r=()=>{Ej.benchmarkSkipRendering||e.setState(t())};return this.changeObservers.push(r),r}removeObserver(j){if(this.inSignalAllObservers){this.observersToRemove.push(j);return}let e=this.changeObservers.indexOf(j);e!==-1&&(this.changeObserverFlags.splice(e,1),this.changeObservers.splice(e,1))}signalAllObservers(){if(!this.changes)return;let j=this.changes,e=this.changeObserverFlags,t=this.changeObservers;this.inSignalAllObservers=!0;for(let r=0;r<e.length;r++){let o=e[r];for(let n of o)if(j.has(n)){t[r]();break}}if(this.inSignalAllObservers=!1,this.observersToRemove.length>0){for(let r of this.observersToRemove)this.removeObserver(r);this.observersToRemove.length=0}this.changes.clear()}signalObserversFor(...j){let e=new Set(j),t=this.changeObserverFlags,r=this.changeObservers;for(let o=0;o<t.length;o++){let n=t[o];for(let a of n)if(e.has(a)){r[o]();break}}e.forEach(o=>this.changes.delete(o))}};function gl(A){return A.userIsViewer?sl:Ej.isAutomation||Ej.isTest?sm:A.acl.find(e=>e.user.id===A.userId)?.permissions??sl}var un=class{constructor(j){this.aclPermissions=j}get canDesign(){return this.aclPermissions.canDesign==="on"}get canEditContent(){return this.aclPermissions.canEditContent==="on"}get canPublish(){return this.aclPermissions.canPublish==="on"}get canEditSiteSettings(){return this.canDesign&&this.canEditContent&&this.canPublish}get canPublishToStaging(){return this.canDesign||this.canEditContent||this.canPublish}get canInviteCollaborators(){return this.canDesign||this.canEditContent||this.canPublish}get canEditVariables(){return this.canDesign}get canAddCollections(){return this.canDesign}get canEditAnalytics(){return this.canDesign||this.canEditContent||this.canPublish}get canStartStopAbTest(){return this.canPublish}get canEditLocales(){return this.canDesign}get canEditLocalizedValues(){return this.canEditContent}get canSendDiffs(){return this.canDesign||this.canEditContent}},eC=W7({canDesign:"Design",canEditContent:"Content",canPublish:"Deploy",canEditSiteSettings:"Design and Content and Deploy",canPublishToStaging:"Design or Content or Deploy",canInviteCollaborators:"Design or Content or Deploy",canEditVariables:"Design",canAddCollections:"Design",canEditAnalytics:"Design or Content or Deploy",canEditLocales:"Design",canEditLocalizedValues:"Content",canSendDiffs:"Design or Content",canStartStopAbTest:"Deploy"});function tC(A){let j=gl(A);return new un(j)}var hl=A=>[A.stores.chromeStore,A.stores.projectStore,A.stores.sessionStore],Pa=([A,j,e])=>({userIsViewer:A.userIsViewer,acl:j.acl,userId:e.user.id});function rC(A,j,{signal:e}){let t=hl(A),r=Pa(t),o=A.changes.observe(...t,()=>{let n=Pa(t);Be(r,n)||(r=n,j(n))});e.addEventListener("abort",()=>{A.changes.removeObserver(o)},{once:!0})}function aC(){let A=qu();return E(Rl(A),"Expected OnPageEngine"),A}function Rl(A){return A.name==="OnPageEngine"}var xm=A=>[A.stores.loadingStore,...hl(A)],Il=([A,...j])=>({isReady:A.isReady,...Pa(j)});function lh(A,j){if(!A.isReady||A.userIsViewer)return!0;let e=gl(A);return!new un(e)[j]}function mn(A,j){return oo(A)?lh(Il(xm(A)),j):!Rl(A)}function kC(A,j,{signal:e}){let t=xm(A),r=Il(t),o=A.changes.observe(...t,()=>{let n=Il(t);Be(r,n)||(r=n,j(n))});e.addEventListener("abort",()=>{A.changes.removeObserver(o)},{once:!0})}var ch={track:!0};function Om(A){let j={...A,event:"canvas_page_add"};tj(j,ch)}var dh={track:!0};function wm(A){let j={...A,event:"canvas_page_select"};tj(j,dh)}var ph={track:!0};function Lm(A){let j={...A,event:"component_canvas_create"};tj(j,ph)}var kh={track:!0};function qm(A){let j={...A,event:"component_canvas_enter"};tj(j,kh)}var uh={track:!0};function Km(A){let j={...A,event:"component_canvas_variant_create"};tj(j,uh)}var mh={track:!0};function Fl(A){let j={...A,event:"component_design_instance"};tj(j,mh)}var Eh={track:!0};function Gl(A){let j={...A,event:"export_bitmap"};tj(j,Eh)}var fh={track:!0};function Vm(A){let j={...A,event:"external_component_insert"};tj(j,fh)}var $h={track:!0};function Jm(A){let j={...A,event:"property_layout_update"};tj(j,$h)}var Bh={track:!0};function Hm(A){let j={...A,event:"variable_reference_create"};tj(j,Bh)}var Qm=class extends re{constructor(e,t){super();this.addChanges=e;this.effectsStore=t;R(this,"update",0);R(this,"tooltip");R(this,"shapeToolActive",!1);R(this,"feedbackModeActive",!1);R(this,"handle",null);R(this,"straightLineAnchorIndex",0);R(this,"proseMirrorView",null);R(this,"proseMirrorState",null);R(this,"textLink",null);R(this,"editedTextLink");R(this,"stackInsertionIndicator",null);R(this,"replaceableFloatingPositionNode",null);R(this,"activeTool",0);R(this,"nodeInTextEditor",pj);R(this,"nodeInPathEditorOffset",null);R(this,"dragAndDropPlaceholders",null);R(this,"codeComponentInProgressInsertionIndicatorNodeIDs",new Set)}get tool(){return this.activeTool}postProcess(e){this.update=e}get isDefaultToolActive(){return this.tool===0||this.tool===1}updateDragAndDropPlaceholder(e){if(e){let t=e.cache.placeholders,r=t?{id:e.id,placeholders:t}:null;if(gi(r,this.dragAndDropPlaceholders))return;this.dragAndDropPlaceholders=r}else this.dragAndDropPlaceholders=null}setTool(e){An.canEditTree(e)&&e!==6&&this.effectsStore.exitPreview(),this.shapeToolActive=hh(e),Rh(e)||(this.feedbackModeActive=!1),this.tool===6&&e!==6&&this.addChanges("ExitMove"),this.tool!==e&&this.addChanges("Tool"),this.activeTool=e}};function gh(A){switch(A){case 21:case 10:case 22:case 24:case 23:case 12:case 11:case 20:case 13:case 19:case 14:case 45:case 29:case 39:case 44:case 27:case 38:case 28:case 25:return!1;case 40:case 41:case 15:case 17:case 16:case 18:case 1:case 36:case 32:case 42:case 0:case 43:case 9:case 37:case 6:case 30:case 3:case 33:case 35:case 7:case 26:case 8:case 34:case 46:case 2:case 47:case 31:case 4:case 5:return!0;default:cA(A)}}function hh(A){switch(A){case 40:case 41:case 21:case 10:case 22:case 24:case 23:case 12:case 11:case 20:case 13:case 19:case 14:case 45:case 1:case 36:case 32:case 42:case 0:case 43:case 39:case 44:case 37:case 6:case 30:case 3:case 35:case 7:case 26:case 27:case 28:case 29:case 8:case 34:case 46:case 2:case 38:case 25:case 47:case 31:case 4:case 5:return!1;case 15:case 17:case 16:case 18:case 9:case 33:return!0;default:cA(A)}}function Rh(A){switch(A){case 40:case 41:case 3:case 4:case 5:return!0;case 0:case 1:case 2:case 6:case 7:case 46:case 8:case 9:case 10:case 11:case 12:case 45:case 13:case 14:case 15:case 16:case 17:case 18:case 19:case 20:case 21:case 22:case 24:case 23:case 25:case 26:case 27:case 28:case 29:case 30:case 32:case 33:case 34:case 35:case 36:case 37:case 38:case 39:case 42:case 47:case 31:case 43:case 44:return!1;default:cA(A)}}function VC(A){switch(A){case 4:case 5:return!0;case 0:case 1:case 2:case 3:case 6:case 7:case 46:case 8:case 9:case 10:case 11:case 12:case 45:case 13:case 14:case 15:case 16:case 17:case 18:case 19:case 20:case 21:case 22:case 24:case 23:case 25:case 26:case 27:case 28:case 29:case 30:case 32:case 33:case 34:case 35:case 36:case 37:case 38:case 39:case 40:case 41:case 42:case 47:case 31:case 43:case 44:return!1;default:cA(A)}}function zm(A){switch(A){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 40:case 41:case 47:case 44:return!0;case 7:case 46:case 8:case 9:case 10:case 11:case 12:case 45:case 13:case 14:case 15:case 16:case 17:case 18:case 19:case 20:case 21:case 22:case 24:case 23:case 25:case 26:case 27:case 28:case 29:case 30:case 32:case 33:case 34:case 35:case 36:case 37:case 38:case 39:case 42:case 31:case 43:return!1;default:cA(A)}}function JC(A){switch(A){case 3:case 4:case 44:return!0;case 5:case 6:case 0:case 1:case 2:case 40:case 41:case 47:case 7:case 46:case 8:case 9:case 10:case 11:case 12:case 45:case 13:case 14:case 15:case 16:case 17:case 18:case 19:case 20:case 21:case 22:case 24:case 23:case 25:case 26:case 27:case 28:case 29:case 30:case 32:case 33:case 34:case 35:case 36:case 37:case 38:case 39:case 42:case 31:case 43:return!1;default:cA(A)}}function Xm(A){switch(A){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 47:return!0;case 40:case 41:case 7:case 46:case 8:case 9:case 10:case 11:case 12:case 45:case 13:case 14:case 15:case 16:case 17:case 18:case 19:case 20:case 21:case 22:case 24:case 23:case 25:case 26:case 27:case 28:case 29:case 30:case 32:case 33:case 34:case 35:case 36:case 37:case 38:case 39:case 42:case 31:case 43:case 44:return!1;default:cA(A)}}function HC(A,j){return A.stores.historyStore.isLoadingDocument?j===44:mn(A,"canDesign")?zm(j):A.stores.chromeStore.isPreviewingFeaturedTemplate?Xm(j):!0}function QC(A,j){return j==="VectorSet"?gh(A):!(j==="WebPage"&&A===39)}function UC(A,j){if(mn(A,"canDesign")&&!zm(j))throw Error("Viewer mode: Tool "+j+" is a forbidden action.");if(A.stores.chromeStore.isPreviewingFeaturedTemplate&&!Xm(j))throw Error("Previwing template mode: Tool "+j+" is a forbidden action.")}var WC=A=>A===20||A===21||A===22||A===24||A===23||A===19;function zC(A){return A===8||A===7||A===46||A===30||A===32}var Ih={0:!0,1:!0,2:!0,3:!0,4:!0,6:!0,5:!0};function Av(A){return Z(A)&&Ih[A]===!0}var Sl=new Map;function ev(A,j){Sl.set(A,j)}function tv(A){Sl.delete(A)}function Ym(A){Sl.get(A)?.()}var Fh="__page_input";function Gh(A){return`${Fh}_${A}`}function Ma(A){let j=Gh(A);Ym(j)}function _a(A){return rA(A)||J(A)}async function Zm({messages:A,model:j,schema:e,signal:t}){let r=await Ba.post("/ai/v2/chat/",{model:j,messages:A,response_format:{type:"json_schema",json_schema:{strict:!0,name:"schema",schema:e}}},t);try{return JSON.parse(r?.choices?.[0]?.message?.content??"")}catch(o){throw new Error(`Could not process JSON response: ${o}`,{cause:r})}}function En(A,j){if(oA(A))return A;let e=[];for(let t of A)e.push(j.get(t)??t);return e.length>0?e:void 0}function Ce(A,j){if(!ij(j))return null;let e=A.getNode(j.originalid);return E(e,"The original variant node should exist"),e}function Sh(A,j,e){let t=uA.inheritedReplicaNode(A,j.replicaInfo.inheritsFrom),r=Zt(j.replicaInfo.overrides,t?.replicaInfo.overrides);for(let o of e.walk()){let n=r[o.id];if(!n)continue;let{_deleted:a,itemsOrder:i,...s}=n;a?.forEach(c=>s[c]=void 0),A.current(o)?.set(s)}}function AE(A,j){let e=A.getNode(j.originalid),t=uA.getReplicaForTemplateNode(A,j);if(!e||!t||!CA(t))return[];if(!t.replicaInfo.inheritsFrom)return[e];let r=A.getNode(t.replicaInfo.inheritsFrom);if(!r)return[e];let o=ee(r.id,e.id),n=A.getNode(o);return n?[e,n]:[e]}function hv(A,j,e,t){let r=uA.getReplicaForTemplateNode(A.tree,j);E(r,"replica should exist when moving node out of replica"),E(CA(r),"replica must be a variant"),Sh(A.tree,r,e),j.isVisible()&&!e.isVisible()&&A.tree.current(e)?.set({visible:!0}),t.delete(j.id),t.add(e.id)}function fn(A,j,e,t,r){if(!e||!t)return j.id;E(hA(e),"Fail to update variant nodes: parent must be a replica");let o=uA.getReplicaForTemplateNode(A.tree,e);if(E(o,"Fail to update variant nodes: replica should exist"),E(CA(o),"Fail to update variant nodes: replica must be an variant"),Ui(A.tree,e)){A.tree.current(j)?.set({visible:!1});let a={visible:!0};Ar(j)&&r&&(a.itemsOrder=En(j.itemsOrder,r)),dn(A.tree,o,j.id,a)}return ee(o.id,j.id)}function yl(A,j,e,t,r,o){let n=fn(A,j,e,t,o);return r.delete(j.id),r.add(n),n}function Rv(A,j,e){let t=AE(A.tree,j),r=AE(A.tree,e),o=t.find((n,a)=>!n.isVisible()||n.cache.visible===!0?!1:r[a]?.cache.visible??!1);o&&(A.tree.get(o.id)?.set({visible:!1}),j.set({visible:!0},A.tree,!0))}function jE(A,j,e){Bt(A.tree,j).forEach(({replicaRoot:t})=>{if(Object.keys(t.replicaInfo.overrides).every(i=>!e.has(i)))return;let n={...t.replicaInfo},a={...n.overrides};n.overrides=a,e.forEach((i,s)=>{if(s in a){let c={...a[s]},d=c.itemsOrder;"itemsOrder"in c&&Array.isArray(d)&&(c.itemsOrder=En(d,e)),a[i]=Tm(c)}}),A.tree.get(t.id)?.set({replicaInfo:n})})}function eE(A,j,e){return st(e)?e:$A(j)?j.constraintsLocked:!1}function Vv(A,j,e,t){let r=A.tree,o={x:Math.round(e.x-t.width/2),y:Math.round(e.y-t.height/2)},n=r.getNode(j);if(!j||!n)return{left:o.x,top:o.y};let a=gp(A.tree,j),i=a?A.tree.getViewportRect(a):null,s=r.getRect(n),c=r.convertPointToNode(n,o),d={x:c.x,y:c.y,width:t.width,height:t.height},p=d.width/d.height,k=O6(d,{sizing:s,positioning:s,viewport:i,layout:he(n)},null,{aspectRatio:p,shouldGuessPinToBottom:jt(r,null,n),shouldGuessPinToRight:Vj(r,null,n)});return k.aspectRatio=p,k}var bl=(A,j,e,t)=>{let r=j.getGroundNodes().map(o=>A.getRect(o));return t!==void 0&&r.push(...t),r.find(o=>w.intersects(e,o))===void 0},yh=(A,j,e,t,r)=>{let o=j.getGroundNodes().map(i=>A.getRect(i));t!==void 0&&o.push(...t);let a=o.sort((i,s)=>w.maxX(i)>w.maxX(s)?-1:1)[0];return a!==void 0?Tl(a,e,r):null},bh=(A,j,e,t,r)=>{let o=j.getGroundNodes().map(s=>A.getRect(s));t!==void 0&&o.push(...t);let i=o.filter(s=>s.width===e.width&&s.height===e.height||s.height===e.width&&s.width===e.height).sort((s,c)=>w.maxX(s)>w.maxX(c)?-1:1)[0];return i!==void 0?Tl(i,e,r):null},Ch=(A,j,e)=>j.map(t=>A.getNode(t)).filter(t=>Pi.equals(t.rect(null),e));function vl({tree:A,activeScope:j,node:e,size:t,filledRects:r,offsetDistance:o}){let n={...A.getRect(e),...t},a=j.getGroundNodes().map(c=>c.rect());r&&a.push(...r);let i=n,s=0;for(;i;){if(oA(o.x)||(n.x=Cl("x",i,o.x)),oA(o.y)||(n.y=Cl("y",i,o.y)),i=a.find(c=>w.intersects(c,n)),s>a.length)return n;s++}return n}var rE=(A,j,e,t,r={x:100,y:void 0},o)=>vl({tree:A,activeScope:j,node:e,size:t,filledRects:o,offsetDistance:r}),$n=(A,j,e,t,r=100,o)=>vl({tree:A,activeScope:j,node:e,size:t,filledRects:o,offsetDistance:{x:r}}),Jv=(A,j,e,t,r=100,o)=>vl({tree:A,activeScope:j,node:e,size:t,filledRects:o,offsetDistance:{y:r}});function Cl(A,j,e){return(A==="x"?w.maxX:w.maxY)(j)+e}function Tl(A,j,e=100){return{...A,x:Cl("x",A,e),...j}}var vh=(A,j,e,t,r,o,n)=>{if(o){let s=A.getNode(o);if(s)return $n(A,j,s,e,n,r)}if(t){let s=Ch(A,t,e);if(s.length){let d=s.map(k=>Tl(k.rect(),e,n)).find(k=>bl(A,j,k,r));if(d)return d;let p=s[0];return E(p,"Equal frame must be defined"),$n(A,j,p,e,n,r)}}let a=bh(A,j,e,r,n);if(a!==null&&bl(A,j,a,r))return a;let i=yh(A,j,e,r,n);return i!==null&&bl(A,j,i,r)?i:{...e,x:0,y:0}},Hv=(A,j,e,t,r)=>{let o=A.getRect(e),n=A.getParent(e.id),a;SA(e)&&(a=Math.min(o.width,100));let i=vh(A,j,o,t,r,e.id,a);return r.push(i),O6(i,null,ft(e)?$t(e):null,{shouldGuessPinToBottom:!0,shouldGuessPinToRight:Vj(A,e,n)})},Qv=(A,j,e,t)=>{if(e.length>0){let r=e[e.length-1],o=A.getGroundFrameAncestor(r,!0);if(o)return o.id}for(let r of A.sortVisually(A.getNodesAtPoint(j,t)).reverse())if(r instanceof pe&&A.getParent(r.id)===pj){if(hA(r))continue;return r.id}return pj},Uv=(A,j,e)=>{let r=A.tree.newId(),o={top:j.y,left:j.x,width:j.width,height:j.height,overflow:Fe(),isScreen:!0};return o.framePreset=e,A.createFrame(pj,{id:r,...o}),r},Wv=(A,j)=>{let e=A.tree,t=e.newId(),r={top:j.y,left:j.x,width:j.width,height:j.height,overflow:Fe(),isScreen:!0};return A.createFrame(pj,{id:t,...r}),A.stores.scopeStore.active.getGroundNodes(n=>{let a=e.getRect(n);return n.id!==t&&w.containsRect(j,a)}).forEach(n=>{let a=e.getParent(n.id),i=e.getRect(n),s=w.offset(i,sA.reverse(j));A.moveNode(n.id,t),A.tree.current(n)?.set(n.updateForRect({rect:s,parentSizeInfo:{sizing:j,positioning:j,viewport:null,layout:he(a)},constraintsLocked:eE(A,n),shouldGuessPinToBottom:!0,shouldGuessPinToRight:Vj(A.tree,n,a)}))}),t},tE=["#9ef","#4cf","#3af","#38f","#26f"],zv=(()=>{let A=-1,j=tE.length;return()=>(A++,tE[A%j])})();var Th={type:{type:Mo.type,value:Js.type},variantId:{type:Mo.variantId,value:void 0},pauseOffscreen:{type:Mo.pauseOffscreen,value:Js.pauseOffscreen}},oT={type:"type",variantId:"variantId",pauseOffscreen:"pauseOffscreen"},Ph={cycle:!0,set:!0};function nT(A){return M(A)&&A in Ph}function ve(A){return qi(A)&&A.actionIdentifier==="framer/useSetVariant"}function oE(A){return A.controls.type?.value!=="set"?null:A.controls.variantId?.value??null}function iT(A){return Array.isArray(A)&&A.some(ve)}function aT(A){return Array.isArray(A)&&A.some(j=>ve(j)&&j.controls.type?.value==="set"&&!j.controls.variantId?.value)}function sT(A,j){return kp(A,ve,j)}function lT(A,j,e){let t=pp(j,ve,e),r=[];return t.forEach(o=>{switch(o.controls.type?.value){case"set":{let a=o.controls.variantId?.value;a&&r.push(a);break}case"cycle":{let a=A.getScopeNodeFor(j);if(!rA(a))return;let i=a.getTopLevelVariants();if(i.length<=1)return;let s=A.getGroundNodeFor(j),c=i.findIndex($=>$.id===s.id);if(c===-1)return;let d=c+1,p=d>=i.length?0:d,k=i[p];k&&r.push(k.id);break}}}),r}function cT(A){let j={};return Object.entries(A).forEach(([e,t])=>{j[e]=t?.value}),j}function Mh(A,j){return!(A?.inputValue!==j?.inputValue||A?.delay!==j?.delay||A?.key!==j?.key)}function dT(A,j,e){let t=Array.isArray(A)?[...A]:[],r=t.findIndex(ve),o=t[r];if(ve(o)&&Mh(o.meta,e)){let n={...o.controls,...nE(j)},a={...o,controls:n,meta:{...o.meta,...e}};t[r]=a}else{let n=_h(j,void 0,e);t.push(n)}return t}function nE(A){let j={};return Object.entries(A).forEach(([e,t])=>{j[e]={type:Mo[e],value:t}}),j}function _h(A,j,e){let t=nE({...A}),r={identifier:j||Et(),actionIdentifier:"framer/useSetVariant",controls:{...Th,...t}};return e&&Object.assign(r,{meta:e}),r}function pT(A,j){let e={...A.controls,...j};return{...A,controls:e}}function iE(A,j){let e=j.get(A);return bi(e)?e:null}function Pl(A,j,e="transparent"){if(oA(A))return e;if(!qe(A))return A;let t=Oi(A);return(t?iE(t,j):null)?.light??e}function Br(A,j,e,t=!1){if(jk(j)){A.has(j)||A.ensureEntityTypeRootNode(j);return}let r=t?ta(e):en(e);if(A.has(r))return;let o=new jn({id:r});A.insertNode(o,j)}function Dh(A,j){let e=A.tree.get(j);if(Sj(e))return;let t=A.tree.get(e.parentid);if(!Sj(t))return t.children?.findIndex(r=>r.id===j)}function FT(A,j,e){let t=A.tree.getEntityReferenceNode(j);if(Sj(t))return;let r=en(e),o=new jn({id:r}),n=Dh(A,t.id),a=Zj(n)?n+1:void 0;A.tree.insertNode(o,t.parentid,a)}function GT(A,j){let e=A.tree.get(j);Sj(e)||(A.tree.removeNode(e),Nh(A,j))}function Nh(A,j,e){let{isCodeFile:t=!1}=e??{},r=t?ta(j):en(j);A.tree.remove(r)}function Da(A,j){return A===or?ta(j):en(j)}function xh(A){return j=>Re(j)&&j.name===A}function aE(A,j){return A.children.find(xh(j))??null}var Oh=/\s*\/\s*/g,wh=/\/+/g,Lh=/^\/+|\/+$/g;function sE(A){let j=A.trim();return j?j.replace(Oh,"/").replace(wh,"/").replace(Lh,""):""}function xT(A,j){return A.children.find(e=>Re(e)&&e.getName()===j)??null}function Ml(A){let j=sE(A);return j===""?[]:j.split("/")}function OT(A,j){let t=Vh(A.tree,j).map(n=>A.tree.get(n));E(t.length>0,"unreferenced nodes parent node must exist");let r=t.flatMap(n=>n?.children??[]);if(!r||r.length===0)return;let o=qh[j];A.tree.beginAllowPartialScopeAccess();for(let n of r){if(!o(n))continue;let a=Da(j,n.id);if(A.tree.get(a))continue;let i=new jn({id:a});A.tree.insertNode(i,j)}A.tree.endAllowPartialScopeAccess()}var qh={[G6]:A=>F7(A),[y6]:A=>pt(A),[C6]:A=>dt(A),[v6]:A=>wr(A),[S6]:A=>vi(A)||Ci(A)||Or(A),[or]:A=>St(A)&&A.save.type==="codeFile",[Yo]:A=>rA(A)||St(A),[b6]:A=>bi(A),[Zo]:A=>oj(A),[Wr]:A=>Ae(A)},Kh={[G6]:bt,[y6]:bt,[C6]:bt,[v6]:bt,[S6]:bt,[or]:te,[b6]:ka};function Vh(A,j){return j===Zo||j===Wr?[A.root.id]:j===Yo?[A.root.id,te]:[Kh[j]]}var Jh="__entity_input";function wT(A,j){return`${Jh}_${A}_${j?"popout":"panel"}`}function LT(A){let j=A.lastIndexOf("/");return j>=0?A.slice(j+1):A}function _l(A){return Ak(A)||Re(A)}function qT(A,j,e){let t=e;for(let[r,o]of j.entries()){let n=r===j.length-1,a=A.getNode(t);if(!a||!_l(a))return!1;let i=!1;for(let s of a.children){if(G7(s)&&o===s.getName())return!0;if(Re(s)&&o===s.getName()){if(n)return!0;i=!0,t=s.id;break}}if(!i)return!1}return!1}function Na(A,j,e){let t=Aj(j)?j:Hh(j);if(t.length===0)return e;let r=A.get(e);E(r&&_l(r),"A reference must be in a folder.");for(let o of t){let n=aE(r,o);if(n){r=n;continue}r=A.insertNode(new du({name:o}),r.id)}return r.id}function XT(A,j){let e=A.tree.get(j);if(!Re(e))return"";let t=[e.name];for(let r of e.ancestors()){if(!Re(r))break;t.unshift(r.name)}return`/${t.join("/")}`}function YT(A,j,e){let t=A.tree.get(j);E(t,"Node must exist");let r=Da(e,j),o=A.tree.get(r),n=[t.name];if(o)for(let a of o.ancestors()){if(!Re(a))break;n.unshift(a.name)}return`/${n.join("/")}`}function Hh(A){return Ml(A).slice(0,-1)}function ZT(A,j,e,t){let r=Ml(e);if(r.length===0)return;let o=r.pop(),n=Na(A.tree,e,t),a=t===or;return Br(A.tree,n,j.id,a),j.set({name:o}),n}function no(A){return wo(A)}function lE(A){return(vj(A)||QA(A))&&!CA(A)}function oP(A){return QA(A)&&!CA(A)}function cE(A){return hA(A)&&!ij(A)}function dE(A){return jj(A)&&!ij(A)}function pE(A,j){if(!Ko(j))return!1;let e=F6(j.codeComponentIdentifier);if(!e)return!1;let t=A.getNode(e);return!!(t&&J(t))}function cP(A,j){let e=F6(j.codeComponentIdentifier);E(e,"WebPageInstance should have a local canvas component id");let t=A.getNode(e);return E(t,"SmartComponentInstance should have a local WebPageNode"),E(J(t),"WebPageInstance its WebPageNode should be a web page"),t}function kE(A){return Iu(A)?!0:qA(A)?A.hasLinks():Qt(A)?A.getInlineLinks(!1).filter(Boolean).length>0:!1}var gn=(A,j)=>A.length===0?[]:typeof A[0]=="string"?j.withoutDescendants(j.getNodes(A)):A;function xa(A,j){let e=j.reactComponentForIdentifier(A.codeComponentIdentifier);return e?Qk(e.properties,A.getControlProps(e.properties)):{}}var Qh={type:"None",source:"undefined"},uE=class extends re{constructor(){super(...arguments);R(this,"stack",[]);R(this,"dismiss",()=>{this.stack=$e.pop(this.stack)});R(this,"isVisible",()=>this.active.type!=="None");R(this,"shouldBlockUndoRedo",(e,t)=>{switch(this.active.type){case"None":return!1;case"Variables":return!_m(e,t);case"LocaleSettings":return!Dm(e,t);default:return!0}})}get active(){return this.stack[this.stack.length-1]??Qh}trackModalOpen({type:e,source:t}){BA("modal_open",{modalType:e,source:t})}push(e){this.stack=$e.push(this.stack,e),this.trackModalOpen(e)}set(e){this.stack=[e],this.trackModalOpen(e)}dismissAll(){this.stack.length!==0&&(this.stack=[])}dismissModal(e){this.stack=$e.filter(this.stack,t=>t.type!==e)}displayComponentIsolationModal({source:e}){let t="componentIsolationModal",r="1";Ej.isAutomation||Ej.isE2E||Ej.isTest||localStorage.getItem(t)!==r&&(localStorage.setItem(t,r),setTimeout(()=>{this.processWhenReady(()=>{this.set({type:"ComponentIsolationModal",source:e})})},0))}};var mE=class extends re{constructor(){super(...arguments);R(this,"active",0)}};function EE(A){if(M(A))return[A];if("id"in A)return[A.id];let j=[];for(let e of A)M(e)?j.push(e):j.push(e.id);return j}function hn(A,j){if(A===j)return!0;if(A.length!==j.length)return!1;let e=new Set(A);for(let t of j)if(!e.has(t))return!1;return!0}var fE=class extends re{constructor(e,t,r){super();this.guides=e;this.chromeStore=t;this.overlayStore=r;R(this,"_previousIds",[]);R(this,"_ids",[]);R(this,"_nodes",[]);R(this,"_isSticky",!1);R(this,"_commonGroundNode");R(this,"gradientStopId")}get ids(){return this._ids}get nodes(){return this._nodes}get isSticky(){return this._isSticky}get commonGroundNode(){return this._commonGroundNode}get commonGroundNodeId(){return this._commonGroundNode?.id??null}get previousIds(){return this._previousIds}set(e,t={}){let r=EE(e);if(hn(this._ids,r))return;this._previousIds=this._ids,this._ids=r,this._isSticky=t.sticky??r.length>1,r.length>0&&this.guides.clearSelected();let{switchToLayers:n=!1,tree:a}=t;this.chromeStore.onCanvasSelectionChange(r,n),this.overlayStore.onCanvasSelectionChange(r,{tree:a})}toggle(e,{switchToLayers:t=!1}={}){let r=EE(e),o=new Set(this.ids);for(let n of r)o.has(n)?o.delete(n):o.add(n);this._ids=Array.from(o),this.chromeStore.onCanvasSelectionChange(this.ids,t),this.overlayStore.onCanvasSelectionChange(o,{toggle:!0})}clear(){this.set([])}updateNodes(e){let t=e.getNodes(this.ids),r=!Ht(this.nodes,t);r&&(this._nodes=t),(r||this.commonGroundNode&&!e.isGroundNode(this.commonGroundNode))&&this.updateCommonGroundNode(e)}updateCommonGroundNode(e){let t;for(let r of this.nodes){let o=e.getGroundNodeFor(r);if(!t)t=o;else if(t!==o){t=void 0;break}}this._commonGroundNode=t}postProcess(e,t,r,o=this.gradientStopId,n=this._ids){this.gradientStopId=o;let a=[];for(let i of n){let s=e.getNode(i);if(s){e.isAncestorOfNode(s,t.id)&&a.push(i);continue}let c=r.getNode(i);if(!le(c))continue;let d=e.getNode(c.parentid);if(ej(d)){a.splice(0,a.length,d.id);break}}this.set(a,{tree:e}),this.updateNodes(e)}};function Dl(A){let j=V.componentForIdentifier(A.codeComponentIdentifier);if(!j?.properties)return null;let e=Object.entries(j.properties).find(([,n])=>n&&n.title==="Variant"&&n.type==="enum");if(!e)return null;let[t,r]=e;if(r.options.length<=1)return null;let o=r.defaultValue??r.options[0];return M(o)?{key:t,control:r,defaultVariant:o}:null}function Nl(A,{control:j}){let e=A.toLowerCase().trim(),r=(j.optionTitles??j.options).findIndex(n=>M(n)&&n.toLowerCase()===e);if(r===-1)return null;let o=j.options[r];return M(o)?o:null}function $E(A,j,e){let t={};for(let r of e.walk()){if(!z(r))continue;let o=Dl(r);if(!o)continue;let n=Nl(j,o);if(!n)continue;let a=r;if(jj(r)&&(a=A.tree.getNode(r.originalid)),!a||(a.getRawControlProp(o.key)??o.defaultVariant)===n)continue;let s={type:"enum",value:n};t[a.id]={[VA(o.key)]:s}}return Object.keys(t).length>0?t:null}var BE=["blur","backgroundBlur","brightness","contrast","grayscale","hueRotate","invert","saturate","sepia"];var wa={left:"position",right:"position",top:"position",bottom:"position",centerAnchorX:"position",centerAnchorY:"position",constraintsLocked:"position",x:"position",y:"position",width:"size",widthType:"size",height:"size",heightType:"size",aspectRatio:"size",itemsOrder:"itemsOrder",layout:"layout",gap:"layout",gridAlignment:"layout",gridColumnCount:"layout",gridColumnWidthType:"layout",gridColumnWidth:"layout",gridColumnMinWidth:"layout",gridRowHeightType:"layout",gridRowHeight:"layout",gridRowCount:"layout",stackDirection:"layout",stackDistribution:"layout",stackAlignment:"layout",stackWrapEnabled:"layout",gridItemFillCellWidth:"size",gridItemFillCellHeight:"size",gridItemHorizontalAlignment:"position",gridItemVerticalAlignment:"position",gridItemColumnSpan:"size",gridItemRowSpan:"size",minHeight:"sizeConstraints",minWidth:"sizeConstraints",maxHeight:"sizeConstraints",maxWidth:"sizeConstraints",paragraphSpacing:"paragraphSpacing",position:"positionType",positionStickyTop:"positionType",positionStickyRight:"positionType",positionStickyBottom:"positionType",positionStickyLeft:"positionType",intrinsicWidth:"intrinsicSize",intrinsicHeight:"intrinsicSize",fillColor:"fill",fillEnabled:"fill",fillImage:"fill",fillImageOriginalName:"fill",fillImagePixelHeight:"fill",fillImagePixelWidth:"fill",fillImageResize:"fill",fillImagePositionX:"fill",fillImagePositionY:"fill",fillImageTileSize:"fill",fillType:"fill",fillRadialGradient:"fill",fillLinearGradient:"fill",fillConicGradient:"fill",tapHighlightColor:"tapHighlight",textSelection:"textSelection",masks:"mask",radius:"radius",radiusBottomLeft:"radius",radiusBottomRight:"radius",radiusIsRelative:"radius",radiusPerCorner:"radius",radiusTopLeft:"radius",radiusTopRight:"radius",borderTop:"border",borderBottom:"border",borderLeft:"border",borderRight:"border",borderEnabled:"border",borderWidth:"border",borderStyle:"border",borderColor:"border",borderPerSide:"border",rotation:"rotation",rotate3d:"rotation",rotateX:"rotation",rotateY:"rotation",blendingMode:"blending",opacity:"opacity",backgroundBlur:"backgroundBlur",overflow:"overflow",overflowY:"overflowY",overflowX:"overflowX",overscrollBehavior:"overscroll",visible:"visibility",brightness:"brightness",contrast:"contrast",grayscale:"grayscale",hueRotate:"hueRotate",invert:"invert",saturate:"saturate",sepia:"sepia",blur:"blur",boxShadows:"shadows",shadows:"shadows",guidesX:"canvasSettings",guidesY:"canvasSettings",exportOptions:"canvasSettings",overlayGrid:"canvasSettings",gesture:"canvasSettings",sizeToFit:"canvasSettings",framePreset:"canvasSettings",isVariant:"canvasSettings",onTap:"action",onTapStart:"action",onClick:"action",onMouseUp:"action",onMouseDown:"action",onMouseEnter:"action",onMouseLeave:"action",onAppear:"action",onKeyDown:"action",padding:"padding",paddingPerSide:"padding",paddingTop:"padding",paddingRight:"padding",paddingBottom:"padding",paddingLeft:"padding",name:"name",strokeEnabled:"stroke",strokeAlignment:"stroke",strokeWidth:"stroke",strokeColor:"stroke",lineJoin:"stroke",lineCap:"stroke",strokeMiterLimit:"stroke",strokeDashArray:"stroke",strokeDashOffset:"stroke",html:"richText",htmlLocalized:"richText",htmlContent:"richText",textFitScale:"richText",textFitViewBoxSize:"richText",textFitViewBoxSizeLocalized:"richText",stylePresetHeading1:"stylePresets",stylePresetHeading2:"stylePresets",stylePresetHeading3:"stylePresets",stylePresetHeading4:"stylePresets",stylePresetHeading5:"stylePresets",stylePresetHeading6:"stylePresets",stylePresetParagraph:"stylePresets",stylePresetLink:"stylePresets",stylePresetAnchorLink:"stylePresets",stylePresetBlockquote:"stylePresets",stylePresetTable:"stylePresets",stylePresetInlineCode:"stylePresets",stylePresetImage:"stylePresets",anchorLinkOffsetY:"anchorLinkOffsetY",styledText:"styledText",getStyledText:"styledText",font:"font",rootFontSize:"rootFontSize",textColor:"textColor",fontSize:"fontSize",letterSpacing:"letterSpacing",textTransform:"textTransform",textDecoration:"textDecoration",textDecorationColor:"textDecoration",textDecorationThickness:"textDecoration",textDecorationStyle:"textDecoration",textDecorationSkipInk:"textDecoration",textDecorationOffset:"textDecoration",lineHeight:"lineHeight",textAlignment:"textAlignment",textStrokeWidth:"textStroke",textStrokeColor:"textStroke",textWrapBalance:"textWrapBalance",openTypeFontFeatures:"openTypeFontFeatures",link:"link",linkOpenInNewTab:"link",linkSmoothScroll:"link",linkClickTrackingId:"link",linkLocalized:"link",linkRelValues:"link",linkPreserveParams:"link",getLink:"link",linkFont:"linkStyle",linkTextColor:"linkStyle",linkFontSize:"linkStyle",linkTextTransform:"linkStyle",linkTextDecoration:"linkStyle",linkTextDecorationColor:"linkStyle",linkTextDecorationThickness:"linkStyle",linkTextDecorationStyle:"linkStyle",linkTextDecorationSkipInk:"linkStyle",linkTextDecorationOffset:"linkStyle",linkHoverFont:"linkStyle",linkHoverTextColor:"linkStyle",linkHoverFontSize:"linkStyle",linkHoverTextTransform:"linkStyle",linkHoverTextDecoration:"linkStyle",linkHoverTextDecorationColor:"linkStyle",linkHoverTextDecorationThickness:"linkStyle",linkHoverTextDecorationStyle:"linkStyle",linkHoverTextDecorationSkipInk:"linkStyle",linkHoverTextDecorationOffset:"linkStyle",linkCurrentFont:"linkStyle",linkCurrentTextColor:"linkStyle",linkCurrentFontSize:"linkStyle",linkCurrentTextTransform:"linkStyle",linkCurrentTextDecoration:"linkStyle",linkCurrentTextDecorationColor:"linkStyle",linkCurrentTextDecorationThickness:"linkStyle",linkCurrentTextDecorationStyle:"linkStyle",linkCurrentTextDecorationSkipInk:"linkStyle",linkCurrentTextDecorationOffset:"linkStyle",textContent:"textContent",textVerticalAlignment:"textVerticalAlignment",variantTransition:"transition",pathSegments:"vectorPath",pathClosed:"vectorPath",spikeCount:"vectorPath",spikeDepth:"vectorPath",polygonSides:"vectorPath",elementId:"scrollTarget",scrollMarginTop:"scrollTarget",scrollTargetEnabled:"scrollTarget",altAttribute:"accessibility",altAttributeLocalized:"accessibility",cursor:"cursor",customCursorSmartComponentId:"customCursor",customCursorFollow:"customCursor",customCursorOffsetX:"customCursor",customCursorOffsetY:"customCursor",customCursorVariant:"customCursor",customCursorType:"customCursor",customCursorTransitionEnabled:"customCursor",customCursorTransition:"customCursor",customCursorPlacement:"customCursor",customCursorAlignment:"customCursor",pointerEvents:"pointerEvents",userSelect:"userSelect",zIndex:"zIndex",draggable:"draggable",imageRendering:"imageRendering",viewportHeight:"canvasSettings",isBreakpoint:"canvasSettings",backdropFill:"overlay",backdropFillEnabled:"overlay",backdropDismissible:"overlay",blockDocumentScrolling:"overlay",backdropExitTransition:"overlayTransition",backdropEnterTransition:"overlayTransition",backdropTransitionLocked:"overlayTransition",hideScrollbars:"scrollbars",customizations:"customizations",customizationsDescription:"customizations",customizationsSectionId:"customizations",isApplyingCustomizations:"customizations",translateZ:"translateZ",scale:"scale",skewX:"skew",skewY:"skew",backfaceVisibility:"backfaceVisibility",perspective:"perspective",transformStylePreserve3d:"transformStylePreserve3d",transformOriginX:"transformOrigin",transformOriginY:"transformOrigin",transition:"transition",formInputFontSize:"formInputFont",formInputFontFamily:"formInputFont",formInputFontSelector:"formInputFont",formInputFontWeight:"formInputFont",formInputFontStyle:"formInputFont",formInputPlaceholderColor:"formPlaceholderColor",formInputFontColor:"formInputColor",formInputFontLetterSpacing:"formInputFont",formInputFontLetterSpacingUnit:"formInputFont",formInputFontLineHeight:"formInputFont",formInputFontLineHeightUnit:"formInputFont",formInputFontTextAlignment:"formInputFont",formInputOpenTypeFontFeatures:"formInputFont",formTextInputType:"formTextInputType",formTextAreaResizable:"formInputTextAreaResize",formTextInputMinNumber:"formTextInputTypeMin",formTextInputMaxNumber:"formTextInputTypeMax",formInputMaxLength:"formInputMaxLength",formInputStep:"formInputStep",formBooleanInputType:"formBooleanInputType",formBooleanInputValue:"formBooleanInputValue",formBooleanInputCheckedBorderColor:"formBooleanInputCheckedEffect",formBooleanInputCheckedBorderWidth:"formBooleanInputCheckedEffect",formBooleanInputCheckedBorderStyle:"formBooleanInputCheckedEffect",formBooleanInputCheckedBoxShadow:"formBooleanInputCheckedEffect",formBooleanInputCheckedFillColor:"formBooleanInputCheckedEffect",formBooleanInputCheckedTransition:"formBooleanInputCheckedEffect",formInputFocusedBackgroundColor:"formInputFocusedFill",formInputFocusedBorderColor:"formInputFocusedBorder",formInputFocusedBorderStyle:"formInputFocusedBorder",formInputFocusedBorderWidth:"formInputFocusedBorder",formInputFocusedBoxShadow:"formInputFocusedBoxShadow",formInputFocusedTransition:"formInputFocusedTransition",formInputInvalidTextColor:"formInputInvalidTextColor",formInputIconImage:"formInputIcon",formInputIconColor:"formInputIcon",viewTransitionNone:"viewTransitionNone"};function HP(A){let j=[],e;for(e in wa){let t=wa[e];A.includes(t)&&j.push(e)}return j}function gE(A,j){let e=V.componentForIdentifier(j.codeComponentIdentifier);if(!e?.properties)return{};let t={};return Object.entries(e.properties).forEach(([r,o])=>{if(!o||je(j)&&o.type==="slot")return;let n=VA(r),a=A[n];Ni(a)&&a.type&&xp(o.type,a.type)&&(o.type==="enum"&&!bp(o,a.value)||(t[n]=a))}),t}function U(A,j){return j?new Set(Aj(j)?j:[j]).has(A):!0}function La(A,j,e,t,r,o){let n=A.getScopeNodeFor(e);function a(s){return!pA(s)||n&&Ue(n)&&n.hasVariable(s.id)?s:r?.[s.id]??s}let i={};if(Hi(A,e)||Je(j)&&(j.widthType===4&&(i.widthType=1),j.heightType===4&&(i.heightType=1)),U("visibility",o)&&ro(j)&&ro(e)&&(i.visible=a(j.visible)),U("border",o)&&ze(j)&&ze(e)&&(i.borderEnabled=j.borderEnabled,i.borderWidth=j.borderWidth,i.borderColor=j.borderColor,i.borderStyle=j.borderStyle,i.borderPerSide=j.borderPerSide,i.borderLeft=j.borderLeft,i.borderTop=j.borderTop,i.borderRight=j.borderRight,i.borderBottom=j.borderBottom),U("border",o)&&ze(j)&&oe(e))if(UA(j.borderEnabled)){let s=j.resolveValue("borderEnabled");jr(s)?(i.strokeEnabled=!0,i.strokeWidth=s.borderWidth,i.strokeColor=s.borderColor):i.strokeEnabled=!1}else i.strokeEnabled=j.borderEnabled,i.strokeWidth=j.borderWidth,i.strokeColor=j.borderColor;if(U("stroke",o)&&oe(j)&&oe(e)&&(i.strokeEnabled=j.strokeEnabled,i.strokeColor=j.strokeColor,i.strokeWidth=j.strokeWidth,i.strokeAlignment=j.strokeAlignment,i.lineJoin=j.lineJoin,i.lineCap=j.lineCap,i.strokeMiterLimit=j.strokeMiterLimit,i.strokeDashArray=j.strokeDashArray,i.strokeDashOffset=j.strokeDashOffset),U("stroke",o)&&oe(j)&&ze(e)&&(i.borderEnabled=j.strokeEnabled,i.borderWidth=j.resolveValue("strokeWidth"),i.borderColor=j.resolveValue("strokeColor")),U("formInputTextAreaResize",o)&&Tp(j)&&(i.formTextAreaResizable=j.formTextAreaResizable),U("formInputFocusedFill",o)&&We(j)&&We(e)&&(i.formInputFocusedBackgroundColor=j.formInputFocusedBackgroundColor),U("formInputFocusedBorder",o)&&We(j)&&We(e)&&(i.formInputFocusedBorderColor=j.formInputFocusedBorderColor,i.formInputFocusedBorderWidth=j.formInputFocusedBorderWidth,i.formInputFocusedBorderStyle=j.formInputFocusedBorderStyle),U("formInputFocusedBoxShadow",o)&&We(j)&&We(e)&&(i.formInputFocusedBoxShadow=j.formInputFocusedBoxShadow?[...j.formInputFocusedBoxShadow]:void 0),U("formInputFocusedTransition",o)&&We(j)&&We(e)&&(i.formInputFocusedTransition=j.formInputFocusedTransition),U("formInputColor",o)&&Er(j)&&Er(e)&&(i.formInputFontColor=j.formInputFontColor),U("formPlaceholderColor",o)&&rl(j)&&rl(e)&&(i.formInputPlaceholderColor=j.formInputPlaceholderColor),U("formInputPadding",o)&&Ye(j)&&Ye(e)&&(i.padding=j.padding,i.paddingPerSide=j.paddingPerSide,i.paddingTop=j.paddingTop,i.paddingRight=j.paddingRight,i.paddingBottom=j.paddingBottom,i.paddingLeft=j.paddingLeft),U("shadows",o)&&zt(j)&&zt(e)){let s=a(j.boxShadows);J7(e)?i.boxShadows=s:UA(s)||(i.boxShadows=s?.filter(c=>c.type!=="realistic"))}if(U("shadows",o)&&i6(j)&&i6(e)&&(i.shadows=j.shadows),U("rotation",o)&&Rt(j)&&Rt(e)&&(i.rotation=j.rotation,hj(e)&&hj(j)&&(i.rotate3d=j.rotate3d,i.rotateX=j.rotateX,i.rotateY=j.rotateY)),U("overflow",o)&&Qe(j)&&Qe(e)&&(i.overflow=a(j.overflow)),U("overscroll",o)&&m6(j)&&m6(e)&&(i.overscrollBehavior=a(j.overscrollBehavior)),U("cursor",o)&&Uo(j)&&Uo(e)&&(i.cursor=a(j.cursor)),U("customCursor",o)&&Uo(j)&&Uo(e)&&(i.customCursorType=j.customCursorType,i.customCursorSmartComponentId=j.customCursorSmartComponentId,i.customCursorVariant=j.customCursorVariant,i.customCursorFollow=j.customCursorFollow,i.customCursorOffsetX=j.customCursorOffsetX,i.customCursorOffsetY=j.customCursorOffsetY,i.customCursorTransitionEnabled=j.customCursorTransitionEnabled,i.customCursorTransition=j.customCursorTransition,i.customCursorPlacement=j.customCursorPlacement,i.customCursorAlignment=j.customCursorAlignment),an(j)&&an(e))for(let s of BE){let c=wa[s];U(c,o)&&(i[s]=a(j[s]))}if(U("blending",o)&&k6(j)&&k6(e)&&(i.blendingMode=a(j.blendingMode)),U("transition",o)&&Q6(j)&&Q6(e)){let s=CA(j)?j.variantTransition:j.transition;CA(e)?i.variantTransition=s:i.transition=s}if(U("fill",o)&&Se(j)&&Se(e)){i.fillColor=a(j.fillColor),i.fillType=j.fillType,i.fillLinearGradient=j.fillLinearGradient,i.fillRadialGradient=j.fillRadialGradient,i.fillConicGradient=j.fillConicGradient,i.fillType==="conic-gradient"&&!tk(e)&&(i.fillType=e.fillType??"color");let s=a(j.fillImage);UA(s)?UA(s)&&e.supportsDynamicValues()&&(i.fillImage=s):i.fillImage=s,i.fillImageResize=j.fillImageResize,i.fillImagePixelWidth=j.fillImagePixelWidth,i.fillImagePixelHeight=j.fillImagePixelHeight,i.fillImagePositionX=j.fillImagePositionX,i.fillImagePositionY=j.fillImagePositionY,i.fillImageTileSize=j.fillImageTileSize}if(U("fill",o)&&Ft(j)&&Ft(e)&&(i.fillEnabled=j.fillEnabled),U("opacity",o)&&J6(j)&&J6(e)&&(i.opacity=a(j.opacity)),U("radius",o)&&Gt(j)&&Gt(e)&&(i.radius=a(j.radius),_6(j)&&_6(e)&&(i.radiusIsRelative=j.radiusIsRelative),ir(j)&&ir(e)&&(i.radiusPerCorner=j.radiusPerCorner,i.radiusBottomLeft=j.radiusBottomLeft,i.radiusBottomRight=j.radiusBottomRight,i.radiusTopLeft=j.radiusTopLeft,i.radiusTopRight=j.radiusTopRight)),U("pointerEvents",o)&&E6(j)&&E6(e)&&!sj(n)&&(i.pointerEvents=a(j.pointerEvents)),U("draggable",o)&&V6(j)&&V6(e)&&(i.draggable=a(j.draggable)),U("userSelect",o)&&f6(j)&&f6(e)&&(i.userSelect=a(j.userSelect)),U("imageRendering",o)&&u6(j)&&u6(e)&&(i.imageRendering=a(j.imageRendering)),U("overflowX",o)&&Qe(j)&&Qe(e)&&(i.overflowX=a(j.overflowX)),U("overflowY",o)&&Qe(j)&&Qe(e)&&(i.overflowY=a(j.overflowY)),U("zIndex",o)&&h6(j)&&h6(e)&&(i.zIndex=a(j.zIndex)),U("scrollbars",o)&&Y6(j)&&Y6(e)&&(i.hideScrollbars=a(j.hideScrollbars)),U("textVerticalAlignment",o)&&Al(j)&&Al(e)&&(i.textVerticalAlignment=j.textVerticalAlignment),U("textWrapBalance",o)&&D6(j)&&D6(e)&&(i.textWrapBalance=j.textWrapBalance),U("styledText",o)&&bj(j)&&sp(e)){i.font=j.getFonts(!1)[0],i.textColor=j.getTextColors(!1)[0];let s=j.getFontSizes(!1)[0];i.fontSize=Lo(s)?s[0]:s;let c=j.getLetterSpacings(!1)[0];i.letterSpacing=oA(c)?c:D7(c),i.textTransform=j.getTextTransforms(!1)[0],i.textDecoration=j.getTextDecorations(!1)[0],i.lineHeight=j.getLineHeights(!1)[0],i.textAlignment=j.getTextAlignments(!1)[0],i.styledText=e.styledText.setFont(void 0,!1).setTextColor(void 0,!1).setFontSize(void 0,!1).setLetterSpacing(void 0,!1).setTextTransform(void 0,!1).setTextDecoration(void 0,!1).setLineHeight(void 0).setTextAlignment(void 0)}if(U("link",o)&&bj(j)&&bj(e)&&(i.linkFont=j.linkFont,i.linkTextColor=j.linkTextColor,i.linkFontSize=j.linkFontSize,i.linkTextTransform=j.linkTextTransform,i.linkTextDecoration=j.linkTextDecoration,i.linkHoverFont=j.linkHoverFont,i.linkHoverTextColor=j.linkHoverTextColor,i.linkHoverFontSize=j.linkHoverFontSize,i.linkHoverTextTransform=j.linkHoverTextTransform,i.linkHoverTextDecoration=j.linkHoverTextDecoration,i.linkCurrentFont=j.linkCurrentFont,i.linkCurrentTextColor=j.linkCurrentTextColor,i.linkCurrentFontSize=j.linkCurrentFontSize,i.linkCurrentTextTransform=j.linkCurrentTextTransform,i.linkCurrentTextDecoration=j.linkCurrentTextDecoration),U("mask",o)&&T6(j)&&T6(e)&&(i.masks=j.masks),qA(j)&&qA(e)){if(U("fontSize",o)&&(i.textFitScale=j.textFitScale,i.textFitViewBoxSize=j.textFitViewBoxSize),U("paragraphSpacing",o)&&(i.paragraphSpacing=j.paragraphSpacing),U("styledText",o)){let s=j.getTextStrokeWidths(!1)[0],c=j.getTextStrokeColors(!1)[0];oA(s)||(i.textStrokeWidth=s),c&&(i.textStrokeColor=c)}if(U("richText",o))for(let s of wu){let c=j[s];A.has(c)&&(i[s]=c)}}if(U("codeComponentProps",o)&&Ko(j)&&Ko(e)){let s=gE(j,e);Object.assign(i,s)}if(U("codeOverride",o)&&Vr(j)&&Vr(e)&&(i.codeOverrideEnabled=j.codeOverrideEnabled,i.codeOverrideIdentifier=j.codeOverrideIdentifier),U("formInputFont",o)&&Er(j)&&Er(e)&&(i.formInputFontFamily=j.formInputFontFamily,i.formInputFontWeight=j.formInputFontWeight,i.formInputFontStyle=j.formInputFontStyle,i.formInputFontSize=j.formInputFontSize,i.formInputFontSelector=j.formInputFontSelector,i.formInputFontLetterSpacing=j.formInputFontLetterSpacing,i.formInputFontLetterSpacingUnit=j.formInputFontLetterSpacingUnit,i.formInputFontLineHeight=j.formInputFontLineHeight,i.formInputFontLineHeightUnit=j.formInputFontLineHeightUnit,i.formInputFontTextAlignment=j.formInputFontTextAlignment,i.formInputOpenTypeFontFeatures=j.formInputOpenTypeFontFeatures),U("layout",o)&&LA(j)&&fA(e)&&(ij(e)||(i.layout=j.layout),i.stackDirection=j.stackDirection,i.stackDistribution=j.stackDistribution,i.stackAlignment=j.stackAlignment,i.gap=j.gap,i.padding=j.padding,i.paddingPerSide=j.paddingPerSide,i.paddingTop=j.paddingTop,i.paddingRight=j.paddingRight,i.paddingBottom=j.paddingBottom,i.paddingLeft=j.paddingLeft),U("position",o)&&Object.assign(i,Xr(j,t)),U("perspective",o)&&hj(j)&&hj(e)&&(i.perspective=a(j.perspective)),U("overlay",o)&&$j(j)&&$j(e)&&t){let s=$t(j);Object.assign(i,s)}if(U("effects",o)&&ln(j)&&ln(e)&&Object.assign(i,lu(e,j)),U("transformOrigin",o)&&hj(j)&&hj(e)&&Object.assign(i,{transformOriginX:j.transformOriginX,transformOriginY:j.transformOriginY}),U("backfaceVisibility",o)&&hj(j)&&hj(e)&&Object.assign(i,{backfaceVisibility:j.backfaceVisibility}),U("transformStylePreserve3d",o)&&hj(j)&&hj(e)&&Object.assign(i,{transformStylePreserve3d:j.transformStylePreserve3d}),U("translateZ",o)&&hj(j)&&hj(e)&&Object.assign(i,{translateZ:j.translateZ}),U("scale",o)&&hj(j)&&hj(e)&&Object.assign(i,{scale:j.scale}),U("skew",o)&&hj(j)&&hj(e)&&Object.assign(i,{skewX:j.skewX,skewY:j.skewY}),U("formBooleanInputType",o)&&mr(j)&&mr(e)&&Object.assign(i,{formBooleanInputType:j.formBooleanInputType}),U("formBooleanInputValue",o)&&mr(j)&&mr(e)&&Object.assign(i,{formBooleanInputValue:j.formBooleanInputValue}),U("formBooleanInputCheckedEffect",o)&&mr(j)&&mr(e)){let s={formBooleanInputCheckedBorderColor:j.formBooleanInputCheckedBorderColor,formBooleanInputCheckedBorderWidth:j.formBooleanInputCheckedBorderWidth,formBooleanInputCheckedBorderStyle:j.formBooleanInputCheckedBorderStyle,formBooleanInputCheckedFillColor:j.formBooleanInputCheckedFillColor,formBooleanInputCheckedBoxShadow:j.formBooleanInputCheckedBoxShadow,formBooleanInputCheckedTransition:j.formBooleanInputCheckedTransition};Object.assign(i,s)}return U("formInputIcon",o)&&tl(j)&&tl(e)&&Object.assign(i,{formInputIconImage:j.formInputIconImage,formInputIconColor:j.formInputIconColor}),U("viewTransitionNone",o)&&U6(j)&&U6(e)&&(i.viewTransitionNone=j.viewTransitionNone),i}function hE(A,j,e,t,r){if(we(t))return;let o=JA(j)?2:0,n=rj(e.x,o),a=rj(e.y,o);if(mt(r.x)?(r.x=n,r.y=a):(!Xj(r.x)&&r.x!==n&&(r.x=qt),!Xj(r.y)&&r.y!==a&&(r.y=qt)),!$A(j)||!t)return;let i=A.getParentSizeInfo(j);if(!i?.positioning)return;let s=i.positioning,c=rj(s.width-w.maxX(e),o),d=rj(s.height-w.maxY(e),o);mt(r.right)?(r.right=c,r.bottom=d):(!Xj(r.right)&&r.right!==c&&(r.right=qt),!Xj(r.bottom)&&r.bottom!==d&&(r.bottom=qt))}var Cj={padding:0,gridRowCount:2,gridColumnCount:2,gridRowHeight:200,gridColumnWidth:200};Object.freeze(Cj);function J_(A){switch(A){case 20:return 0;case 21:return 1;case 23:return 4;case 24:return 3;case 22:return 2;case 19:return 5}}var Uh=(A,j,e=!0)=>{let t=A.stores.persistedUserDefaults.layoutGap;return{layout:"stack",stackDirection:j,stackDistribution:"start",stackAlignment:"center",gap:t,stackWrapEnabled:!1,paddingPerSide:!1,padding:e?t:Cj.padding,paddingTop:Cj.padding,paddingBottom:Cj.padding,paddingLeft:Cj.padding,paddingRight:Cj.padding}},Wh={gridItemFillCellWidth:!0,gridItemFillCellHeight:!0,gridItemHorizontalAlignment:"center",gridItemVerticalAlignment:"center",gridItemColumnSpan:1,gridItemRowSpan:1},zh=A=>({layout:"grid",gridColumnCount:Cj.gridColumnCount,gridAlignment:"center",gridColumnWidthType:"minmax",gridColumnWidth:Cj.gridColumnWidth,gridColumnMinWidth:50,gridRowHeightType:"auto",gridRowCount:Cj.gridRowCount,gridRowHeight:Cj.gridRowHeight,gap:A.stores.persistedUserDefaults.layoutGap,paddingPerSide:!1,padding:Cj.padding,paddingTop:Cj.padding,paddingBottom:Cj.padding,paddingLeft:Cj.padding,paddingRight:Cj.padding}),IE=new Set(["#BDF","#CEF","#9DF"]);function Xh(A){let j=Array.from(IE).filter(e=>e!==A);return j.length=2,j}var FE=(A,j={},e={})=>{let{index:t=0,lastColor:r,parentColor:o,source:n}=e,a=Xh(o),i=a.length,s=a[0];if(t>0)s=a[Math.ceil(t/i)%i];else if(M(r))if(IE.has(r)){let d=(a.indexOf(r)+1)%i;s=a[d]}else s=r;n&&BA("layout_frame",{source:n});let c={fillEnabled:!0,fillColor:s};return LA(A)&&!A.stackWrapEnabled&&(A.widthType!==2&&(c.width=1,c.widthType=3),A.heightType!==2&&(c.height=1,c.heightType=3)),Object.assign(c,j),new pe(c)},H_=(A,j)=>{switch(A){case 0:case 1:{j.layout="stack",j.stackDirection=A===0?"vertical":"horizontal";break}case 2:case 3:case 4:j.overflow=Fe();break}},Yh=(A,j,e,t,r,o)=>{let n=new pe({...Uh(A,e,r),fillEnabled:!1,...j});E(LA(n));let a=o?{widthType:0,width:o.width,heightType:0,height:o.height}:void 0;for(let i=0;i<t;i++){let s=FE(n,a,{index:i});n.addChild(s)}return n},RE=(A,j,e,t)=>{let r=new pe({...zh(A),fillEnabled:!1,...j});E(Oe(r));for(let o=0;o<e;o++){let n={};switch(t){case 3:o===0&&(n.gridItemRowSpan=2);break;case 4:o+1===e&&(n.gridItemColumnSpan=2);break;default:break}let a=FE(r,{...Wh,...n},{index:o});r.addChild(a)}return r},Q_=(A,j,e,t=!1)=>{if(j===2)return RE(A,e,t?0:4);if(j===3||j===4)return RE(A,e,t?0:3,j);let r=t?0:2;return Yh(A,e,e.stackDirection??"horizontal",r,!1)},GE=$p.width,Zh=(A,j,e,t,r,o)=>{let n={x:Wt,y:Wt,right:Wt,bottom:Wt};hE(A,j,e,t,n),Ei(n.x)&&Ei(n.right)&&r-n.x-n.right<200&&(o.left=0,o.right=0)},AR=(A,j)=>{A.stackDirection==="horizontal"&&!A.stackWrapEnabled&&(j.stackDirection="vertical"),A.stackWrapEnabled&&A.stackDistribution==="start"&&(j.stackDistribution="center")},jR=A=>{let j={};return A.children?.forEach(e=>{if(!Qr(e))return;let t=e.originalid??e.id;j[t]={maxWidth:"100%"}}),j},eR=(A,j)=>{Ei(A.gridColumnCount)&&(j.gridColumnCount=1)},tR=(A,j,e,t,r,o)=>{Zh(A,j,e,t,r,o),!(r>GE)&&(LA(j)&&AR(j,o),Oe(j)&&eR(j,o))},xl=(A,j,e,t,r,o)=>{let n=j.originalid??j.id,a={};if(tR(A,j,e,t,r,a),o[n]=a,ae(j)&&j.stackWrapEnabled&&r<=GE){let s=jR(j);for(let c in s)o[c]={...o[c],...s[c]}}};function U_(A,j,e){let t=A.tree.getNode(j);if(!t||!se(t))return;let r=A.tree.getNode(e);if(!r||!nj(r)||!GA(r))return;let o=A.tree.getScopeNodeFor(r);if(!o||!J(o))return;let n=A.tree.getRect(t),a=o.getBreakpointValues();for(let i in a){if(i===e)continue;let s=A.tree.getNode(i);if(!s||!QA(s)||!WA(s))continue;let c={};xl(A.tree,t,n,r,s.width,c),im(A.tree,s,c)}}function SE(A,j){let e={width:{2:!0,0:!0,3:!0,1:!0,4:!0},height:{2:!0,0:!0,3:!0,1:!0,4:!0}},t=A.getParent(j.id);if(!t||!$A(j)||Zu(j)&&j.autoSize===!0||$j(j)?(e.width[1]=!1,e.height[1]=!1,e.width[3]=!1,e.height[3]=!1,e.width[4]=!1,e.height[4]=!1):Oe(t)?Ge(j,t)?(e.width[3]=!0,e.height[3]=t.gridRowHeightType!=="fit"):(e.width[3]=!1,e.height[3]=!1):LA(t)?(Ge(j,t)||(e.width[3]=!1),Ge(j,t)||(e.height[3]=!1)):(e.width[3]=!1,e.height[3]=!1),mk(j)&&_j(j.textFitViewBoxSize)&&(e.height[2]=!0,e.width[2]=!1,e.height[0]=!1,e.height[1]=!1,e.height[3]=!1,e.height[4]=!1),z(j)){let o=j.getSupportedLayout(V);Ne(o.width)||(e.width[2]=!1),Ne(o.height)||(e.height[2]=!1),Vs(o.width)||(e.width[0]=!1,e.width[1]=!1,e.width[3]=!1,e.width[4]=!1),Vs(o.height)||(e.height[0]=!1,e.height[1]=!1,e.height[3]=!1,e.height[4]=!1)}else if(fA(j)){if(GA(j)){e.width[2]=!1,s6(j)&&(e.height[0]=!1,e.height[1]=!1,e.height[3]=!1,e.height[4]=!1);let o=A.get(j.parentid);oj(o)&&(e.height[2]=!1)}j.children.length===0&&(e.width[2]=!1,e.height[2]=!1)}else fA(j)||Qt(j)||qA(j)||(e.width[2]=!1,pk(j)||(e.height[2]=!1));return ge(j)&&oA(j.layout)&&jj(j)&&!ij(j)&&(e.width[2]=!1,e.height[2]=!1),Hi(A,j)||(e.width[4]=!1,e.height[4]=!1),(GA(t)&&Je(t)&&t.heightType===2||s6(t))&&(e.height[3]=!1,e.height[1]=!1),we(t)&&(e.width[3]=!1,e.width[1]=!1,e.height[3]=!1,e.height[1]=!1),e}var yE=A=>{let j=[];return A.forEach((e,t)=>{for(let r=t+1;r<A.length;r++){let o=A[r];j.push([e,o])}}),j};function bE(A,j,e){let t=j.map(d=>A.convertFrameToCanvas(d));if(t.length===2){let[d,p]=t,k=nR(d,p),$=iR(d,p);if(k&&!$)return"vertical";if($&&!k)return"horizontal"}let r=t.map(d=>w.center(d));if(r.length<=1){if(t.length===1){let[d]=t,p=e.width/Math.max(1,d.width),k=e.height/Math.max(1,d.height);return p<k?"vertical":"horizontal"}return e.width<e.height?"vertical":"horizontal"}let o=yE(r),n=[],a=[];o.forEach(([d,p])=>{n.push(Math.abs(d.x-p.x)),a.push(Math.abs(d.y-p.y))});let i=n.reduce((d,p)=>d+p,0),s=a.reduce((d,p)=>d+p,0);return i>s?"horizontal":"vertical"}function CE(A,j,e){return[...j].sort((t,r)=>{let o=A.tree.getRect(t),n=A.tree.getRect(r);return e==="horizontal"?o.x-n.x:o.y-n.y})}function rR(A){if(UA(A))return!0;switch(A){case"start":case"center":case"end":return!0;default:return!1}}function Ol(A,j,e){let t=bE(A.tree,j,e),r=A.stores.persistedUserDefaults.layoutGap;return{layout:"stack",stackDirection:t,gap:r,stackDistribution:E7,stackAlignment:Gi,stackWrapEnabled:!1,padding:0,paddingPerSide:!1,paddingTop:0,paddingRight:0,paddingBottom:0,paddingLeft:0}}function oR(A,j){j.forEach((e,t)=>{A.tree.moveNodeIndex(e,t)})}function vE(A,j,e,t,r){e==="horizontal"&&j.heightType===2||e==="vertical"&&j.widthType===2||TE(A,t,e,r,{})}function TE(A,j,e,t,r){if(e==="horizontal"||UA(r.padding))return;let o={...t};if(r.paddingPerSide)r.paddingLeft&&(o.width-=r.paddingLeft),r.paddingRight&&(o.width-=r.paddingRight),r.paddingTop&&(o.height-=r.paddingTop),r.paddingBottom&&(o.height-=r.paddingBottom);else if(r.padding){let a=r.padding*2;o.width-=a,o.height-=a}o.width=Math.max(0,o.width),o.height=Math.max(0,o.height);let n=o.width;n>0&&j.forEach(a=>{if(!$A(a)||SA(a)||Aa(a)||Zi(a)||a.widthType===2||a.widthType===4)return;if(A.tree.getRect(a).width/n>.96){let c=A.tree.getParent(a.id),d=A.tree.getParentSizeInfo(a);d.sizing&&a.heightType===4&&(d.sizing={...o,height:d.sizing.height});let p=A.tree.getRect(a),k=a.updateForRect({rect:p,parentSizeInfo:d,constraintsLocked:!0,shouldGuessPinToBottom:jt(A.tree,a),shouldGuessPinToRight:Vj(A.tree,a,c)});k.width=1,a.width!==1&&(k.widthType=3),a.set(k)}})}function PE(A,j,e,t,r){if(!A.tree.getNode(j))return;CE(A,t,r).forEach(a=>{if(V7(a)&&yt(a)||Vo(a))return;let i=A.tree.getParent(a.id),s=A.tree.getRect(a),c=w.offset(s,sA.reverse(e));A.moveNode(a.id,j);let d={...e},p=A.tree.getParentSizeInfo(a);ip(a)&&p.sizing&&(d.width=p.sizing.width),ap(a)&&p.sizing&&(d.height=p.sizing.height),A.tree.current(a)?.set({...a.updateForRect({rect:c,parentSizeInfo:{sizing:d,positioning:e,viewport:p?.viewport??null,layout:he(i)},constraintsLocked:!1,shouldGuessPinToBottom:!0,shouldGuessPinToRight:Vj(A.tree,a,i)}),top:null,left:null,bottom:null,right:null,position:void 0}),Bt(A.tree,a).forEach(({replicaRoot:$,relatedNode:g})=>{uA.resetOverridesByProperty(A.tree,$,g,["position"])})})}function nR(A,j){let e=w.maxX(A),t=w.maxX(j);return e>j.x&&t>A.x}function iR(A,j){let e=w.maxY(A),t=w.maxY(j);return e>j.y&&t>A.y}function wl(A,j,e){if(!vA(e))return;let t=j==="width"?"widthType":"heightType";e.children.forEach(r=>{if($A(r)&&(r[t]===3||r[t]===1)){let o=A.getRect(r),n={[t]:0,[j]:o[j]};Hr(r)&&(n.aspectRatio=null),A.current(r)?.set(n)}})}function hD(A,j){if(!vA(j)||!$A(j))return;let e=new Set;j.children.forEach(t=>{if(!$A(t)||!Qr(t))return;let r=A.getRect(t),o={};j.widthType===2&&(t.widthType===3||t.widthType===1)&&(o.minWidth=r.width,e.add(t)),j.heightType===2&&(t.heightType===3||t.heightType===1)&&(o.minHeight=r.height),Object.keys(o).length>0&&(e.add(t),A.current(t)?.set(o))}),e.size>0&&aR()}function aR(){TA({type:"add",variant:"info",key:"setting-stack-direction-causes-children-change",text:"Layers in this stack received min-sizing to prevent a collapse",icon:"thumbnail",duration:5e3,showCloseButton:"always"})}function qa(A,j,e={}){if(!ge(j)||!vA(j)||ae(j))return;let t={layout:"stack",...e},r=A.tree.getRect(j),o=A.tree.getScopeNodeFor(j),n=Fu(j)||CA(j)&&J(o)||j.__unsafeIsGroundNode(A.tree)&&qj(o),a=n?"vertical":bE(A.tree,j.children,r),i=CE(A,j.children,a);hA(j)||oR(A,i);let s=Si(j),c=j.gap??A.stores.persistedUserDefaults.layoutGap,d=n?"start":"center";t.stackDirection=s?j.stackDirection??a:a,t.stackDistribution=s?j.stackDistribution??d:d,t.gap=s||rR(d)?c:0,t.stackAlignment=s?j.stackAlignment??Gi:Gi,t.stackWrapEnabled=s?j.stackWrapEnabled??!1:!1;let p=s&&Ye(j)?{padding:j.padding,paddingPerSide:j.paddingPerSide,paddingLeft:j.paddingLeft,paddingRight:j.paddingRight,paddingTop:j.paddingTop,paddingBottom:j.paddingBottom}:{...dk};if(a==="horizontal"&&e.heightType===2||a==="vertical"&&e.widthType===2||TE(A,j.children,a,r,p),p.paddingPerSide){let{paddingTop:$,paddingRight:g,paddingBottom:G,paddingLeft:I}=p;$===g&&$===G&&$===I&&(p.paddingPerSide=!1,p.padding=$)}j.set({...t,...p})}var DE=900;function LD(A){return A.intrinsicWidth>=DE}function Ka(A,j,e){if(bj(j))return!1;let t=e??A.getParent(j.id);return!!(t&&GA(t))}function qD(A){return A<=.5}function sR(A,j,e){if(!fA(j)||!nj(j)||!GA(j)||ie(j)||!Ka(A,e,j))return!1;let t=WA(e)&&Je(e)&&e.widthType===1&&e.width===1;if(WA(e)&&e.width<DE&&!t)return!1;let r=j.children.filter(c=>c.id!==e.id);if(r.length===0)return!0;let n=A.getRect(j).width||1,a=r.map(c=>A.getRect(c));return a.some(c=>c.width/n<.5)?!1:a.every((c,d)=>a.every((p,k)=>d===k?!0:!w.intersects(c,p)))}function NE(A,j,e,t){if(!ge(j)||!sR(A.tree,j,e))return;let r={};t.height>500&&(r.heightType=2),qa(A,j,r),j.set({gap:0})}function ME(A,j){for(let e of Object.values(A.variables))if(e?.type==="collectionreference"&&e.dataIdentifier===j)return e}function _E(A,j){return Object.values(A.variables).find(e=>e?.type==="multicollectionreference"&&e.dataIdentifier===j)}function lR(A,j){let e=Zk(j);if(e6(e))return{targetDataIdentifier:e.dataIdentifier,targetProviderId:e.id};let t=A.stores.scopeStore.active;if(Dj(t))return{targetDataIdentifier:t.dataIdentifier,targetProviderId:t.id}}function xE(A,j,e){if(!e6(e))return;let t=lR(A,j);if(!t)return;let{targetDataIdentifier:r,targetProviderId:o}=t,n=lr(A.tree,e.dataIdentifier),a=lr(A.tree,r);if(!n||!a)return;let i=ME(n,r),s=_E(n,r),c=ME(a,e.dataIdentifier),d=_E(a,e.dataIdentifier),p;d?p={id:kj(),itemKey:"id",transforms:[{id:kj(),type:"valueTransform",name:"isIncludedIn",value:Lj(d.id,o)}]}:c?p={id:kj(),itemKey:"id",transforms:[{id:kj(),type:"valueTransform",name:"equals",value:Lj(c.id,o)}]}:s?p={id:kj(),itemKey:s.id,transforms:[{id:kj(),type:"valueTransform",name:"contains",value:Lj("id",o)}]}:i&&(p={id:kj(),itemKey:i.id,transforms:[{id:kj(),type:"valueTransform",name:"equals",value:Lj("id",o)}]}),p&&e.set({collectionFilters:{filters:[p]}})}function OE(A,j,e,t){if(!fA(j)||!nj(j)||!GA(j)||!ae(j)||j.stackDirection!=="vertical"||!Ka(A.tree,e,j)||j.heightType===2||!SE(A.tree,j).height[2])return;let o=j.children.filter(s=>s.id!==e.id);if(o.length===0)return;let n=A.tree.getRect(j),a=o.map(s=>A.tree.getRect(s));w.merge(...a).height+t.height<=n.height||(j.set({height:n.height,heightType:2}),o.forEach((s,c)=>{let d=a[c];E(d,"Child rect must be defined"),WA(s)&&Je(s)&&s.heightType===3&&s.set({height:d.height,heightType:0})}))}var wE=Fj(rh());var Ja=Fj(Mr()),Kl=Fj(ui());function Va(A){let j=A.name||At(A);return/^\s*$/u.test(j)?A instanceof tm?"Text":"Layer":j}function LE({node:A,renderTarget:j=$i.export,addNames:e=!1,isDarkMode:t,combinedVariableValueMap:r}){if(xr(A))return A.svg;let o=[],n=!0,a=null;SA(A)?(a=A,A.children.map(g=>{JA(g)&&o.push(g)})):(n=!1,o.push(A));let i=A.tree();E(i,"cannot render nodes to svg without a tree"),o=o.map(g=>dm(g,i,t)),pm(i,r,t);let s={needsXlinks:!1},c=o.map(g=>(ql(g,s),Ll(g,n,e,r))),d=null,p=a?.fillEnabled&&a.exportIncludesBackground&&!ok(a);if(p&&a){let g=new om(a.raw({__class:"RectangleShapeNode"}));ql(g,s),d=Ll(g,!1,!1,r)}let k=(0,Ja.jsx)(zd,{isStatic:!0,children:(0,Ja.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:s.needsXlinks?"http://www.w3.org/1999/xlink":void 0,width:Us(A.width,3),height:Us(A.height,3),fill:"none",overflow:SA(A)?void 0:"visible",children:[p&&d,c]})});return Ud({target:j},()=>wE.renderToStaticMarkup(k))}function qE(A){return A.replace(/[\f\n\r\t\v\xa0\u1680\u2000-\u200a\u2028\u2029\u202f\u205f\u3000\ufeff]+/gu," ").replace(/(?:\/|^)(?:\.+\/)+/gmu,"/")}function Ll(A,j,e,t){if(lt(A)){let o=A.getProps(t);return(0,Kl.createElement)(M7,{...o,key:A.id,isRootVectorNode:!1,includeTransform:j},A.children.map(n=>Ll(n,!0,e,t)))}let r=A.getProps(t);return(0,Kl.createElement)(P7,{...r,key:A.id,isRootVectorNode:!1,includeTransform:j})}function ql(A,j){if(j.needsXlinks||((lt(A)||Oo(A))&&A.children&&A.children.map(p=>ql(p,j)),lt(A)))return;let{strokeEnabled:e,strokeAlignment:t,strokeWidth:r,fillEnabled:o,fillType:n,fillImage:a,boxShadows:i}=A,s=t==="inside"&&e&&e&&!!r,c=o&&n==="image"&&a!==null,d=i&&!UA(i)&&i.length>0&&i.some(p=>p!==void 0);(s||d||c)&&(j.needsXlinks=!0)}var KE=Cd({canvas:()=>{let A=cR();return cl(A),ll(A)},onPageCanvas:()=>{let A=dR();return cl(A),ll(A)}});function cR(){let A=Ej.isDebugBuild?"canvas-sandbox.debug.html":"canvas-sandbox.html",j=L6(`./${A}`),e=JSON.stringify(Ee());return j+`#services=${encodeURIComponent(e)}`}function dR(){let A=Ej.isDebugBuild?"canvas-sandbox-on-page.debug.html":"canvas-sandbox-on-page.html",j=L6(`./${A}`),e=JSON.stringify(Ee());return j+`#services=${encodeURIComponent(e)}`}var lj=class lj{constructor(j,e,t,r){this.log=j;this.windowService=e;this.windowRef=t;this.contentWindow=r}static async serviceIfAvailable(){lj.deprecatedServicePromise=lj.deprecatedServicePromise??fl.on(Pr).discover({timeout:1e3}),lj.servicePromise=lj.servicePromise??Bl.on(Pr).discover({timeout:1e3});try{return await Promise.any([lj.servicePromise,lj.deprecatedServicePromise])}catch{return}}static async isAvailable(){return!!await lj.serviceIfAvailable()}static async new(j){lj.currentWindow&&(lj.currentWindow.contentWindow.close(),lj.currentWindow=void 0);let e=await lj.serviceIfAvailable();E(e,"CustomWindow is not available");let t=mA("electron-window"),r=await e.willOpenWindow(j);t.debug("opening window...");let o=window.open(j.url,"_blank")??void 0;return E(o,"Couldn't open a new DOM window"),t.debug("opened window",o),lj.currentWindow=new lj(t,e,r,o),lj.currentWindow}async openSaveDialog({count:j,pathname:e}){return this.windowService.openSaveDialog({count:j,pathname:e})}async collectMetrics(){return this.windowService.collectMetrics()}async writeToClipboard(j){return this.windowService.writeToClipboard({...j,ref:this.windowRef})}async writeToDisk(j){return this.log.debug("capture....",this.windowRef),this.windowService.writeToDisk({...j,ref:this.windowRef})}async getImageData(j){return"getImageData"in this.windowService?(await this.windowService.getImageData({...j,ref:this.windowRef})).imageData:Promise.reject(new Error("getImageData is not available"))}};R(lj,"deprecatedServicePromise"),R(lj,"servicePromise"),R(lj,"currentWindow");var Rn=lj;var Ha=class{constructor(){R(this,"controller");R(this,"renderer");R(this,"modules");R(this,"modulesRuntime");R(this,"assets");R(this,"controlsVisibility");R(this,"flags");zA.isOn("newRpc")&&(this.controller=new um(Hj),this.renderer=this.controller.getRemote(Hj.channels.renderer),this.modules=this.controller.getRemote(Hj.channels.modules),this.modulesRuntime=this.controller.getRemote(Hj.channels.modulesRuntime),this.controlsVisibility=this.controller.getRemote(Hj.channels.controlsVisibility),this.assets=this.controller.getRemote(Hj.channels.assets),this.flags=this.controller.getRemote(Hj.channels.flags))}setLocal({componentsStore:j,loadedExternalModulesStore:e},t){this.controller&&(this.controller.setLocal(Hj.channels.rendererListener,t),this.controller.setLocal(Hj.channels.componentsStore,j),this.controller.setLocal(Hj.channels.loadedExternalModulesStore,e))}};var In=class{constructor(j){this.callbacks=j;R(this,"experimentListeners",new Map);R(this,"employeesOnlySettingsListeners",new Map);R(this,"projectFeaturesListeners",new Map)}startUpdatesStream(){Object.keys(o6).forEach(j=>{let e=t=>{this.callbacks.updateExperiments({[j]:t})};zA.addListener(j,e),this.experimentListeners.set(j,e)}),Object.keys(r6).forEach(j=>{let e=t=>{this.callbacks.updateEmployeesOnlySettings({[j]:t})};Jj.addListener(j,e),this.employeesOnlySettingsListeners.set(j,e)})}getInitialExperiments(){let j={};return Object.keys(o6).forEach(e=>{j[e]=zA.get(e)}),j}getInitialEmployeesOnlySettings(){let j={};return Object.keys(r6).forEach(e=>{j[e]=Jj.get(e)}),j}initProjectFeatures(){fr.updated.then(()=>{let j={};Object.keys(dl).forEach(e=>{j[e]=fr.get(e)}),this.callbacks.updateProjectFeatures(j),this.projectFeaturesListeners.size===0&&Object.keys(dl).forEach(e=>{let t=r=>{this.callbacks.updateProjectFeatures({[e]:r})};fr.addListener(e,t),this.projectFeaturesListeners.set(e,t)})}).catch(yA)}stopUpdatesStream(){for(let[j,e]of this.experimentListeners)zA.removeListener(j,e);for(let[j,e]of this.employeesOnlySettingsListeners)Jj.removeListener(j,e);for(let[j,e]of this.projectFeaturesListeners)fr.removeListener(j,e);this.experimentListeners.clear(),this.employeesOnlySettingsListeners.clear(),this.projectFeaturesListeners.clear()}},Qa=class{constructor(j){this.remoteFlags=j;let e=new In(this.remoteFlags);e.startUpdatesStream(),this.remoteFlags.updateExperiments(e.getInitialExperiments()),this.remoteFlags.updateEmployeesOnlySettings(e.getInitialEmployeesOnlySettings())}};var io=class{constructor(){R(this,"experimentsUpdatesEmitter",new De);R(this,"employeesOnlySettingsUpdatesEmitter",new De);R(this,"projectFeaturesUpdatesEmitter",new De);R(this,"flagsUpdater",new In(this));this.flagsUpdater.startUpdatesStream(),this.experimentsUpdatesEmitter.onNewStream=j=>{if(j?.replay==="latest")return{latest:this.flagsUpdater.getInitialExperiments()}},this.employeesOnlySettingsUpdatesEmitter.onNewStream=j=>{if(j?.replay==="latest")return{latest:this.flagsUpdater.getInitialEmployeesOnlySettings()}},this.projectFeaturesUpdatesEmitter.onNewStream=j=>{this.flagsUpdater.initProjectFeatures()}}updateExperiments(j){this.experimentsUpdatesEmitter.emit(j)}updateEmployeesOnlySettings(j){this.employeesOnlySettingsUpdatesEmitter.emit(j)}updateProjectFeatures(j){this.projectFeaturesUpdatesEmitter.emit(j)}stopUpdatesStream(){this.flagsUpdater.stopUpdatesStream()}experimentsUpdatesStream(j){return this.experimentsUpdatesEmitter.newStream(j)}employeesOnlySettingsUpdatesStream(j){return this.employeesOnlySettingsUpdatesEmitter.newStream(j)}projectFeaturesUpdatesStream(j){return this.projectFeaturesUpdatesEmitter.newStream(j)}};var Ua=mA("setup-rpc-connection"),Vl=3e4;function JE(A,j){if(!A)return Promise.resolve();let e=performance.now(),t=Et(),r=A.connect(j);return r.then(()=>{Ua.debug("Connected to controller",A.channelInterface.name),BA("connected_to_sandbox",{correlationId:t,durationMs:Math.round(performance.now()-e),userAgent:navigator.userAgent,visibility:document.visibilityState})}).catch(()=>{Ua.debug("Failed to connect to controller",A.channelInterface.name),BA("connection_to_sandbox_error",{correlationId:t,userAgent:navigator.userAgent,visibility:document.visibilityState,error:"failed to connect"})}),new Jl(Vl,()=>{if(A.isConnected)Ua.debug("Controller connected within timeout");else{BA("connection_to_sandbox_error",{correlationId:t,userAgent:navigator.userAgent,visibility:document.visibilityState,error:`not connected within ${Vl}ms`});let o=new Error(`RPC connection timeout after ${Vl}ms`);Ua.reportCriticalError(o)}}),r}var VE=10,Jl=class{constructor(j,e){this.millis=j;this.callback=e;R(this,"round",0);R(this,"timer",0);R(this,"arm",()=>{this.round>=VE?this.callback():(this.round+=1,this.timer=window.setTimeout(this.arm,this.millis/VE))});this.arm()}cancel(){this.timer&&(clearTimeout(this.timer),this.timer=0)}};async function HE(A,j,e,t,r){if(!e)throw Error("ServiceSandbox: no trusted sandbox origin");if(A){await JE(A,{target:j,url:e}),await A.getRemote(Hj.channels.renderer).initialize(zo,t);return}let o=!1,n=new Nd(j,e),a=await qs.on(n).discover({timeout:3e4}),i=new io;A||ki.on(n).register(i);let s=zo;await a.initialize({renderTarget:t,upgradeToMessagePortChannel:o,treeVersion:s}),r.debug("ServiceSandbox: ready to initialize contentWindow. Establishing channel\u2026");let c=new MessageChannel,d=qs.service.fingerprint;return j.postMessage(d,e,[c.port2]),o&&(i.stopUpdatesStream(),r.debug("ServiceSandbox: unregistering initializer"),await at.shared().unregister(n)),r.debug("ServiceSandbox: service channel ready"),o?new Dd(c.port1):n}var QE=new WeakMap,Hl=new Set;function UE(A){return QE.get(A())?Promise.resolve():new Promise((j,e)=>{let t=setTimeout(()=>{e(new Error("waitForReadyToInitialize timed out"))},1e4);Hl.add({source:A,resolveReady(){clearTimeout(t),j()}})})}window.addEventListener("message",A=>{if(A.data!==mm)return;let j=A.source;if(j){QE.set(j,!0);for(let e of Hl)e.source()===j&&(Hl.delete(e),e.resolveReady())}},!1);var Fn=class extends Ha{constructor(e,t,r){super();R(this,"log",mA("window-sandbox"));R(this,"channelPromise");R(this,"windowPromise",Vt());this.channelPromise=(async()=>{let o=await Rn.new({...r,url:e.url});return this.log.debug("WindowSandbox: created custom window"),this.windowPromise.resolve(o),this.controller||(await UE(()=>o.contentWindow),this.log.debug("WindowSandbox: loaded")),HE(this.controller,o.contentWindow,e.origin,t,this.log)})()}static async isAvailable(){return Rn.isAvailable()}waitForServiceChannel(){return this.channelPromise}async openSaveDialog({count:e,pathname:t}){return(await this.windowPromise).openSaveDialog({count:e,pathname:t})}async collectMetrics(){return(await this.windowPromise).collectMetrics()}async writeToClipboard(e){return(await this.windowPromise).writeToClipboard(e)}async writeToDisk(e){return(await this.windowPromise).writeToDisk(e)}async getImageData(e){return(await this.windowPromise).getImageData(e)}};var Gn=class{constructor(){R(this,"metricsMap",new Map)}static trackError(j){Gl({exportCount:0,success:!1,scope:"selection",errorReason:j})}createErrorReason({sizeKb:j,hasSavedToDisk:e}){if(!e)return"Export success, but no file was written";if(j===0)return"Export success, but the file is 0kb"}createId({nodeId:j,pixelRatio:e}){return j+"-"+e}mergeElectronMetrics(j){for(let e of j){let t=this.createId({nodeId:e.nodeId,pixelRatio:e.pixelRatio}),r=this.metricsMap.get(t);r&&this.metricsMap.set(t,{...r,sizeKb:e.kb,success:e.hasSavedToDisk})}}add(j,e){let t=this.createId({nodeId:j.nodeId,pixelRatio:j?.pixelRatio??1}),r=this.metricsMap.get(t)??{};this.metricsMap.set(t,{...r,...e})}track(){for(let[j,e]of this.metricsMap){let t=this.createErrorReason({sizeKb:e.sizeKb??0,hasSavedToDisk:e.hasSavedToDisk??!1});Gl({durationMs:e.durationMs,format:e.format,exportCount:e.exportCount,success:e.success,scope:e.scope,sizeKb:e.sizeKb,errorReason:e.errorReason??t})}this.metricsMap.clear()}};function WE(A){for(let j of A.walk())if(rk(j))return!1;return JA(A)||SA(A)||xr(A)}function zE(A){return LE({...A})}var pR=3,ao=mA("PartialTreeSender"),Wa=class{constructor(j,e){this.timeline=j;R(this,"name");R(this,"currentScopeId","");R(this,"timelineCursor");R(this,"scopeBufferMap",new Map);this.name=e+"-"+String(Math.round(Math.random()*1e3))}resetScopeBuffer(j){this.scopeBufferMap.clear(),this.currentScopeId=j??"",j&&(this.timelineCursor=void 0,this.scopeBufferMap.set(j,performance.now()))}updateScopeBuffer(j){if(this.currentScopeId===j)return[void 0,void 0];if(j===rr)return[void 0,void 0];if(this.currentScopeId=j,this.scopeBufferMap.has(this.currentScopeId))return this.scopeBufferMap.set(this.currentScopeId,performance.now()),[void 0,void 0];let e;if(this.scopeBufferMap.size>=pR){let t=ZE(),r=1/0,o;for(let[n,a]of this.scopeBufferMap)t.has(n)||r>a&&(r=a,o=n);o&&(this.scopeBufferMap.delete(o),e=o)}return this.scopeBufferMap.set(this.currentScopeId,performance.now()),[e,j]}reset(j){let e=this.timeline.tree;return this.resetScopeBuffer(j),YE(e,j)}update(j){if(!j)return{};let e=this.timeline.tree,t=this.timeline.fetchForwardChanges(this.timelineCursor);if(!t)return this.timeline.invalidatedByLoadCompletedDocument(this.timelineCursor)?(ao.debug(this.name,"cursor invalidated, sending empty update for load completed document"),this.timelineCursor=this.timeline.getChangeTrackingCursor(),{}):(ao.debug(this.name,"cursor invalidated, sending tree with scope:",j),this.resetScopeBuffer(j),this.timelineCursor=this.timeline.getChangeTrackingCursor(),{name:this.name,tree:YE(e,j),timestamp:Date.now()});let[r,o]=this.updateScopeBuffer(j);r&&(ao.debug(this.name,"deleting scope by diff:",r),XE(r,t)),t.length===0&&(t=void 0);let n;if(o&&(ao.debug(this.name,"adding scope by subtree:",o),n=this.getScopeSubTree(e,o)),t){let a=this.getAffectedScopeIDsAfterCrossScopeMove(e,t);for(let i of a){if(i!==this.currentScopeId){this.scopeBufferMap.has(i)&&(ao.debug(this.name,"deleting scope due to cross-scope move:",i),XE(i,t),this.scopeBufferMap.delete(i));continue}n||(ao.debug(this.name,"resending tree with scope due to cross-scope move:",i),n=this.getScopeSubTree(e,i))}}return{changes:t,scopes:n?[n]:void 0,timestamp:Date.now()}}getScopeSubTree(j,e){let t=j.get(e);return tr(t)&&E(t.isLoaded(),"Scope must be loaded"),kR(t)}getAffectedScopeIDsAfterCrossScopeMove(j,e){let t=new Set;for(let r of e){if(!r.previousScope||!r.to.parentid)continue;let o=j.get(r.id),n=j.getScopeNodeFor(o);n&&t.add(n.id)}return t}};function XE(A,j){j.push({id:A,removed:"CanvasNode",to:{}})}function kR(A){if(A)return M6.valueFromNode(A)}function ZE(){return new Set([bt,ka,Yu,te,uu,rr])}function YE(A,j){let e=ZE();j&&e.add(j);let t=A.getNodes(e).map(a=>M6.valueFromNode(a)),r=A.root,o,n={};for(o in r)q7[o]||(n[o]=r[o]);return{version:zo,root:{...n,__class:"RootNode",id:A.root.id,children:t}}}function Af(A,j){let e=Ur(A);if(!e)return j;let t=new Map(j.map(o=>[o.id,o])),r=[];for(let o of e.walk()){if(!kt(o)||!o.webPageId)continue;let n=t.get(o.webPageId);n&&r.push(n)}return r}function jf(A,j,e=!1,t=!1){let r=j?.[A];if(r)return r;if(A===lp&&e)return t?"Key":"Key & Gamepad";if(t&&A==="onMouseEnter")return"Enter";let n=(A.startsWith("on")&&A.length>2?A.substring(2):A).replace("Tap","Click");return Fi(n)}function uR(){let A=null,j=null;return e=>{let t=V.componentForIdentifier(e.codeComponentIdentifier);if(t===A)return j;if(!t||!t.properties)return null;let r={},o=Object.keys(t.properties);for(let n=0,a=o.length;n<a;n++){let i=o[n],s=t.properties[i];s?.type==="eventhandler"&&s.title&&(r[i]=s.title)}return A=t,j=r,r}}var Gx=uR();function mR(A){if(A.type!=="controlReference"&&A.type!=="nodePropertyControlReference")return;let{expectedType:j}=A;E(j==="enum"||j==="segmentedenum"||j==="file")}function Mx({galleryImageId:A,isSmartComponent:j}){return j?Array(4).fill(null).map(()=>({id:kj(),type:"object",value:{[A]:{type:"image",value:void 0}}})):[]}function ef(A,j){return E(A.type!=="responsiveimage",`Image variables are compiled to be responsive images. To
        prevent confusion we don't allow creation of type responsive images.
        Because that would mean that two different types represent the same thing.`),mR(A),A.type!=="trackingid"&&A.type!=="vectorsetitem"&&BA("variable_create",{scopeType:j,variableType:A.type}),A.type==="image"&&(M(A.initialValue)?Qs(A.initialValue)||(A.initialValue=void 0):Zj(A.initialValue)&&M(A.initialValue.value)&&(Qs(A.initialValue.value)||(A.initialValue=void 0))),A.type==="array"&&j==="canvas_component"&&(E(A.minCount===void 0,"minCount should not be lifted to component"),E(A.maxCount===void 0,"maxCount should not be lifted to component")),{id:kj(),...A}}function ER(A,j){let e=new Set(A.variables.map(t=>t.name));return Pj(Fi(j),e)}function fR(A){switch(A.type){case"controlReference":case"nodePropertyControlReference":switch(A.expectedType){case"enum":return"Type";case"file":return"File";default:throw Error(`getFallbackNameForCreateVariableOptions(), unsupported file reference type: ${A.expectedType}`)}default:return Dp(A.type)}}function $R(A,j){if(A==="richtext")return j.length;let e=Wt;return j.forEach((t,r)=>{if(!Xj(e)){if(t.type!=="richtext"){Z(e)&&(e=qt);return}N7(e)||(e=r)}}),Z(e)?e:j.length}function BR(A){return ej(A)?"collection":oj(A)?"layout_template":(rA(A)||E(!0,"Should not be able to create variables on invalid scope",A.__class),"canvas_component")}function Ql(A,j){let{scopeId:e,isAssigned:t=!0,useUniqueName:r=!0,...o}=j,n=A.get(e);if(!n||!Ue(n))return null;let a=j.name.trim(),i=a||fR(j),s=r?ER(n,i):i,c=ef({...o,name:s},BR(n));if(c.type==="eventhandler"&&!rA(n))return null;let d=$R(c.type,n.variables),p=$e.insert(n.variables,d,c);return n.set({variables:p}),t&&Hm({variableType:c.type,variableId:c.id}),Lj(c.id,n.id)}function Wx(A){let{engine:j,showModal:e=!0,...t}=A,r=Ql(j.tree,t);if(!r)return null;let o=j.tree.get(A.scopeId);return!o||!Ue(o)?null:(oo(j)&&e&&(j.stores.variablesStore.selectedVariableId=r.id,j.stores.modalStore.set({type:"Variables",source:"properties"})),Lj(r.id,o.id))}var gR=mA("createAndAssignActionVariableToNode");function tf(A,j,e,t,r){if(!(Ie(j)||z(j)))return null;let o=A.getScopeNodeFor(j);if(!o||!rA(o))return null;let n=A.getGroundNodeFor(j);if(!n||!nj(n))return null;let a=V.componentForIdentifier("framer/useTriggerEvent");if(!a)return null;let i=Ql(A,{scopeId:o.id,type:"eventhandler",name:t??jf(e,null),initialValue:void 0});if(!i)return null;ca(A,j,e,a,{id:{type:"string",value:i.id}});let s=o.getTopLevelReplicaVariants();for(let c of s){let{overrides:d}=c.replicaInfo;d[j.id]&&Yk(A,c,j.id,e,a,{id:{type:"string",value:i.id}})}return r&&r.updateComponent(o.id).catch(c=>gR.error(c)),i.id}function hR(A){let j=la(A);if(Object.keys(j).length!==0)for(let t in j){let r=j[t];if(r&&r.length===0)return t}}function RR(A,j,e){switch(j){case"framer/useShowOverlay":return A.create(_u,e);case"framer/useShowRelativeOverlay":return A.create(pe,e,{width:200,height:150,radius:10,boxShadows:[w7({x:0,y:10,blur:20,color:"rgba(0,0,0,0.05)",spread:0})],floatingPositionEnabled:!0,floatingPlacement:Vi,floatingAlignment:Ji,floatingOffsetX:mp,floatingOffsetY:Ep,floatingCollisionDetection:!0,floatingCollisionPadding:up});default:cA(j)}}function IR(A,j,e,t){e&&E(j==="framer/useShowOverlay"&&xo(e)||j==="framer/useShowRelativeOverlay"&&(fA(e)||z(e)),"Invalid overlay type: ",e.__class,"for overlay action: ",j);let r=e??RR(A,j,t.id);return $j(r)&&r.set({zIndex:Np,styleAppearEffectEnabled:!0,styleAppearEffectTrigger:"onMount",overflow:Fe(),position:"absolute",...ru.fadeIn()}),r}function FR(A,j,e,t,r){E(Xo(e),"Parent is not a local smart component instance, events can't be created");let o=Yp(A,e);A.loadScopes([o],([n])=>{if(!n)return;let a=n.getPrimaryVariant();E(a,"SmartComponentNode should have a primary variant");let i=tf(A,a,t,t==="onMouseEnter"?"Hover":void 0,j);E(i,"Should be able to create event key for local smart component node"),r(i)})}function rf(A,j,e,t,r){let o=V.componentForIdentifier(j);E(o,"Cannot find overlay action definition"),ca(A,r,t,o,{overlay:{type:"string",value:e.id}},!0)}function GR(A){switch(A){case"framer/useShowOverlay":return"fixed";case"framer/useShowRelativeOverlay":return"relative";default:cA(A)}}function za({treeStore:A,codeGenerationStore:j},e,t,r){let o=A.tree.get(t);if(!o)return;let n=hA(o)?A.tree.get(o.originalid):o;if(!n||!Ie(n)&&!z(n))return;let a=e==="framer/useShowRelativeOverlay"?"onMouseEnter":"onTap",i=z(n)?hR(n):a,s=Xo(n);if(!i&&!s)return;let c=IR(A.tree,e,r,n);return i?rf(A.tree,e,c,i??a,n):FR(A.tree,j,n,a,d=>rf(A.tree,e,c,d,n)),BA("overlay_create",{source:r?"duplicate":"events_panel",overlayType:GR(e)}),c}var of=mA("ScopeStore");function Sn(A){return sj(A,!0)||J(A,!0)||qj(A,!0)}function nf(A){if(sj(A))return"CanvasPage";if(J(A))return"WebPage";if(rA(A))return"SmartComponent";if(Nr(A))return"ContentManagement";if(oj(A))return"LayoutTemplate";if(Ae(A))return"VectorSet";if(y7(A))return"Analytics";if(b7(A))return"LocalizationGlossary";if(qj(A))return"DesignPage";throw Error(`Failed to return scope type, invalid scope: ${A.__class}`)}var gr,hr,Rr,Ir,so,Wj,et,Ct,lo,co,po,af=class extends re{constructor(e,t,r,o,n,a,i,s,c,d,p){super();this.treeStore=e;this.canvasStore=t;this.selection=r;this.chromeStore=o;this.contentManagementStore=n;this.modalStore=a;this.overlayStore=i;this.codeGenerationStore=s;this.insertSidebarStore=c;this.modulesStore=d;this.setHighlight=p;xA(this,gr,0);R(this,"isCheckingActivePage",!0);xA(this,hr,"");xA(this,Rr,"");xA(this,Ir,"");xA(this,so,"");xA(this,Wj,[]);xA(this,et,!1);xA(this,Ct,!1);xA(this,lo,new Map);xA(this,co,new Map);R(this,"loadingActiveId");R(this,"_activeId");R(this,"scopeSwitchStart",0);R(this,"scopeSwitchPending",!1);R(this,"scopeIdToSelectedCollectionItem",new Map);R(this,"rootScopeType","CanvasPage");xA(this,po,[]);R(this,"canGoBack",()=>tA(this,et));R(this,"goBack",()=>{let e=Array.from(this.isolatedCanvasNodes());e.pop();let t=e.pop();t&&this.select(t.id,{keepHistory:!1})});let k=this.getFirstPageNodeAccordingToUI();this._activeId=k.id,Wo(k),sj(k)?FA(this,hr,k.id):J(k)?FA(this,Rr,k.id):qj(k)&&FA(this,Ir,k.id);let $=this.getScopeNodes();FA(this,gr,$.indexOf(k)),E(k.loaded,"Scope must be fully loaded"),c.onScopeChange({scope:k.loaded,hasCanvasPageNodes:this.hasCanvasPageNodes(),hasWebPageNodes:this.hasWebPageNodes()}),this.modulesStore.setActiveScope(this._activeId)}get activeId(){return this._activeId}get active(){let e=this.getScopeNode(this._activeId);return E(e.isLoaded(),"Scope must be fully loaded"),e}get rootNode(){return this.treeStore.tree.root}get checkingActivePage(){return this.isCheckingActivePage}documentDidLoad(){this.isCheckingActivePage=!1}get scopeType(){return nf(this.active)}getScopeNode(e){let t=this.treeStore.tree.get(e);return E(t instanceof R6,"Node, ",e,"is not a ScopeNode"),t}getScopeNodes(){return this.rootNode.children.filter(tr)}getCanvasPageNodes(){return this.rootNode.children.filter(sj)}getDesignPageNodes(){return this.rootNode.children.filter(qj)}getSmartComponentNodes(){return this.rootNode.children.filter(rA)}getLayoutTemplateNodes(){return this.rootNode.children.filter(oj)}getWebPageNodes(){return this.rootNode.children.filter(J)}getWebPageNodesWithoutCollection(){return this.rootNode.children.filter(e=>J(e,!0)&&!e.dataIdentifier)}getWebPageNodesWithCollection(e=!1){let t=this.rootNode.children.filter(r=>!!(J(r)&&r.dataIdentifier));return e?Af(this.treeStore.tree,t):t}hasPages(){let e=!1,t=!1,r=!1,o=!1;for(let n of this.rootNode.children)if(sj(n)&&(r=!0),qj(n)&&(o=!0),J(n)&&(n.dataIdentifier?t=!0:e=!0),e&&t&&r&&o)break;return{hasSitesPages:e,hasCMSPages:t,hasCanvasPages:r,hasDesignPages:o}}hasCanvasPageNodes(){return this.rootNode.children.some(sj)}hasWebPageNodes(){return this.rootNode.children.some(J)}getCanvasPageAndWebPageNodes(){return this.rootNode.children.filter(Sn)}getFirstPageNodeAccordingToUI(e=this.treeStore.tree){let{children:t,homePageNodeId:r}=e.root;return fm(t,r)}getFirstWebPageNode(){try{let e=this.getFirstPageNodeAccordingToUI();if(J(e))return e}catch{}}changeActive(e,t,r){if(this._activeId){let i=e.get(this._activeId),s=J(i)&&i.abTestingParentId?i.abTestingParentId:this._activeId;tA(this,lo).set(s,{zoom:this.canvasStore.zoom,offset:this.canvasStore.offset}),tA(this,co).set(this._activeId,this.selection.ids),rA(i)&&BA("component_canvas_exit",{componentId:this._activeId})}if(FA(this,so,this._activeId),FA(this,gr,r),this._activeId=t.id,Wo(t),this.codeGenerationStore.changeScope(),this.modulesStore.changeScope(t),qj(t))this.rootScopeType="DesignPage",FA(this,Ir,t.id),FA(this,Wj,[]),FA(this,et,!1),FA(this,Ct,!1);else if(sj(t))this.rootScopeType="CanvasPage",FA(this,hr,t.id),FA(this,Wj,[]),FA(this,et,!1),FA(this,Ct,!1);else if(J(t))this.rootScopeType="WebPage",FA(this,Rr,t.id),FA(this,Wj,[]),FA(this,et,!1),FA(this,Ct,Dj(t));else if(rA(t)||oj(t)||Ae(t)){let i=tA(this,Wj).indexOf(t.id);i===-1?tA(this,Wj).push(t.id):tA(this,Wj).splice(i+1),FA(this,et,tA(this,Wj).length>0),FA(this,Ct,!1),qm({componentId:t.id}),rA(t)&&this.chromeStore.mainView===0&&this.modalStore.displayComponentIsolationModal({source:"automatic"})}let o=tA(this,lo).get(J(t)&&t.abTestingParentId?t.abTestingParentId:t.id);o?this.canvasStore.updateCanvas(o.offset,o.zoom):this.canvasStore.zoomAfterScopeSwitch(e,t);let n=tA(this,co).get(t.id);n?this.selection.set(n):this.selection.clear(),this.overlayStore.hideAll(),this.insertSidebarStore.onScopeChange({scope:t,hasWebPageNodes:this.hasWebPageNodes(),hasCanvasPageNodes:this.hasCanvasPageNodes()}),this.setHighlight(null);let a=nf(t);this.chromeStore.onChangeScopeType(a),this.contentManagementStore.onChangeScopeType(a)}select(e,{keepHistory:t,activateContentPanel:r,collectionItemId:o}){this.loadingActiveId=e,this.scopeSwitchStart=performance.now();let n=()=>{if(this.scopeSwitchPending=!1,this.loadingActiveId!==e||this._activeId===e)return;let s=this.getScopeNodes().findIndex(k=>k.id===e);E(s!==-1,"Tree must contain scope node");let d=this.treeStore.tree.latestTree().getNode(e);E(tr(d),"Tree must contain scope node");let p;if(d.isLoaded())p=d.loaded;else if(!this.treeStore.tree.getService("loader"))of.reportError(new ReferenceError("Loader service is not available in the tree but scope is not loaded"),{message:"Scope must be fully loaded"},{shallowScopes:"true"}),p=d;else throw new TypeError("Scope must be fully loaded");t||FA(this,Wj,[]),M(o)&&J(d)&&this.setSelectedCollectionItemForWebPage(d.id,o),r&&(this.chromeStore.contentPanelTab=r),this.changeActive(this.treeStore.tree,p,s)},a=this.treeStore.tree.getService("loader");if(a&&!a.hasLoadedScope(e)){this.scopeSwitchPending=!0,a.prioritizeLoadingScope(e,()=>this.processWhenReady(n));return}n()}selectByNode(e){let t=this.treeStore.tree.get(e);if(t===null)return;let r=this.treeStore.tree.getScopeNodeFor(t);r!==null&&this.select(r.id,{keepHistory:!1})}selectPreviousActiveScope(){let e=this.treeStore.tree.get(tA(this,so));this.select(e?.id??this.getFirstPageNodeAccordingToUI().id,{keepHistory:!1})}findNextActiveScope(e=this.treeStore.tree){let t=e.root,r=t.children.filter(tr);E(t.children.some(Sn),"validateActiveScope: Tree must contain at least one Canvas Page or Web Page");let o=r.findIndex(n=>n.id===this._activeId);return o===-1&&(o=this.findNextAvailablePageIndex(r,tA(this,gr))),[r[o],o]}validateActiveScope(e=this.treeStore.tree,t=!1){let[r,o]=this.findNextActiveScope(e);E(r,"ScopeNode must be defined"),t||E(r.isLoaded(),"Scope must be fully parsed"),FA(this,gr,o);let n=r;return r.id!==this._activeId&&(this.scopeSwitchStart=performance.now(),this.scopeSwitchPending=!1,this.changeActive(e,n,o)),n}findNextAvailablePageIndex(e,t){let r=[],o=[];for(let s=0;s<e.length;s++){let c=e[s];J(c)?o.push(s):sj(c)&&r.push(s)}let n=this.rootScopeType==="WebPage",a=n?o:r,i=n?r:o;return SR(a.length>0?a:i,t)}renameScope(e,t){this.getScopeNode(e).set({name:t})}getActiveScopeNodeForReset(e=this.treeStore.tree,t=null){if(t){let o=e.getScopeNodeFor(e.get(t));if($m(o)&&o?.isValid())return o}let r=this.getFirstPageNodeAccordingToUI(e);if(J(r)&&r.isValid()&&r.loaded||sj(r)&&r.loaded)return r.loaded;of.warn("getActiveScopeNodeForReset: falling back to scanning for a useful scope to make active");for(let o of e.root.children)if(sj(o)&&o.isValid()&&o.loaded||J(o)&&o.isValid()&&o.loaded)return o.loaded;for(let o of e.root.children)if(rA(o)&&o.isValid()&&o.loaded)return o.loaded;throw Error("Document does not have any scopes that can be set to active.")}resetActiveScope(e=this.treeStore.tree,t=void 0){let r=this.getActiveScopeNodeForReset(e,t);if(r.id===this._activeId)return;this._activeId="",FA(this,hr,""),FA(this,Ir,""),FA(this,Rr,""),FA(this,so,""),tA(this,lo).clear(),tA(this,co).clear(),E(r.isLoaded(),"Scope must be fully parsed");let o=e.root.children.indexOf(r);this.scopeSwitchStart=performance.now(),this.scopeSwitchPending=!1,this.changeActive(e,r,o)}movePage(e,t){let r=this.getScopeNode(e),o=[];qj(r)?o=this.getDesignPageNodes():sj(r)?o=this.getCanvasPageNodes():E(!r,"Scope is not movable",r);let n=o[t];E(n,`Trying to move a page node to an invalid index: ${t}, total: ${o.length} page nodes.`);let a=this.rootNode.children.findIndex(i=>i.id===n.id);E(r.parentid,"Scope node has no parentid"),E(a!==-1,"Cant find scope in root node"),this.treeStore.tree.moveNode(r,r.parentid,a)}getParentId(e,t){let r=this.rootNode.id;if(e instanceof R6||_r(e))return r;let o=this.active,n=o.id;return Nr(o)&&E(xi(e),"ContentManagementNode only accepts content nodes"),t===r?n:t??n}insertNode(e,t,r,o){t=this.getParentId(e,t),Kj(e)&&za({codeGenerationStore:this.codeGenerationStore,treeStore:this.treeStore},$j(e)?"framer/useShowRelativeOverlay":"framer/useShowOverlay",t,e),this.treeStore.tree.insertNode(e,t,r,o)}insertNodes(e){for(let t of e)this.insertNode(t,t.parentid)}moveNode(e,t,r,o){t=this.getParentId(e,t),this.treeStore.tree.moveNode(e,t,r,o)}removeNode(e){this.treeStore.tree.removeNode(e),e.id===this._activeId&&this.validateActiveScope(this.treeStore.tree,!0)}setSelectedCollectionItemForWebPage(e,t){if(this.scopeIdToSelectedCollectionItem.get(e)===t)return;let o=new Map(this.scopeIdToSelectedCollectionItem);o.set(e,t),this.scopeIdToSelectedCollectionItem=o}getSelectedCollectionItemForScope(e){if(J(e))return this.scopeIdToSelectedCollectionItem.get(e.id)}getMostRecentPage(){switch(this.rootScopeType){case"CanvasPage":{let e=this.treeStore.tree.get(tA(this,hr));if(sj(e))return e;break}case"DesignPage":{let e=this.treeStore.tree.get(tA(this,Ir));if(qj(e))return e;break}case"WebPage":{let e=this.treeStore.tree.get(tA(this,Rr));if(e&&tr(e)&&J(e))return e;break}}return this.getFirstPageNodeAccordingToUI()}getComponentHistory(){if(tA(this,Wj).length===0)return[];let e=this.active;if(!(rA(e)||oj(e)||Ae(e)))return[];let t=[],r;for(let o of tA(this,Wj)){let n=this.treeStore.tree.getNode(o);(rA(n)||oj(n)||Ae(n))&&n.isLoaded()&&(t.push(n),r=n)}return r===e?t:[e]}get onIsolatedCanvas(){return tA(this,et)}get onCollectionPage(){return tA(this,Ct)}isolatedCanvasNodes(){let e=this.active,t;return Sn(e)?t=[e]:t=[this.getMostRecentPage(),...this.getComponentHistory()],Ht(tA(this,po),t)?tA(this,po):(FA(this,po,t),t)}getTopMostWebPageNode(){for(let e of this.isolatedCanvasNodes())if(J(e))return e}};gr=new WeakMap,hr=new WeakMap,Rr=new WeakMap,Ir=new WeakMap,so=new WeakMap,Wj=new WeakMap,et=new WeakMap,Ct=new WeakMap,lo=new WeakMap,co=new WeakMap,po=new WeakMap;function SR(A,j){for(let e of A)if(!(e<j))return e;return Math.max(...A)}var A8=Pr,lf=Ej.isAutomation?Pr:_d;var Xa=class{constructor(j,e){R(this,"sandbox");R(this,"log");R(this,"engine");R(this,"wantsEngineUpdates");R(this,"renderState");R(this,"partialTreeSender");R(this,"timelineCursor");R(this,"onSandboxServicesReady");R(this,"onSandboxStateChange",j=>{typeof j!="boolean"&&this.log.reportError(j)});R(this,"onSandboxRender");R(this,"fail",j=>{this.readyForRenderingPromise.reject(j),this.onSandboxStateChange?.(j)});R(this,"renderServiceIfDiscovered");R(this,"readyForRenderingPromise",Vt());R(this,"flagsService",new io);R(this,"lastSandboxTreeUpdate",0);R(this,"onRenderedUpdate",j=>{this.lastSandboxTreeUpdate&&(this.lastSandboxTreeUpdate<j.update?(this.fail(new Error(`dropped tree update: ${this.lastSandboxTreeUpdate} < ${j.update}`)),this.lastSandboxTreeUpdate=0):this.lastSandboxTreeUpdate===j.update&&(this.lastSandboxTreeUpdate=0)),this.onSandboxRender&&(this.onSandboxRender(j),this.updateGroundNodeOverflowSizes());let{scopeId:e,scopeSwitchStartTime:t,renderEndTime:r,updateEndTime:o}=j;if(t&&o&&r){let n=Math.round(o-t),a=Math.round(r-t),{scopeStore:i}=this.engine.stores,{scopeSwitchStart:s,scopeSwitchPending:c,activeId:d}=i,p=a,k=!1;d===e&&(p=performance.now()-s,k=c);let $=this.engine.tree.get(e);$&&Sn($)&&wm({pageId:e,renderDurationMs:a,updateDurationMs:n,totalDurationMs:p,neededLoading:k})}});R(this,"onChannelReady",async j=>{if(j){let r=await xd.on(j).discover({timeout:3e4});this.log.debug("Discovered render service"),this.renderServiceIfDiscovered=r,r.renderedUpdateStream({oneway:!0}).read(this.onRenderedUpdate).catch(this.fail),ki.on(j).register(this.flagsService)}let{modulesStore:e}=this.engine.stores;this.sandbox.modules?e.getModulesUpdatesService().moduleUpdatesStream({replay:"latest"}).read(r=>this.sandbox.modules?.updateModules(r.patches,r.dependentModules,r.prioritizedModules,r.initialized,r.revision)).catch(this.fail):(E(j,"neither old or new rpc defined for modules"),Od.on(j).register(e.getModulesUpdatesService()));let t=new De;t.emit({}),j&&Ls.on(j).register({assetUpdatesStream:t.newStream}),Qd(Ls.on(lf).discover(),async r=>{this.sandbox.assets?r.assets&&this.sandbox.assets.oneway.updateAssets(r.assets):t.emit(r)}),this.onSandboxServicesReady&&(this.renderServiceIfDiscovered?await this.onSandboxServicesReady(j,this.renderServiceIfDiscovered):this.sandbox.renderer&&await this.onSandboxServicesReady(j,this.sandbox.renderer)),this.wantsEngineUpdates&&(this.engine.addSandbox(this),this.engine.changes.observe("PendingBundle",()=>this.update(!0)),this.engine.loadWasCalled&&this.update(!0)),this.log.debug("Initialized render sandbox"),this.onSandboxStateChange?.(!0),this.renderServiceIfDiscovered?this.readyForRenderingPromise.resolve(this.renderServiceIfDiscovered):this.sandbox.renderer&&this.readyForRenderingPromise.resolve(this.sandbox.renderer)});R(this,"previousTransform");R(this,"previousActiveLocaleId");R(this,"previousIsReadyToRender");R(this,"previousPerformanceMode");R(this,"previousLoadedAllUserData");R(this,"previousRenderScope");R(this,"previousRenderNodes");R(this,"previousSelection");R(this,"previousNodeInTextEditor");R(this,"previousNodeInEffectPreview");R(this,"previousActiveEffect");R(this,"previousActiveEffectIds");R(this,"previousNodesInMoveToolRootFontSize");R(this,"previousActiveOverlays");R(this,"previousPlaceholder");R(this,"previousRootFontSize");R(this,"previousIsDarkMode");R(this,"previousScopeIdToSelectedCollectionItem");R(this,"previousShouldSetMinHeight");R(this,"previousActiveLinkStyle");R(this,"update",(j=!0)=>{let e=this.renderState(),t=e.transform,r=!Be(t,this.previousTransform);if(this.previousTransform=t,!j)return this.sendSandboxUpdate(void 0,r?t:void 0);let o=!1,n={},a=this.engine,{treeStore:i,loadingStore:s,chromeStore:c,persistedUserDefaults:d}=a.stores,p=i.timeline,k="renderScope"in e?e.renderScope:void 0;k!==this.previousRenderScope&&(this.previousRenderScope=k,o=!0,n.renderScope=k),this.previousRenderScope||(this.previousRenderScope=p.tree.root.children[0]?.id??"");let $=!Jj.isOn("disablePartialTreeInSandbox");if(!this.partialTreeSender&&$?(this.partialTreeSender=new Wa(p,"sandbox"),this.timelineCursor=void 0):this.partialTreeSender&&!$&&(this.partialTreeSender=void 0),this.partialTreeSender){p.legacyMode=!1;let v=this.partialTreeSender.update(this.previousRenderScope);n.partialTreeUpdate=v,v.tree?(o=!0,r=!0,n.loadedSomeUserData=s.isDocumentLoaded):(v.changes||v.scopes)&&(o=!0)}else{let v=p.fetchForwardChanges(this.timelineCursor);p.legacyMode=!0,v?(this.log.trace("change tracking cursor changes:",v.length),v.length>0&&(n.changes=v,o=!0)):(this.timelineCursor=p.getChangeTrackingCursor(),this.log.debug("change tracking cursor invalidated, sending full tree:",p.tree.size()),p.tree.beginAllowPartialScopeAccess(),n.tree=p.tree.toJS(),p.tree.endAllowPartialScopeAccess(),o=!0,r=!0,n.loadedSomeUserData=s.isDocumentLoaded)}zA.isOn("debugEditWhileNeverLoadingRest")?!this.previousLoadedAllUserData&&s.hasMinimalEditableData&&(this.previousLoadedAllUserData=!0,n.loadedAllUserData=!0):!this.previousLoadedAllUserData&&s.hasFullDocumentData&&(this.previousLoadedAllUserData=!0,n.loadedAllUserData=!0);let g=c.canvasLocaleId;g!==this.previousActiveLocaleId&&(this.previousActiveLocaleId=g,o=!0,n.activeLocaleId=g);let G=s.assetMapLoaded;G!==this.previousIsReadyToRender&&(this.previousIsReadyToRender=G,o=!0,n.isReadyToRender=G);let I=d.performanceMode;I!==this.previousPerformanceMode&&(this.previousPerformanceMode=I,o=!0,n.performanceMode=I);let S="renderNodes"in e?e.renderNodes:void 0;Be(S,this.previousRenderNodes)||(this.previousRenderNodes=S,o=!0,n.renderNodes=S);let T="isDarkMode"in e?e.isDarkMode:void 0;T!==this.previousIsDarkMode&&(this.previousIsDarkMode=T,o=!0,n.isDarkMode=T);{let v=e.editor,P=v?.selection;P!==this.previousSelection&&(this.previousSelection=P,o=!0,n.selection=P);let _=v?.nodeInTextEditor;_!==this.previousNodeInTextEditor&&(this.previousNodeInTextEditor=_,o=!0,n.nodeInTextEditor=_);let H=v?.nodesInEffectPreview;Be(H,this.previousNodeInEffectPreview)||(this.previousActiveEffectIds=H,o=!0,n.nodesInEffectPreview=H);let O=v?.nodesInMoveToolRootFontSize;Be(O,this.previousNodesInMoveToolRootFontSize)||(this.previousNodesInMoveToolRootFontSize=O,o=!0,n.nodesInMoveToolBaseFontSize=O);let Q=v?.activeEffect;Q!==this.previousActiveEffect&&(this.previousActiveEffect=Q,o=!0,n.activeEffect=Q);let L=v?.activeEffectIds;Be(L,this.previousActiveEffectIds)||(this.previousActiveEffectIds=L,o=!0,n.activeEffectIds=L?new Set(L):null);let dA=v?.activeOverlayNodes;dA!==this.previousActiveOverlays&&(this.previousActiveOverlays=dA,o=!0,n.activeOverlayNodes=dA);let N=v?.dragAndDropPlaceholders;N!==this.previousPlaceholder&&(this.previousPlaceholder=N,o=!0,n.placeholder=N);let X=v?.rootFontSize;X!==this.previousRootFontSize&&(this.previousRootFontSize=X,o=!0,n.rootFontSize=X);let Y=v?.scopeIdToSelectedCollectionItem;Y&&Y!==this.previousScopeIdToSelectedCollectionItem&&(this.previousScopeIdToSelectedCollectionItem=Y,o=!0,n.scopeIdToSelectedCollectionItem=Y,k&&k===this.previousRenderScope&&(n.renderScope=k));let nA=v?.shouldSetMinHeight;nA!==this.previousShouldSetMinHeight&&(this.previousShouldSetMinHeight=nA,o=!0,n.shouldSetMinHeight=nA);let aA=v?.activeLinkStyle;aA!==this.previousActiveLinkStyle&&(this.previousActiveLinkStyle=aA,o=!0,n.activeLinkStyle=aA??null)}return this.sendSandboxUpdate(o?n:void 0,r?t:void 0)});R(this,"groundNodeOverflowSizes",{});this.sandbox=j,this.log=e.log,this.engine=e.engine,this.wantsEngineUpdates=e.wantsEngineUpdates,this.renderState=e.renderState,j.setLocal(e.engine.stores,{renderedUpdate:this.onRenderedUpdate,error:e.handleSandboxError??(()=>{}),heartbeat:e.heartbeat??(()=>{})}),j.waitForServiceChannel().then(this.onChannelReady).catch(this.fail),j.controller&&j.controller.waitUntilConnected().then(()=>{j.flags&&new Qa(j.flags)}).catch(t=>{this.log.error("Error while waiting for flags service",t)})}sendSandboxUpdate(j,e){if(j||e){j?.tree&&(this.lastSandboxTreeUpdate=this.engine.update),j&&(j.timestamp=Date.now());let t={type:"SandboxUpdate",update:this.engine.update,document:j,transform:e};return this.renderServiceIfDiscovered?this.renderServiceIfDiscovered.update({fixmeOpaqueJSON:t}):this.sandbox.renderer&&this.sandbox.renderer.oneway.updateSandbox(t),!0}return!1}command(j,e){this.renderServiceIfDiscovered?this.renderServiceIfDiscovered.update({fixmeOpaqueJSON:{command:j,args:e}}):this.sandbox.renderer&&this.sandbox.renderer.oneway.updateSandbox({command:j,args:e})}updateGroundNodeOverflowSizes(){let j=this.engine.tree.get(this.previousRenderScope);Wo(j);let e=j?.children;if(!e)return;let t=!1;for(let o of e){let n=o.cache,a=this.groundNodeOverflowSizes[o.id];Em(n,a)||(t=!0,this.groundNodeOverflowSizes[o.id]={minX:n.minX,maxX:n.maxX,minY:n.minY,maxY:n.maxY})}let r=Object.keys(this.groundNodeOverflowSizes);if(r.length>e.length){t=!0;let o=new Set(r);for(let n of e)o.delete(n.id);for(let n of o)delete this.groundNodeOverflowSizes[n]}t&&this.command("updateGroundNodeOverflowSizes",this.groundNodeOverflowSizes)}async renderUpdates(j){let e=await this.readyForRenderingPromise;await e.willStartUpdates(),j(),this.update(),await e.waitForCompleteRenderAfterUpdates()}get renderService(){return this.renderServiceIfDiscovered||this.sandbox.renderer||void 0}async measureNodes(j){return this.renderService?.measureNodes(j)}async getFitTextViewBoxes(j){return this.renderService?.getFitTextViewBoxes(j)}async fetchJSON(j){return this.renderService?.fetchJSON(j)}async getComponentRenderingError(j){return this.renderService?.getComponentRenderingError(j)}async preloadFonts(j){return this.renderService?.preloadFonts(j)}async waitUntilPlaceholdersSettled(){await this.renderService?.waitUntilPlaceholdersSettled()}};var Ya=class{constructor(j,e){R(this,"log",mA("node-snapshots"));R(this,"engine");R(this,"renderer");R(this,"renderState",{renderNodes:{},transform:[0,0,1],isDarkMode:!1});this.engine=e,this.renderer=new Xa(j,{log:this.log.extend("renderer"),engine:this.engine,wantsEngineUpdates:!1,renderState:()=>this.renderState})}renderToSVG({nodeId:j}){this.log.debug("preparing SVG");let t=this.engine.tree.getNode(j);if(!t)throw Error(`Node ${j} doesn't exist`);if(!WE(t))throw Error(`Node ${j} must be exportable as SVG`);return zE({node:t,isDarkMode:this.engine.documentSettings.hasDarkAppearance,combinedVariableValueMap:t.cache.getUnsafeCombinedVariableValueMap()})}async prepareNodeSnapshot({nodeId:j,zoom:e=1,pixelRatio:t=1}){this.log.debug("preparing snapshot");let r=this.engine.tree,o=r.getNode(j);if(!o)throw Error(`Node ${j} doesn't exist`);let n=r.getRect(o),a=yR(r,o),i=Bm(r,o),s={...n,x:a.x-i.x,y:a.y-i.y};t!==1&&(e*=t),this.log.debug("rendering");let c=this.engine.stores.scopeStore.active;return await this.renderer.renderUpdates(()=>{let{treeStore:d,toolStore:p,scopeStore:k,modulesStore:$,documentSettingsStore:g,propertiesPanelStore:G,overlayStore:I,selectionStore:S,effectStore:T}=this.engine.stores;this.renderState.renderScope=d.treeIndex.getScopeIdFor(o.id),this.renderState.renderNodes={[o.id]:s},this.renderState.transform=[0,0,e],this.renderState.isDarkMode=g.hasDarkAppearance,this.renderState.editor={selection:S.ids,nodeInTextEditor:p.nodeInTextEditor,nodesInEffectPreview:T.nodesInEffectPreview,nodesInMoveToolRootFontSize:this.engine.getNodesInMoveToolRootFontSize(),activeEffect:T.activeEffect,activeEffectIds:T.activeEffectIds,activeOverlayNodes:I.activeOverlays,dragAndDropPlaceholders:p.dragAndDropPlaceholders,rootFontSize:Z7(c,d.tree,$)??null,scopeIdToSelectedCollectionItem:k.scopeIdToSelectedCollectionItem,shouldSetMinHeight:!1,activeLinkStyle:G.activeLinkStyle}}),w.multiply(w.atOrigin(i),e)}};function yR(A,j){if(A.isGroundNode(j))return A.getRect(j);let e=A.getGroundNodeFor(j);return A.getCanvasBoundingRectCached(e)}function cf(){TA({type:"add",variant:"warning",text:"This file format is currently unsupported",key:"image-export-unsupported",icon:"warning",duration:2e3})}function df(){TA({type:"add",variant:"error",text:"Please update to the latest version",key:"image-export-not-available",icon:"error",duration:2e3})}async function pf(A,j){A=A.filter(i=>{for(let s of i.exportOptions)if(s.enabled)return!0;return!1});let e=A.length,t=A[0];E(t,"Node must be defined");let r=Va(t),o=new Set;for(let i of A)for(let s of i.exportOptions)s.enabled&&o.add(s.type);let n=Array.from(o).join(", "),a={key:"export-nodes-progress",progress:{variant:"progress",text:e===1?`${r} is exporting as ${n}`:`${e} layers are exporting as ${n}`},success:{variant:"success",text:e===1?`${r} has been exported`:`${e} layers have been exported`},error:{variant:"error",text:e===1?`Unable to export ${r}`:"Unable to export layers"}};await cm(a,j)}var CR=mA("export"),Ul=Rk?"\\":"/",Wl=new Set;Wl.add("html");Wl.add("webp");var ko=class ko extends Ya{constructor(e){super(new Fn(KE.canvas,$i.export,{width:100,height:100,offscreen:!Jj.isOn("sandboxExportDebugging")}),e);R(this,"exportMetrics",new Gn)}static async whenAvailable({toastIfNot:e}={toastIfNot:!1},t){let r=await Fn.isAvailable();if(this.isAvailable&&r)return this.shared=this.shared??new ko(t),this.shared;e&&(Gn.trackError("ServiceChannel miss-match error. Unable to establish a connection."),df())}static async exportNodes(e,t){let r=await ko.whenAvailable({toastIfNot:!0},t);if(E(r,"Expected image exporter to be available"),r.hasUnsupportedFiles(e))return cf();let a=(await r.openSaveDialog(e))?.filePath;a&&await pf(e,async()=>{await r.exportNodes(e,a)})}hasUnsupportedFiles(e){for(let t of e)for(let r of t.exportOptions)if(Wl.has(r.type)&&r.enabled)return!0;return!1}async exportNodes(e,t){let r=[],o=this.getCount(e);for(let i of e)for(let s of i.exportOptions){if(!s.enabled)continue;let c=s.type,d=this.createNamePath(i,s),p=i.id,k=s.scale,$=o===1?this.verifyNamePath(d,t):d;switch(c){case"png":r.push({nodeId:p,pixelRatio:k,type:"image/png",pathname:$,count:o,dialogFilePath:t,p3:this.engine.stores.persistedUserDefaults.p3});break;case"jpg":r.push({nodeId:p,pixelRatio:k,type:"image/jpeg",pathname:$,count:o,dialogFilePath:t,p3:this.engine.stores.persistedUserDefaults.p3});break;case"svg":r.push({nodeId:p,pixelRatio:k,type:"image/svg+xml",pathname:$,count:o,dialogFilePath:t,p3:this.engine.stores.persistedUserDefaults.p3});break;default:cA(c)}}let n;for(let i of r){let s=performance.now();CR.debug("snapshotting export",i);try{await this.writeToDisk(i),this.exportMetrics.add(i,{durationMs:Math.floor(performance.now()-s),errorReason:null,format:i.type,exportCount:o,success:!0,scope:"selection"})}catch(c){this.exportMetrics.add(i,{durationMs:Math.floor(performance.now()-s),errorReason:"Exporting snapshoting failed",format:i.type,exportCount:o,success:!1,scope:"selection"}),n=c}}let{metrics:a}=await this.renderer.sandbox.collectMetrics();if(this.exportMetrics.mergeElectronMetrics(a),this.exportMetrics.track(),n)throw n}createNamePath(e,t){let r=qE(Va(e))||"export",o=t.nameExtension.lastIndexOf("/"),n=o>=0?t.nameExtension.slice(0,o+1):"",a=t.nameExtension.slice(o+1),i=t.type;return n+r+a+"."+i}getCount(e){let t=0;for(let r of e)for(let o of r.exportOptions)o.enabled&&t++;return t}async openSaveDialog(e){for(let t of e)for(let r of t.exportOptions)if(r.enabled)return this.renderer.sandbox.openSaveDialog({count:this.getCount(e),pathname:this.createNamePath(t,r)})}verifyNamePath(e,t){let r=e.split("/"),o=r[r.length-1];E(M(o),`Filename must be defined: ${r}`);let n=t.split(Ul),a=n[n.length-1];if(E(M(a),`Filename must be defined: ${n}`),o.toLowerCase()!==a.toLowerCase()){let s=r.slice(0,-1).join(Ul);return s?s+Ul+a:a}return e}async writeToDisk(e){let t=await this.prepareNodeSnapshot(e);if(this.exportMetrics.add(e,{nodeWidth:t.width,nodeHeight:t.height}),e.type==="image/svg+xml"){let r=this.renderToSVG(e);return this.renderer.sandbox.writeToDisk({...e,rect:t,svgString:r})}return this.renderer.sandbox.writeToDisk({...e,rect:t})}async writeToClipboard(e){let t=await this.prepareNodeSnapshot(e);if(this.exportMetrics.add(e,{nodeWidth:t.width,nodeHeight:t.height}),e.type==="image/svg+xml"){let r=this.renderToSVG({nodeId:e.nodeId});return this.renderer.sandbox.writeToClipboard({...e,rect:t,svgString:r})}return this.renderer.sandbox.writeToClipboard({...e,rect:t})}async getImageData(e){let t=await this.prepareNodeSnapshot(e);return e.type==="image/svg+xml"?this.renderToSVG({nodeId:e.nodeId}):this.renderer.sandbox.getImageData({...e,rect:t})}};R(ko,"isAvailable",Ik),R(ko,"shared");var yn=ko;var Za=Fj(eh());function zl(A){let j=Tj.boundingBox(A),e=A.pathSegments.map(t=>t.merge({x:t.x-j.x,y:t.y-j.y}));return[{pathClosed:A.pathClosed,pathSegments:e},j]}function kf(A,j,e,t){let r=mA("app:importSVG"),o=A,n,a;if(t&&t.colorable){let g=Ut(A,"image/svg+xml").documentElement;if(!g)throw new Error(`Unsupported SVG: ${A}}`);let G=g.getAttribute("fill"),I=!(G&&G.toLowerCase()==="none");if(I){if(t.fillType==="linear-gradient"&&t.fillLinearGradient instanceof ak)n={fillType:"linear-gradient",fillLinearGradient:t.fillLinearGradient};else if(t.fillType==="image"&&t.fillImage)n={fillType:"image",fillImage:t.fillImage,fillImageResize:t.fillImageResize,fillImagePixelWidth:t.fillImagePixelWidth,fillImagePixelHeight:t.fillImagePixelHeight};else if(t.fillType==="color"&&M(t.fillColor)){let S=(0,Za.getPaperLazily)(),v=new S.Color(t.fillColor).toCSS(!1);I&&g.setAttribute("style",`fill: ${v}; color: ${v}`);let P=g.getAttribute("stroke");P&&P.toLowerCase()==="currentcolor"&&g.setAttribute("stroke",v)}o=g}}let i=TR(o);o=i.svgElement,a=i.svgSize;let s=!1,d=(0,Za.getPaperLazily)().project.importSVG(o,{expandShapes:!0,insert:!1,size:e,onError:$=>{r.reportError($),s=!0;let g=document&&document.getElementsByTagName("body");if(g&&g[0]){let G=g[0].lastElementChild;for(;G&&G.tagName==="svg";)G.remove(),G=g[0].lastElementChild}}});if(s)return null;let p;try{p=uf({item:d,fillOverrides:n,tree:j()})}catch($){return r.reportError($),null}let k=p[0];return k?(WA(k)&&a&&k.set({width:a.width,height:a.height}),j().insertNodes(p).getNode(k.id)):null}function uf({item:A,tree:j,nodes:e=[],parent:t=null,parentAbsolutePosition:r=sA(0,0),fillOverrides:o}){let n=(0,Za.getPaperLazily)();return A instanceof n.Group?_R({group:A,nodes:e,parent:t,parentAbsolutePosition:r,tree:j,fillOverrides:o}):A instanceof n.PathItem?MR({item:A,nodes:e,parent:t,parentAbsolutePosition:r,fillOverrides:o}):(console.warn("Unhandled Paper item:",A),e)}function TR(A){let j=M(A)?Ut(A,"image/svg+xml").documentElement:A;if(!j)throw new Error(`Unsupported SVG: ${A}}`);let e,t=j.getAttribute("viewBox"),r=j.getAttribute("width"),o=j.getAttribute("height");if(t){let[n,a,i,s]=t.split(" ");i&&s&&(j.setAttribute("width",i),j.setAttribute("height",s),e={width:parseInt(i),height:parseInt(s)})}else r&&o&&(e={width:parseInt(r),height:parseInt(o)});return mf(j),{svgElement:j,svgSize:e}}function mf(A){PR(A);for(let j of A.children)mf(j)}function PR(A){let j=A.getAttribute("rx"),e=A.getAttribute("ry");!j&&!e||j&&e||(j?A.setAttribute("ry",j):e&&A.setAttribute("rx",e))}function MR({item:A,nodes:j=[],parent:e=null,parentAbsolutePosition:t=sA(0,0),fillOverrides:r}){let o=lk({item:A,parentAbsolutePosition:t}),n=ck(A),a=e?e.id:pj;if(o.length===1){let s=o[0];E(s,"Path must be defined");let[{pathSegments:c,pathClosed:d},p]=zl(s),k=new cn({parentid:a,pathSegments:c,pathClosed:d,...n,...r,...p});j.push(k)}else if(o.length){let s=Ef(A),c=s.x-t.x,d=s.y-t.y,p=A.fillRule==="evenodd"?3:4,k=new fa({parentid:a,pathBoolean:p,...n,...r,x:c,y:d,width:s.width,height:s.height});j.push(k),o.forEach($=>{let[{pathSegments:g,pathClosed:G},I]=zl($),S=new cn({parentid:k.id,pathSegments:g,pathClosed:G,...r,x:I.x-c,y:I.y-d,width:I.width,height:I.height});j.push(S)})}return j}function _R({group:A,tree:j,nodes:e=[],parent:t=null,parentAbsolutePosition:r=sA(0,0),fillOverrides:o}){let n=Ef(A),a=t?t.id:pj,i,s;return a?(i=new jm({parentid:a,x:n.x-r.x,y:n.y-r.y,width:n.width,height:n.height}),s=sA(n.x,n.y)):(i=new ur({parentid:a,left:0,top:0,width:n.x+n.width,height:n.y+n.height,fillEnabled:!1}),s=sA(0,0)),e.push(i),A.children.forEach(c=>{uf({item:c,nodes:e,parent:i,parentAbsolutePosition:s,tree:j,fillOverrides:o})}),e}function Ef(A){let{x:j,y:e,width:t,height:r}=A.bounds;return{x:j,y:e,width:t,height:r}}function DR(A){return _j(A)&&"iconURL"in A}function i1(A){return _j(A.icon)?A.id==="WorkspacePluginsCategory"?!0:DR(A.icon):!1}var NR={DefaultCategory:!0,PluginsCategory:!0,ManagedCollectionPluginsCategory:!0,WorkspacePluginsCategory:!0};function a1(A){return M(A)?Object.hasOwn(NR,A):!1}var xR={FindNodesCategory:!0,PluginsCategory:!0,ManagedCollectionPluginsCategory:!0,WorkspacePluginsCategory:!0};function s1(A){return Object.hasOwn(xR,A)}function l1(A){return A?.kind==="item"}function ff(A){if(A!==void 0)switch(A){case 2:return"auto";case 0:return"fixed";case 3:return"fraction";case 1:return"percentage";case 4:return"viewport";default:cA(A)}}function $f(A,{widthType:j,heightType:e},t){if(!$A(A))return;let r=j!==void 0&&A.widthType!==j,o=e!==void 0&&A.heightType!==e;!r&&!o||Jm({widthType:ff(j),heightType:ff(e),source:t,nodeType:A.__class,componentId:z(A)?A.codeComponentIdentifier:void 0})}function uo(A,j,e=!1){let t={};for(let r in A){let o={...A[r]};"itemsOrder"in o&&Array.isArray(o.itemsOrder)&&e&&(o.itemsOrder=En(o.itemsOrder,j)),t[j.get(r)??r]=o}return t}var As=class extends Map{get(j){let e=super.get(j);for(;e;){let t=super.get(e);if(t===void 0)break;e=t}return e}};function OR(A,j){if(sa(A)){if(!A.controls.target?.value)return;let e=j.get(A.controls.target.value);return e?{target:{...A.controls.target,value:e}}:void 0}if(ve(A)){if(!A.controls.variantId?.value)return;let e=j.get(A.controls.variantId.value);return e?{variantId:{...A.controls.variantId,value:e}}:void 0}if(d6(A)){if(!A.controls.overlay?.value)return;let e=j.get(A.controls.overlay.value);return e?{overlay:{...A.controls.overlay,value:e}}:void 0}}function Bf(A,j,e,t){let r=z(j),o={},n=!1,a=la(j);for(let i in a){let s=r?VA(i):i;if(!de(A,j,s))continue;let c=a[i];if(!Aj(c))continue;let d=[],p=!1;for(let k of c){if(t&&(d6(k)||Ki(k))){p=!0;continue}let g=OR(k,e);if(!g){d.push(k);continue}d.push({...k,controls:{...k.controls,...g}}),p=!0}p&&(r?o[VA(i)]={type:"eventhandler",value:d}:o[i]=d,n=!0)}n&&j.set(o,A)}function wR(A,j,e){let t={};function r(a){let i=A.get(a);i&&A.linkNodeChangesTo(i,j.id)}let o=nm(j,V);for(let a of o){if(!de(A,j,VA(a)))continue;let i=j.getRawControlProp(a);if(i){if(i.type==="slot"&&Aj(i.value)){let s=!1,c=i.value.map(d=>{if(!_j(d))return d;let p="reference";if(!M(d[p]))return d;let k=e.get(d.reference);return k?(s=!0,r(k),{...d,[p]:k}):d});if(!s)continue;t[a]={type:"slot",value:c}}else if((i.type===null||i.type==="componentinstance")&&M(i.value)){let s=e.get(i.value);if(!s)continue;t[a]={type:"slot",value:[{id:"first-item",reference:s}]},r(s)}else if(Aj(i.value)){let s=!1,c=[];for(let d=0;d<i.value.length;d++){let p=i.value[d];if(!Ni(p)||p.type!==null&&p.type!=="componentinstance"||!M(p.value))continue;let k=Sp(p)?p.id:kj(),$=e.get(p.value);c.push({id:k,reference:$??p.value}),$&&(r($),s=!0)}if(!s)continue;t[a]={type:"slot",value:c}}}}if(me(t))return;let n=Lr(t);j.set(n,A)}function LR(A,j,e){let t={},r=V.componentForIdentifier(j.codeComponentIdentifier)?.properties;for(let o in r){if(!de(A,j,VA(o)))continue;let n=r[o];if(n?.type!=="scrollsectionref")continue;let a=j.getRawControlProp(o);if(!a)continue;let i=Op(n,a);if(!i||pA(i)||!M(i.target))continue;let s=e.get(i.target);s&&(t[o]={type:"scrollsectionref",value:{...i,target:s}})}me(t)||j.set(Lr(t),A)}function qR(A,j){if(iu(A)&&Aj(A.appearEffectScrollTargets)){let e=A.appearEffectScrollTargets.map(t=>{if(!t.target||pA(t.target))return t;let r=j.get(t.target);return r?{id:kj(),variant:t.variant,target:r}:t});A.set({appearEffectScrollTargets:e})}if(ou(A)&&M(A.styleAppearEffectScrollTarget)){let e=j.get(A.styleAppearEffectScrollTarget);e&&A.set({styleAppearEffectScrollTarget:e})}if(nu(A)&&Aj(A.styleTransformEffectScrollTargets)){let e=A.styleTransformEffectScrollTargets.map(t=>{if(!t.target||pA(t.target))return t;let r=j.get(t.target);return r?{id:kj(),style:t.style,target:r}:t});A.set({styleTransformEffectScrollTargets:e})}if(eu(A)&&A.dragEffectConstraintElement){let e=j.get(A.dragEffectConstraintElement);e&&A.set({dragEffectConstraintElement:e})}if(au(A)&&M(A.textEffectScrollTarget)){let e=j.get(A.textEffectScrollTarget);e&&A.set({textEffectScrollTarget:e})}}function tt(A,j,e,t){if(j=j.draftOrCurrent(),(Ie(j)||cp(j))&&Bf(A,j,e,t),z(j)&&(Bf(A,j,e,t),wR(A,j,e),LR(A,j,e)),ln(j)&&qR(j,e),Jr(j)&&j.formSubmitButtonId){let o=e.get(j.formSubmitButtonId);o&&j.set({formSubmitButtonId:o})}if(hu(j)&&j.dataSourceLoaderId){let o=e.get(j.dataSourceLoaderId);o&&j.set({dataSourceLoaderId:o})}if(yi(j)&&j.collectionRepeatedItemId){let o=e.get(j.collectionRepeatedItemId);o&&j.set({collectionRepeatedItemId:o})}if(Dj(j)){let o=gf(j.dataIdentifier,e);o&&j.set({dataIdentifier:o})}if(ej(j)){let o=j.variables.map(n=>{if(!zi(n))return n;let a=gf(n.dataIdentifier,e);return a?{...n,dataIdentifier:a}:n});Ht(j.variables,o)||j.set({variables:o})}le(j)&&KR(j,e);let r=Cu(A,j,o=>{if(!o.providerId)return;let n=e.get(o.providerId);if(n)return Lj(o.id,n)});if(r&&j.set(r),j.children)for(let o of j.children)tt(A,o,e,t);return j}function gf(A,j){let e=jA(A);if(!KA(e))return null;let t=j.get(e.localIdName);return t?Kt(e.type,t,e.exportSpecifier).value:null}function KR(A,j){let e=A.getControlProps();for(let[t,r]of Object.entries(e)){if(r?.type==="collectionreference"&&M(r.value)){let o=j.get(r.value);o&&A.setControlProp(t,{...r,value:o})}if(r?.type==="multicollectionreference"&&!oA(r.value)&&!pA(r.value)){let o=r.value.map(n=>j.get(n)??n);Ht(r.value,o)||A.setControlProp(t,{...r,value:o})}}}function mo(A){return A==="/"?"Home":(A=JR(A),A=VR(A),A=Rf(A),A=HR(A),A=A.split(" ").map(l7).join(" "),A)}function VR(A){return A.replace(/-+/gu," ")}function JR(A){return A.replace(Ri,"")}var hf=/\s*\/+[/\s]*/gu;function HR(A){return A.replace(hf," / ")}function Rf(A){return A.replace(/^[/\s]+|[/\s]+$/gu,"")}var QR=/\s+/gu,UR=/-+/gu;function ew(A){if(A==="Home")return"/";let j=A;return j=Rf(j),j=j.replace(hf,"-"),j=j.replace(QR,"-"),j=j.replace(UR,"-"),j=j.toLowerCase(),"/"+j}function gw(A,j){let e=j.instanceIdentifier,t=A.getPersistedModuleByLocalIdentifier(e),r=V.dataForIdentifier(e)??void 0;return{identifier:e,module:t,entity:r}}function hw(A){let j=A.variables.find($6);if(j)return j.id}function Rw(A){return A.annotations?.framerSlug}function Iw(A,j="Collection"){return A.name?A.name.toLowerCase().includes("collection")?A.name:`${A.name.trim()} Collection`:j}function WR(A){switch(A.toLowerCase()){case"title":case"name":case"label":return!0;default:return!1}}function zR(A){return Mp(A)&&WR(A.name)}function XR(A){return A.variables.find(zR)}function YR(A,j){if(oA(j))return;let t=A.getControlProp(j.id)?.value||j.initialValue;if(M(t)&&t.length>0)return t}function ZR(A){return A.variables.find($6)}function AI(A,j){if(oA(j))return;let t=A.getControlProp(j.id)?.value||j.initialValue;if(M(t)&&t.length>0)return t}function Fw(A,j){let e=XR(A),t=YR(j,e);if(M(t))return t;let r=ZR(A),o=AI(j,r);return M(o)?mo(o):"Collection Item"}function Xl(A){let{ids:j}=A.selection,e=j[0];if(!e)return null;let t=A.tree.getNode(e);if(ej(t))return t;if(le(t)){let r=A.tree.getNode(t.parentid);if(ej(r))return r}return null}function Gw(A){let j=Xl(A);return j?j.id:null}function Sw(A){let j=Xl(A);return j?j.name:null}function yw(A){let j=A.getContentManagementNode()?.loaded;return j?j.children.length:0}function bw(A,j,e){let t=ye(A,j);return!t||!e?!1:Kk(t).every(o=>{if(!o)return!1;for(let n of e)if(n.endsWith(o))return!0;return!1})}function Yl(A){return A.type==="richtext"&&M(A.value)}function jI(A,j){let e=jA(A);return t=>{let r=jA(t);if(!(!r||!e)&&(r.kind==="localModuleExport"&&e.kind==="localModuleExport"&&r.localId===e.localId||r.kind==="externalModuleExport"&&e.kind==="externalModuleExport"&&r.moduleId===e.moduleId&&r.exportSpecifier===e.exportSpecifier))return j}}function Zl(A,j){let e=A.getControlProps(),t={};for(let[r,o]of Object.entries(e)){if(!Yl(o))continue;let n=o.value.replaceAll(c6,(a,i)=>{let s=j(i);return s?`${rp}="${s}"`:a});o.value!==n&&(t[VA(r)]={...o,value:n})}return Object.keys(t).length>0?t:void 0}function If(A,j,e){let t=A.getContentManagementNode()?.loaded;if(!t)return;let r=jI(j,e);for(let o of t.children)for(let n of o.getUnsortedChildren()){let a=Zl(n,r);a&&n.set(a)}}function eI(A,j){let e=A.getControlProps();for(let t of Object.values(e))if(Yl(t)&&t.value.includes(j))return!0;return!1}function Cw(A,j){let e=A.getContentManagementNode()?.loaded;if(!e)return!1;for(let t of e.children)for(let r of t.getUnsortedChildren())if(eI(r,j))return!0;return!1}function vw(A){let j=new Set;for(let e of A.getUnsortedChildren()){let t=Ac(e);for(let r of t)j.add(r)}return[...j]}function Ac(A){let j=new Set,e=A.getControlProps();for(let t of Object.values(e)){if(!Yl(t))continue;let r=t.value.matchAll(c6);for(let[,o]of r)aj(o)&&j.add(o)}return[...j]}function Tw(A,j,e){let t=lr(A.tree,j);if(!t)return;let r=e??t.getUnsortedChildren()[0];A.stores.scopeStore.select(rr,{keepHistory:!1}),A.selection.set(r??t)}function Pw(A){let j=Xl(A);if(!j)return!1;let e=A.contentManagementStore;return e.multiSelectedItems||e.isCreatingNewItem()?!1:!j.managedByPlugin}function Ff(A,j){let e=A.stores.scopeStore.active;return E(Nr(e),"Content management node should be active"),e.children.toSorted(({name:t},{name:r})=>Uk(t||"",r||"",j))}function Mw(A,j){let e=A.stores.scopeStore.active;Ff(A,j).forEach(({id:r},o)=>{A.moveNode(r,e.id,o)})}function _w(A,j){let e=A.stores.scopeStore.active;E(Nr(e),"Content management node should be active");let t=Ff(A,j);return e.children.every(({id:r},o)=>t[o]?.id===r)}function js(A){if(!A)return!1;let j=jA(A);return j?j.kind==="externalModuleExport"||j.kind==="localModuleExport":!1}function es(A,j){z(A)&&js(A.codeComponentIdentifier)&&j(A.codeComponentIdentifier),j6(A)&&A.dataIdentifier&&j(A.dataIdentifier),Vr(A)&&js(A.codeOverrideIdentifier)&&j(A.codeOverrideIdentifier),X6(A)&&A.codeOverrides?.forEach(e=>{j(e.identifier)}),le(A)&&Ac(A).forEach(j)}function ts(A,j){let e={};if(z(A)&&js(A.codeComponentIdentifier)){let r=j(A.codeComponentIdentifier);r&&(e.codeComponentIdentifier=r)}if(j6(A)&&A.dataIdentifier){let r=j(A.dataIdentifier);r&&(E(aj(r)),e.dataIdentifier=r)}if(Vr(A)&&js(A.codeOverrideIdentifier)){let r=j(A.codeOverrideIdentifier);r&&(e.codeOverrideIdentifier=r)}if(X6(A)&&A.codeOverrides){let r=!1,o=A.codeOverrides.map(n=>{let a=j(n.identifier);return a?(r=!0,{...n,identifier:a}):n});r&&(e.codeOverrides=o)}if(le(A)){let r=Zl(A,j);r&&Object.assign(e,r)}if(Object.keys(e).length!==0)return e}function Gf(A){return _a(A)||ej(A)}async function Sf(A,j,e){return(await Ba.post(`/web/projects/${e}/assets/duplicate-module`,{moduleId:A,saveId:j})).assets}var yf=75,tI={mutable:!0,update:0};function Cn(A,j,e,t,r=!1){function o(n,a,i=!1){let s=new n.constructor;s.assign(n,tI,{cache:s.cache,id:s.id}),Gp(s)&&(s.itemsOrder=void 0),n.cache.insideVariant=i;let c=Ar(n)?n.getChildrenInVisualOrder():n.children;c&&(s.children=c.map(k=>o(k,s.id,i)));let d={parentid:a},p=ts(n,k=>{let $=jA(k);if($.kind==="localModuleExport"){let g=j.get($.localId);if(g)return`${g}:${$.exportSpecifier}`}else if($?.kind==="externalModuleExport"){let g=e.get($.moduleId);if(g)return Tr($,g).value}});if(p&&Object.assign(d,p),QA(n)&&!CA(n)&&Object.assign(d,{replicaInfo:void 0,originalid:void 0,...n.replicaInfo.overrides[n.replicaInfo.master],_deleted:void 0}),r&&Object.assign(d,{duplicatedFrom:Li(n.duplicatedFrom,n.id)}),s.assign(d),t){if(t.has(n.id)){let k=t.get(n.id);k&&t.set(k,s.id)}t.set(n.id,s.id),n.originalid&&!t.has(n.originalid)&&t.set(n.originalid,s.id)}return s}return o(A,void 0,CA(A))}function rI(A){let j=new Map;for(let e of A)if(e.type==="local"){let t=e.moduleId;j.set(e.localId,Yj(t,e.saveId,e.file).value)}return j}async function bf(A){let j=new Map;for await(let e of A)if(e.type==="local"&&e.moduleType==="css"){let t=await vf({moduleId:e.moduleId,saveId:e.saveId}),{__treeSerializationVersion:r,...o}=t,n=r||yf,{root:a}=I6({root:o,version:n}),i=il(a);ct(i)&&j.set(i.id,i)}return[...j.values()]}function Cf(A,j,e){let t=rI(e.imports),r=new Map,o=[];for(let n of A.walk())es(n,a=>{let i=jA(a);if(KA(i)){let s=t.get(i.localId);if(!s)return;let{moduleId:c,saveId:d,file:p}=jA(s);i=Td(i,c,d,p)}if(i.kind==="externalModuleExport"){let s=j.getPersistedModuleByGlobalId(i.moduleId);s?r.set(i.moduleId,s.localId):o.push(i)}});return{identifiers:o,localIdsToExternalIdentifiers:t,externalModuleIdsToLocalIds:r}}async function vf({moduleId:A,saveId:j}){try{return await(await fetch(`${Ee().modulesCDN}/${A}/${j}/tree.json`)).json()}catch(e){yA(e)}}async function Tf(A,j){let[e,t]=await Promise.all([vf(j),A.stores.modulesStore.getModuleDependencies(j)]);E(e,"Can't get tree.json for module identifier"),E(t,"Can't get dependencies for module identifier");let{__treeSerializationVersion:r,...o}=e,n=r||yf,{root:a}=I6({root:o,version:n}),i=il(a);return E(Gf(i),"Node should be un-linkable."),{node:i,dependencies:t}}async function Pf(A,j,e){let t=A.remoteDocument?.projectId;if(t&&j.assets.length>0)try{let r=await Sf(e.moduleId,e.saveId,t);A.stores.assetStore.assetService?.addAssets(r)}catch{}}function tc(A){if(!vA(A)||SA(A))return 0;let j=0,e=A.children.length;return j+=e,A.children.forEach(t=>{j+=tc(t)}),j}function Mf(A,j,e,t){let r=xa(e,V),o=new Map(Object.entries(r)),n=new Map;n.set(t,o);let a={};for(let i of A.walk()){let s=ua(j,t,i,n);s&&(a[i.originalid??i.id]=s)}return a}function _f(A){let{left:j,top:e,right:t,bottom:r,centerAnchorX:o,centerAnchorY:n,constraintsLocked:a,width:i,widthType:s,height:c,heightType:d,aspectRatio:p,name:k,...$}=A;return $}function Df(A){let j=V.reactComponentForIdentifier(A.codeComponentIdentifier);if(!j)return;let e={},t=Object.keys(j.properties);for(let r of t){let o=j.properties[r];if(!o||o.type!=="eventhandler")continue;let n=A.getRawControlProp(r);if(!n)continue;let{value:a}=n;!Array.isArray(a)||a.length===0||(e[r]=a)}return e}function rs(A,{opacity:j,rotation:e}){if(pA(j))A.opacity=j;else if(A?.opacity||j){let t=Z(j)?j:1;A.opacity=(A.opacity??1)*t}if(pA(e))A.rotation=e;else if(A?.rotation||e){let t=Z(e)?e:0;A.rotation=(A.rotation??0)+t}}function b4(A){return A.every(j=>fA(j)||bj(j)||z(j))}function C4(A,j){return j?!1:A.every(e=>{if(!fA(e)&&!z(e)&&!qA(e)||GA(e)||fA(e)&&zr(e).length===0)return!1;if(z(e)){let t=e.getSupportedLayout(V);if(!Ne(t.width)||!Ne(t.height))return!1}return e.widthType!==2||e.heightType!==2})}function Nf(A,j,e){for(let t of j)if(bj(t)||z(t))t.set({widthType:2,heightType:2}),bj(t)&&e&&BA("layout_fit_text",{source:e});else if(fA(t)){let r={widthType:2,heightType:2,aspectRatio:null};ae(t)||qa(A,t,r),wl(A.tree,"width",t),wl(A.tree,"height",t),Bu(t)&&(r.framePreset=null),t.set(r),e&&BA("layout_stack",{layoutType:"stack",source:e})}}function os(A,j){return hi(j)&&(mA("app").warn("Inserting a symbol is no longer supported."),j.isMaster=!1,j.replicaInfo=null,j.originalid=null),E(!A.tree.has(j.id),"Tree should not contain node with same id as inserted template"),A.stores.scopeStore.insertNode(j),j}function wf(A){let j={width:200,height:200,codeComponentIdentifier:A.identifier,intrinsicWidth:null,intrinsicHeight:null,slotsAreChildNodes:zA.isOn("componentSlotsAreChildNodes")},{defaultProps:e,annotations:t}=A;if(e!==void 0&&(zs(e.width)&&(j.width=e.width,j.intrinsicWidth=e.width),zs(e.height)&&(j.height=e.height,j.intrinsicHeight=e.height)),t){let r=Bk(t);r.width&&(j.width=r.width),r.height&&(j.height=r.height)}return new pr(j)}function J4(A){return A.sort(oI)}var xf=new Map;function Of(A){let j=xf.get(A);if(j)return j;let e=A.split("/").map(t=>t.trim()).join("");return xf.set(A,e),e}function oI(A,j){if(A.name===null)return-1;if(j.name===null)return 1;let e=Of(A.name),t=Of(j.name);return e.localeCompare(t,void 0,{numeric:!0})}function H4(A){if(Ld(A)&&A.file==="./canvas.tsx"||A.identifier==="framer/Stack")return!1;let j=jA(A.identifier);return KA(j)&&j.type==="screen"?!1:A.type==="component"||A.type==="master"}function Q4(A){let j=A.split("/"),e=j[j.length-1];return E(Zj(e),"Last section is required"),e.trim()}function U4(A,j){return A.name?A.name:j?At(j):"Unknown"}function W4(A){let j=[];for(let e of V.getAllLocalModules())e.type==="component"&&e.file===A&&j.push(e);return j}function ns(A,{allowVariants:j,allowLockedNodes:e}={}){return!e&&yt(A)||vj(A)||!j&&(CA(A)||ij(A))||dE(A)||Qt(A)||SA(A)||C7(A)?!1:$A(A)}async function Lf(A,j,e,t){function r(){sI(A,[j],e,t)}if(!z(e)){r();return}let o=jA(e.codeComponentIdentifier);if(!o||o.kind!=="externalModuleExport"){r();return}await A.stores.modulesStore.addExternalModulesToProject([o],{onTreeUpdate:r})}function nI(A,j,e){if(!Xo(j))return;let t=Zp(A.tree,j);if(!rA(t))return;E(t.isLoaded(),"smart component must be loaded"),e.set({formSubmitButtonId:j.id});let r=t.getPrimaryVariant();t.getReplicaVariants().forEach(o=>{uA.resetOverridesByProperty(A.tree,o,o,["htmlTag","link"])}),tu(r)&&r.set({htmlTag:"button",link:void 0})}function iI(A,j,e){if(!z(A)||!z(j)||!A.cache.formContainerAncestorId)return;let t=e.tree.get(A.cache.formContainerAncestorId);Jr(t)&&nI(e,j,t)}function aI(A,j,e){let t=Au(e.tree,A);t&&ju(A,t)&&t.set({dataSourceLoaderId:j.id})}function sI(A,j,e,t){let r={},o=new Set;j.forEach(n=>{let a=null;if(jj(n)){if(!je(n))return;let $=Ce(A.tree,n),g=uA.getReplicaForTemplateNode(A.tree,n);if(!$||!g||!CA(g))return;n=$,a=g}let i=os(A,e);iI(n,i,A),aI(n,i,A);let s=A.tree.getNodeParent(n),c=s||A.tree.getScopeNodeFor(n)||A.stores.scopeStore.active,d=c.children.indexOf(n),p=La(A.tree,n,i,c);if(i.set(p),s&&$j(n)&&ft(i)){i.set($t(n));let $=new As([[n.id,i.id]]);tt(A.tree,s,$,Kj(s)||Qi(s)),o.add(i.id)}if(z(i)&&cI(n,i,new Set(Object.keys(p))),QA(n)&&!CA(n)&&z(i)&&lI(A,n,i),dI(A,c,n,i),vA(n))for(let $ of n.children)Kj($)&&A.moveNode($.id,i.id);A.deleteNode(n.id),A.moveNode(i.id,c.id,d);let k=pI(A.tree,n,i);$A(i)&&k&&(t?A.tree.current(i)?.set({left:k.left,right:k.right,top:k.top,bottom:k.bottom,centerAnchorX:k.centerAnchorX,centerAnchorY:k.centerAnchorY}):A.tree.current(i)?.set(k)),a?r[n.id]=ee(a.id,i.id):r[n.id]=i.id});for(let n of A.selection.ids)o.add(r[n]??n);A.selection.set(Array.from(o))}function lI(A,j,e){if(CA(j))return;let t=e.getLocalSmartComponentNodeId();if(!t)return;let r=A.tree.getNode(t);if(!(!r||!rA(r))&&r.originalSymbolId===j.replicaInfo.master){for(let o of j.walk())if(!(!gu(o)||!o.isTarget)&&o.originalid){if(fA(o)&&o.fillType==="image"&&M(o.fillImage)){let n=e.getRawControlProp(`symbol_${o.originalid}`);n&&n.type==="image"&&(n.value=o.fillImage)}else if(Qt(o)){let n=e.getRawControlProp(`symbol_${o.originalid}`);n&&n.type==="string"&&(n.value=o.styledText.text)}}}}function cI(A,j,e){let t;A:for(let o of A.walk()){if(!Ie(o)&&!z(o))continue;let n=da(o);for(let[,a]of Object.entries(n))if(t===void 0)t=a;else if(t){t=null;break A}}if(!t)return;let r=V.componentForIdentifier(j.codeComponentIdentifier);if(r?.properties)for(let o in r.properties){if(e?.has(o)||r.properties[o]?.type!=="eventhandler")continue;let a={type:"eventhandler",value:t};j.set({[VA(o)]:a});return}}function dI(A,j,e,t){let r=j?Do(j):null;if(!r||!nj(r))return;let o=A.tree.getSmartComponentNodeFor(r);if(o)for(let n of o.getReplicaVariants()){let a=n.replicaInfo;if(!(e.id in a.overrides))continue;let i={...a};i.overrides={...i.overrides};let s={},c=i.overrides[e.id];for(let d in c){let p=c[d];if(d==="_deleted"){if(!Aj(p))continue;let k=p.filter($=>$ in t);k.length&&(s._deleted=k)}else d in t&&(s[d]=p)}delete i.overrides[e.id],i.overrides[t.id]=s,A.tree.current(n)?.set({replicaInfo:i})}}function pI(A,j,e){if(!$A(j)||!$A(e))return;let t=j.constraintValues();if(Yt(j)&&Yt(e)&&(np(j)&&(t.gridItemFillCellWidth=!0),op(j)&&(t.gridItemFillCellHeight=!0)),!z(e))return t;if(hk(j)){let r=e.getSupportedLayout(V),o=A.getRect(j);j.widthType===2&&!Ne(r.width)&&(t.widthType=0,t.width=o.width),j.heightType===2&&!Ne(r.height)&&(t.heightType=0,t.height=o.height)}return t}function qf(A){return wd(A)?wf(A):null}var Kf=Fj(t6());function Vf(A){let j={};for(let e of A.walk()){let t={};oe(e)&&(t.strokeDashArray=e.strokeDashArray,t.strokeDashOffset=e.strokeDashOffset,UA(e.strokeWidth)||(t.strokeWidth=e.strokeWidth)),zt(e)&&(t.boxShadows=e.boxShadows),Gt(e)&&(t.radius=e.radius),ir(e)&&(t.radiusTopLeft=e.radiusTopLeft,t.radiusTopRight=e.radiusTopRight,t.radiusBottomRight=e.radiusBottomRight,t.radiusBottomLeft=e.radiusBottomLeft),wo(e)&&(t.pathSegments=e.pathSegments),Se(e)&&e.fillType==="image"&&e.fillImageResize==="tile"&&(t.fillImageTileSize=e.fillImageTileSize??1),j[e.id]=t}return(0,Kf.Map)(j)}function rc(A,j,e){j.forEach((t,r)=>{let o=A.getNode(r);if(!o)return;let n={};oe(o)&&(Z(t.strokeWidth)&&(n.strokeWidth=rj(t.strokeWidth*e,2)),M(t.strokeDashArray)&&(n.strokeDashArray=uI(t.strokeDashArray,e)),Z(t.strokeDashOffset)&&(n.strokeDashOffset=rj(t.strokeDashOffset*e,2))),H7(o)&&O7(t.boxShadows)&&(n.boxShadows=kI(t.boxShadows,e)),Gt(o)&&(Z(t.radius)&&(n.radius=rj(t.radius*e,2)),Z(t.radiusTopLeft)&&(n.radiusTopLeft=rj(t.radiusTopLeft*e,2)),Z(t.radiusTopRight)&&(n.radiusTopRight=rj(t.radiusTopRight*e,2)),Z(t.radiusBottomRight)&&(n.radiusBottomRight=rj(t.radiusBottomRight*e,2)),Z(t.radiusBottomLeft)&&(n.radiusBottomLeft=rj(t.radiusBottomLeft*e,2))),wo(o)&&t.pathSegments&&(n.pathSegments=o.pathSegments.map((a,i)=>{let c=t.pathSegments[i].radius*e;return a.merge({radius:c})})),Se(o)&&Z(t.fillImageTileSize)&&(n.fillImageTileSize=t.fillImageTileSize*e),o.set(n)})}function kI(A,j){if(!(!A||UA(A)))return A.map(e=>Di(e,{x:rj(e.x*j,2),y:rj(e.y*j,2),blur:rj(e.blur*j,2),spread:rj(e.spread*j,2)}))}function uI(A,j){let e=[],t=A.split(",");for(let r of t){let o=parseFloat(r);if(!Z(o))continue;let n=rj(o*j,2);e.push(n)}return e.join(", ")}var KL=(A,j)=>{if(A===j)return!0;if(A.length!==j.length)return!1;let e=new Set(A);for(let t of j)if(!e.has(t))return!1;return!0},VL=(A,j,e)=>{let t=[];for(let r of A)oc(j,r,e)!==-1&&t.push(r);return t},Jf=(A,j,e)=>{if(!e)return Array.from(new Set([...A,...j]));let t=[...A];for(let r of j)oc(t,r,e)===-1&&t.push(r);return t},JL=(A,j,e)=>A.filter(t=>oc(j,t,e)===-1);function oc(A,j,e){return e?A.findIndex(t=>e(t,j)):A.indexOf(j)}function mI(A,j){let e=[];for(let r of j.segmentSelection){let o=A.getNode(r.id);!o||r.index>=o.pathSegments.length||e.push(r)}let t=j.segmentHandle;if(t){let r=A.getNode(t.id);(!r||t.index>=r.pathSegments.length)&&(t=null)}return{...j,segmentSelection:e,segmentHandle:t}}var Hf=class{constructor(j){this.addChanges=j;R(this,"state",{segmentSelection:[],selectionType:0,segmentHandle:null,segmentHovered:null,closestCurve:null,pointRounding:.5,snapConstraint:null})}validateSegmentSelection(j){this.state=mI(j,this.state),this.addChanges("PathSelection")}setSegmentSelection(j,e){this.state={...this.state,segmentSelection:j,selectionType:e},this.addChanges("PathSelection")}toggleSegmentSelection(j,e){this.state.selectionType!==e&&(this.state={...this.state,segmentSelection:j,selectionType:e});let t=j.filter(o=>this.state.segmentSelection.find(n=>o.id===n.id&&o.index===n.index)===void 0),r=this.state.segmentSelection.filter(o=>j.find(n=>n.id===o.id&&n.index===o.index)===void 0);this.state={...this.state,segmentSelection:Jf(t,r)},this.addChanges("PathSelection")}setSegmentHandle(j){this.state={...this.state,segmentHandle:j},this.addChanges("PathSelection")}setHoveredSegment(j){this.state={...this.state,segmentHovered:j},this.addChanges("PathSelection")}setClosestCurve(j){this.state={...this.state,closestCurve:j},this.addChanges("PathSelection")}setPathPointRounding(j){this.state={...this.state,pointRounding:j},this.addChanges("PathSelection")}setPathConstraint(j){this.state={...this.state,snapConstraint:j},this.addChanges("PathSelection")}};var vn=Fj(t6());function Uf(A,j){return mn(A,"canDesign")||j.length===0?!1:j.find(e=>!(!no(e)&&It(e)&&!lt(e)&&!e.originalid))===void 0}function Rq(A,j,e,t){let r=j.map(o=>ic(A,o,e,t)[0]);A.selection.set(r)}function ic(A,j,e,t){let r=A.tree,o;ol.isBasicShape(j)?o=ol.createPath(j):o=j.calculatedPaths();let n=ek(j,o),a=Pn(r,j,o),i=r.newId(),s=Tj.boundingBox(n),c=Xf(j),d=su(j);if(c.fillType==="linear-gradient"&&c.fillLinearGradient){c.fillType="linear-gradient";let k=Z(j.rotation)?j.rotation:0;c.fillLinearGradient=c.fillLinearGradient.updated({angle:c.fillLinearGradient.angle+k})}if(n.length===1){let k=Tj.offset(n[0],sA.reverse(s));A.createPath(j.parentid,{id:i,...k,...s,...c,...d})}else{let k=[],$=new fa({id:i,parentid:j.parentid,pathBoolean:4,...s,...c,...d});k.push($);for(let g of n){let G=Tj.boundingBox(g),I={...G,...sA.subtract(G,s)},S=Tj.offset(g,sA.reverse(G)),T=new cn({parentid:i,...I,...S,...c});k.push(T)}A.tree.insertNodes(k)}let p=r.getParent(j.id);if(p!==null&&vA(p)){let k=p.children.indexOf(j);A.moveNode(i,p.id,k)}return A.deleteNode(j.id),t||A.selection.set(i),e===!0&&A.setTool(33),[i,a]}function EI(A){let j={};return A.forEach(e=>{j[e.id]||(j[e.id]=[]),j[e.id].push(e.index)}),j}function Iq(A,j){let e=1/j;return{x:Math.round(A.x*e)/e,y:Math.round(A.y*e)/e}}function Fq(A,j){let e=A.getNode(j.id);if(!e||!e.pathSegments)return null;let t=e.pathSegments[j.index],r=j.handle===0?fj.calculatedHandleIn(t):fj.calculatedHandleOut(t);return A.convertPointToCanvas(e,r)}function Qf(A,j){return j.handle===0?{x:A.handleOutX,y:A.handleOutY}:{x:A.handleInX,y:A.handleInY}}function Gq(A,j,e,t,r){let o=A.getNode(j.id),n=o.pathSegments[j.index];return e=A.convertPointToNode(o,e),e=sA.subtract(e,n),$e.update(o.pathSegments,j.index,a=>{let i=Qf(a,j),s=a.handleMirroring==="straight",c=a.handleMirroring;t&&(i=Qf(t,j),s=t.handleMirroring==="straight",c=t.handleMirroring),s&&(c="symmetric"),t&&r&&(c==="disconnected"||c==="asymmetric"?c="symmetric":c="disconnected"),c==="symmetric"&&(i=sA.reverse(e));let d=j.handle===0,p=d?e.x:i.x,k=d?e.y:i.y,$=d?i.x:e.x,g=d?i.y:e.y;return a.merge({handleOutX:$,handleOutY:g,handleInX:p,handleInY:k,handleMirroring:c})})}function Tn(A,j,e=!1,t){let r=A.tree,o=(0,vn.Map)(),n=(0,vn.Map)();if(!It(j)&&!SA(j))return{descendantPaths:o,descendantBasicShapes:n};let a={};ac(r,j,a);let i=Object.keys(a);for(let d=0,p=i.length;d<p;d++){let k=i[d],$=a[k];o=o.set(k,$)}let s={};sc(r,j,s,e);let c=Object.keys(s);for(let d=0,p=c.length;d<p;d++){let k=c[d],$=s[k];n=n.set(k,$)}return n.forEach((d,p)=>{if(d!==null)return;let k=r.getNode(p);if(!k||!Uf(A,[k]))return;let[$,g]=ic(A,k,!1,!0),G=g[0];o=o.set($,G),t&&t.includes(p)&&A.selection.toggle($)}),{descendantPaths:o,descendantBasicShapes:n}}function Wf(A,j){let e=A.tree,t=(0,vn.Map)(),r=(0,vn.Map)();if(!SA(j))return{shapeContainerDescendantPaths:t,shapeContainerDescendantBasicShapes:r};let o={};ac(e,j,o,j);let n=Object.keys(o);for(let s=0,c=n.length;s<c;s++){let d=n[s],p=o[d];t=t.set(d,p)}let a={};sc(e,j,a,!1,!1,j);let i=Object.keys(a);for(let s=0,c=i.length;s<c;s++){let d=i[s],p=a[d];r=r.set(d,p)}return r.forEach((s,c)=>{if(s!==null)return;let d=e.getNode(c);if(!d||!Uf(A,[d]))return;let[p,k]=ic(A,d,!1,!0),$=k[0],g=vt(e,j,[$])[0];t=t.set(p,{pathSegments:g,pathClosed:!0})}),{shapeContainerDescendantPaths:t,shapeContainerDescendantBasicShapes:r}}function ac(A,j,e,t){if(lt(j)||Oo(j)||SA(j))for(let r of j.children)It(r)&&ac(A,r,e,t);else if(no(j)){let r=Pn(A,j,j)[0].pathSegments;t&&(r=vt(A,t,[{pathSegments:r,pathClosed:j.pathClosed}])[0]),e[j.id]={pathSegments:r,pathClosed:j.pathClosed}}}function sc(A,j,e,t=!1,r=!1,o){if(lt(j)||Oo(j)||SA(j))for(let n of j.children){let i=Rt(n)&&Z(n.rotation)&&n.rotation%90!==0||t;It(n)&&sc(A,n,e,i,r,o)}else if(!no(j)&&It(j))if(t||r)e[j.id]=null;else{let n=w.pointsAtOrigin(A.getRect(j));e[j.id]=n.map(a=>{let i=A.convertPointToCanvas(j,a);return o?A.convertPointToNode(o,i,!0):i})}}function Pn(A,j,e,t=1){let r=[];return Array.isArray(e)?r=e:r=[e],r.map(({pathSegments:o,pathClosed:n})=>({pathSegments:o.map(i=>nc(A,j,i,t,void 0)),pathClosed:n}))}function nc(A,j,e,t=1,r){let o=sA.multiply(A.convertPointToCanvas(j,e,!0,r),t),n=sA.multiply(A.convertPointToCanvas(j,fj.calculatedHandleIn(e),!0,r),t),a=sA.multiply(A.convertPointToCanvas(j,fj.calculatedHandleOut(e),!0,r),t),i=sA.subtract(n,o),s=sA.subtract(a,o);return e.merge({...o,handleOutX:s.x,handleOutY:s.y,handleInX:i.x,handleInY:i.y})}function vt(A,j,e){return e.map(({pathSegments:t})=>t.map(r=>{let o=A.convertPointToNode(j,r),n=A.convertPointToNode(j,fj.calculatedHandleIn(r)),a=A.convertPointToNode(j,fj.calculatedHandleOut(r)),i=sA.subtract(n,o),s=sA.subtract(a,o);return r.merge({...o,handleOutX:s.x,handleOutY:s.y,handleInX:i.x,handleInY:i.y})}))}function zf(A,j,e,t){return t.map(({pathSegments:r})=>r.map(o=>{let n={x:o.x,y:o.y},a=A.convertPointFromNodeToDescendant(j,e,n),i=A.convertPointFromNodeToDescendant(j,e,fj.calculatedHandleIn(o)),s=A.convertPointFromNodeToDescendant(j,e,fj.calculatedHandleOut(o)),c=sA.subtract(i,a),d=sA.subtract(s,a);return o.merge({...a,handleOutX:d.x,handleOutY:d.y,handleInX:c.x,handleInY:c.y})}))}function lc(A,j){return j.map(({pathSegments:e})=>e.map(t=>{let r=Bj.convertPoint(A,t),o=Bj.convertPoint(A,fj.calculatedHandleIn(t)),n=Bj.convertPoint(A,fj.calculatedHandleOut(t)),a=sA.subtract(o,r),i=sA.subtract(n,r);return t.merge({...r,handleOutX:i.x,handleOutY:i.y,handleInX:a.x,handleInY:a.y})}))}function fI(A,j,e){let t=j.updateForPath(e);A.tree.current(j)?.set(t)}function Sq(A,j,e,t,r){let o=A.getParent(e.id),n=e.updateForPath(t);j.createPath(o?o.id:pj,{...n,id:r,rotation:e.rotation,...Xf(e)})}function yq(A,j,e){if(e===0)return j;let t=[],r=EI(j),o=Object.keys(r);for(let n=0,a=o.length;n<a;n++){let i=o[n],s=[],c=A.getNode(i),d=r[i],p=c.pathSegments.length;for(let k=0,$=d.length;k<$;k++){let g=d[k];s.push(g);let G=g+1;G===p?s.push(0):s.push(G)}for(let k=0,$=s.length;k<$;k++){let g=s[k];t.push({id:c.id,index:g})}}return t}function bq(A,j,e){for(let t of A)if(t.id===j&&t.index===e)return!0;return!1}function Cq(A,j,e,t,r,o){let n=Pn(A,r,r),a=vt(A,e,n)[0],i=!Tj.isLastSegment(e.pathSegments,e.pathClosed,t.index),s=Tj.isLastSegment(r.pathSegments,r.pathClosed,o.index);(!i&&s||i&&!s)&&(a=Tj.reverse(a));let d;i?d=$e.unshift(e.pathSegments,...a):d=$e.push(e.pathSegments,...a),j.deleteNode(r.id),fI(j,e,{pathSegments:d})}function $I(A,j,e){let t=T7(A,j);if(e===0){if(t)return sA.subtract(j,A);if(A.handleOutX!==0||A.handleOutY!==0){let o=fj.calculatedHandleOut(A);return sA.subtract(o,A)}let r=fj.calculatedHandleIn(j);return sA.subtract(r,A)}else{if(t)return sA.subtract(A,j);if(j.handleInX!==0||j.handleInY!==0){let o=fj.calculatedHandleIn(j);return sA.subtract(o,j)}let r=fj.calculatedHandleOut(A);return sA.subtract(r,j)}}function vq(A,j){let e=A.getNode(j.id);if(!e)return null;let t=e.pathSegments[j.segmentIndex],r=e.pathSegments[j.segmentIndex+1];if(!t||!r)return null;let o=nc(A,e,t),n=nc(A,e,r),i=j.projectedTime<.5?fj.point(o):fj.point(n),s=$I(o,n,0);return Wd(i,sA.add(i,s))}var BI=15;function Tq(A,j,e,t){let r=5/t,o=BI/t,n=j.cache.canvasRect;if(n&&(n.x-e.x>r||n.y-e.y>r||e.x-(n.x+n.width)>r||e.y-(n.y+n.height)>r))return null;let a=Tj.toBezierJS(j,j),i=A.convertPointToNode(j,e),s=-1,c=1/0,d=0;for(let G=0,I=a.length;G<I;G++){let T=a[G].project(i),v=T.d,P=T.t;v>=c||P===0||P===1||(c=v,s=G,d=P)}if(s===-1)return null;let p=a[s],k=p.get(d),$=p.get(.5),g=sA.distance(i,$)<o;return{id:j.id,segmentIndex:s,distance:c,projectedPoint:k,projectedTime:d,midPoint:$,midPointInRange:g}}function Xf(A){return{strokeEnabled:A.strokeEnabled,strokeAlignment:A.strokeAlignment,strokeWidth:A.strokeWidth,strokeColor:A.strokeColor,lineJoin:A.lineJoin,lineCap:A.lineCap,strokeMiterLimit:A.strokeMiterLimit,strokeDashArray:A.strokeDashArray,strokeDashOffset:A.strokeDashOffset,fillEnabled:A.fillEnabled,fillType:A.fillType,fillColor:A.fillColor,fillLinearGradient:A.fillLinearGradient,fillRadialGradient:A.fillRadialGradient,fillImage:A.fillImage,fillImageResize:A.fillImageResize,fillImageOriginalName:A.fillImageOriginalName,fillImagePixelWidth:A.fillImagePixelWidth,fillImagePixelHeight:A.fillImagePixelHeight,fillImagePositionX:A.fillImagePositionX,fillImagePositionY:A.fillImagePositionY,fillImageTileSize:A.fillImageTileSize,boxShadows:A.boxShadows,opacity:A.opacity}}function Yf(A,j){let e=A.getRect(j),t={width:e.width,height:e.height};if(!fA(j)||!ie(j))return t;let r=Yr(j);if(r.perSide)r.top&&(t.height-=r.top),r.bottom&&(t.height-=r.bottom),r.right&&(t.width-=r.right),r.left&&(t.width-=r.left);else if(r.top){let o=r.top*2;t.width-=o,t.height-=o}return t.width=Math.max(1,t.width),t.height=Math.max(1,t.height),t}function Zq(A,j,e,t){A.getNodesWithTrait(e,JA).forEach(o=>{let{descendantPaths:n}=Tn(j,o,!0,e),a=n.valueSeq().toArray(),i=Tj.boundingBox(a),s={...i};t==="horizontal"?(s.x=i.x+i.width,s.width=-i.width):(s.y=i.y+i.height,s.height=-i.height);let c=s.width>-1&&s.width<1?1:s.width,d=s.height>-1&&s.height<1?1:s.height,p=[i.x,i.x+i.width],k=[s.x,s.x+c],$=[i.y,i.y+i.height],g=[s.y,s.y+d],G=c/i.width,I=d/i.height;n.forEach((S,T)=>{let v=S.pathSegments.map(L=>L.merge({x:Gj(L.x,p,k,!1),y:Gj(L.y,$,g,!1),handleOutX:L.handleOutX*G,handleOutY:L.handleOutY*I,handleInX:L.handleInX*G,handleInY:L.handleInY*I}));E(j.tree===A);let P=A.get(T);if(!P)return;let _={pathSegments:v,pathClosed:P.pathClosed},O={pathSegments:vt(A,P,[_])[0],pathClosed:P.pathClosed},Q=P.updateForPath(O);P.set(Q)})})}function A2(A,j,e){let{tree:t}=A;j.forEach(r=>{let o=t.getRect(r),n=e(o);if(n.width&&n.width<1&&(n.width=1),n.height&&n.height<1&&(n.height=1),SA(r))gI(A,r,n);else if(It(r))hI(A,r,n);else{let a=t.getParent(r.id),i=a?Yf(t,a):null,s=r.updateForSize(n,i?{sizing:i,positioning:i,viewport:r.cache.viewportRect,layout:he(a)}:null);t.current(r)?.set(s)}})}function gI(A,j,e){let{tree:t}=A,r=t.getParent(j.id),o=r?t.getRect(r):null,n=j.updateForSize(e,o?{sizing:o,positioning:o,viewport:null,layout:he(r)}:null);n.sizeToFit=!1,t.current(j)?.set(n)}function hI(A,j,e){let{tree:t}=A,r=t.getRect(j),o=Pi.update(r,e,Hr(j)?Z(j.aspectRatio):!1),n={...r,...o},a=n.width>-1&&n.width<1?1:n.width,i=n.height>-1&&n.height<1?1:n.height,s=[r.x,r.x+r.width],c=[n.x,n.x+a],d=[r.y,r.y+r.height],p=[n.y,n.y+i],k=a/r.width,$=i/r.height,{descendantPaths:g,descendantBasicShapes:G}=Tn(A,j);g.forEach((I,S)=>{let v=vt(t,j,[I])[0].map(L=>L.merge({x:Gj(L.x+r.x,s,c,!1)-r.x,y:Gj(L.y+r.y,d,p,!1)-r.y,handleOutX:L.handleOutX*k,handleOutY:L.handleOutY*$,handleInX:L.handleInX*k,handleInY:L.handleInY*$})),P=Pn(t,j,{pathSegments:v,pathClosed:!0});E(A.tree===t);let _=t.get(S);if(!_)return;let O={pathSegments:vt(t,_,P)[0],pathClosed:_.pathClosed},Q=_.updateForPath(O);_.set(Q)}),G.forEach((I,S)=>{if(I===null)return;let P=I.map(N=>t.convertPointToNode(j,N)).map(N=>({x:Gj(N.x+r.x,s,c,!1)-r.x,y:Gj(N.y+r.y,d,p,!1)-r.y})).map(N=>t.convertPointToCanvas(j,N)),_=t.get(S);if(!_)return;let H=P.map(N=>t.convertPointToNode(_,N)),O=w.boundingRectFromPoints(H),Q=w.center(O),L=ja(_,Q),dA={x:L.x-O.width/2,y:L.y-O.height/2,width:O.width,height:O.height};_.set(dA)})}function Zf(A,j,e,t,r,o){let{tree:n}=A,a=n.getNode(j.id),i=o.width>-1&&o.width<1?1:o.width,s=o.height>-1&&o.height<1?1:o.height,c=i/r.width,d=s/r.height;e.forEach((p,k)=>{let $=n.getNode(k);if(!$)return;let G={pathSegments:p.pathSegments.map(v=>v.merge({x:v.x*c,y:v.y*d,handleOutX:v.handleOutX*c,handleOutY:v.handleOutY*d,handleInX:v.handleInX*c,handleInY:v.handleInY*d})),pathClosed:p.pathClosed},S={pathSegments:zf(n,a,$,[G])[0],pathClosed:$.pathClosed},T=$.updateForPath(S);$.set(T)}),t.forEach((p,k)=>{if(p===null)return;let $=p.map(S=>({x:S.x*c,y:S.y*d})),g=n.getNode(k),G=$.map(S=>n.convertPointFromNodeToDescendant(a,g,S,!1)),I=w.boundingRectFromPoints(G);A.tree.get(k)?.set(I)})}function A$(A,j,e,t,r,o=n=>n.canvasMatrix()){let n=t.width>-1&&t.width<1?1:t.width,a=t.height>-1&&t.height<1?1:t.height,i=[e.x,e.x+e.width],s=[t.x,t.x+n],c=[e.y,e.y+e.height],d=[t.y,t.y+a],p=n/e.width,k=a/e.height,$=r?{x:0,y:0}:j.rect;j.descendantPaths&&j.descendantPaths.forEach((g,G)=>{let S=(r?g.pathSegments:lc(j.canvasMatrix.inverse(),[g])[0]??[]).map(O=>O.merge({x:Gj(O.x+$.x,i,s,!1)-$.x,y:Gj(O.y+$.y,c,d,!1)-$.y,handleOutX:O.handleOutX*p,handleOutY:O.handleOutY*k,handleInX:O.handleInX*p,handleInY:O.handleInY*k})),T=r?{pathSegments:S,pathClosed:g.pathClosed}:{pathSegments:lc(j.canvasMatrix,[{pathSegments:S,pathClosed:g.pathClosed}])[0]??[],pathClosed:g.pathClosed},v=A.get(G);if(!v)return;let _={pathSegments:vt(A,v,[T])[0],pathClosed:v.pathClosed},H=v.updateForPath(_);v.set(H)}),j.descendantBasicShapes&&j.descendantBasicShapes.forEach((g,G)=>{if(g===null)return;let S=(r?g:g.map(L=>Bj.convertPoint(j.canvasMatrix.inverse(),L))).map(L=>({x:Gj(L.x+$.x,i,s,!1)-$.x,y:Gj(L.y+$.y,c,d,!1)-$.y})),T=r?S:S.map(L=>Bj.convertPoint(j.canvasMatrix,L)),v=A.get(G);if(!v)return;let P=T.map(L=>Bj.convertPoint(o(v).inverse(),L)),_=w.boundingRectFromPoints(P),H=w.center(_),O=ja(v,H),Q={x:Ws(O.x-_.width/2),y:Ws(O.y-_.height/2),width:_.width,height:_.height};v.set(Q)})}function e$(A,j,e,t,r){if(e!==1)for(let[o]of t.parentsInitialState){let n=t.parentsInitialState.get(o);if(!n)continue;let a=[];for(let i of j)n.selectedNodeIds.has(i.id)&&a.push(i);r$(a,e,GI(A,o,e,t,r),!0)}}function t$(A,j){let e=new Map,t=new Map,r={},o=new Set;for(let n of A.tree.withoutDescendants(j)){let a=n.parentid;if(!a)continue;let i=A.tree.getNode(a);E(i,"Parent must exist"),RI(A,n,t,o),FI(A,n,i,e),r[a]??=[],r[a].push(n)}for(let[n,a]of e){let i=r[n];E(i,"Nodes must exist"),a.selectionBoundingFrame=A.tree.getBoundingFrameForNodes(i)}return{parentsInitialState:e,nodesInitialState:t,nonScalableNodes:o}}function RI(A,j,e,t){for(let{node:r,skipChildren:o}of j.walkWithSkipChildren()){if(e.has(r.id))continue;let n=r.id===j.id,a=A.tree.isInlineVectorNode(r),i=JA(r)&&(a||n);if(!NI(r,n)){t.add(r.id),o();continue}let s=i?Tn(A,r):void 0,c=SA(r)?Wf(A,r):void 0,d=SA(r)||i?Vf(r.draftOrCurrent()):void 0,p=z(r)?II(r):void 0;e.set(r.id,{rect:w.round(A.tree.getRect(r,!1),2),matrix:A.tree.transformMatrixToNode(r),codeComponentControlProps:p,scalableShapeStylesMap:d,...s,...c}),SA(r)&&o()}}function II(A){let j=V.reactComponentForIdentifier(A.codeComponentIdentifier);if(!(!j||!j.properties))return A.getControlProps(j.properties)}function FI(A,j,e,t){let r=t.get(e.id)??{matrix:A.tree.transformMatrixToNode(e).invertSelf(),selectedNodeIds:new Set,selectionBoundingFrame:{x:0,y:0,width:0,height:0}};r.selectedNodeIds.add(j.id),t.set(e.id,r)}function GI(A,j,e,t,r){let o=t.parentsInitialState.get(j);E(o,"Parent must be present in initial state");let n=o.selectionBoundingFrame,a={...n,width:n.width*e,height:n.height*e};return{initialRect:n,resizedRect:a,engine:A,tree:A.tree,initialState:t,anchorPoint:r??{x:.5,y:.5}}}function r$(A,j,e,t){if(A.length===0)return!1;let r=!1;for(let o of A){if(e.initialState.nonScalableNodes.has(o.id))continue;let n=xI(o)&&r$(o.children,j,e,!1),a=SI(o,e,j,n,t);r||=a||n}return r}function SI(A,j,e,t,r){let o=_I(A,e,r),n=yI(A,j,e,t,r,o);return A.set(o),(n||t)&&vI(A,j,e,r),n}function yI(A,j,e,t,r,o){return qA(A)?bI(A,e,j,r,o):SA(A)?CI(A,e,j,r,o):JA(A)?OI(A,e,j):z(A)?wI(A,e,j,r,o):WA(A)?o$(A,e,j,t,r,o):!1}function bI(A,j,e,t,r){let o=!1;if(!A.textFitViewBoxSize){DI(A,e.tree);let n=A.draftOrCurrent().updateForScale(j);Object.assign(r,n),o=!0}return A.widthType!==2&&(o=Eo("width",A,j,e,!1,t,r)||o),A.heightType!==2&&(o=Eo("height",A,j,e,!1,t,r)||o),o}function CI(A,j,e,t,r){let o=e.initialState.nodesInitialState.get(A.id),n=o?.shapeContainerDescendantPaths,a=o?.shapeContainerDescendantBasicShapes,i=o?.scalableShapeStylesMap;return E(i,"Shape container styles should be available in initial state"),E(n,"Shape container paths should be available in initial state"),E(a,"Shape container shapes should be available in initial state"),Zf(e.engine,A,n,a,A,{width:A.width*j,height:A.height*j}),rc(e.tree,i,j),Eo("width",A,j,e,!0,t,r),Eo("height",A,j,e,!0,t,r),!0}function vI(A,j,e,t){if(t)TI(A,e,j);else if($A(A)){let r={};A.left&&(r.left=eA(A.left,e)),A.right&&(r.right=eA(A.right,e)),A.top&&(r.top=eA(A.top,e)),A.bottom&&(r.bottom=eA(A.bottom,e)),A.set(r)}}function TI(A,j,e){if(!$A(A)&&!oa(A))return;let t=e.initialState.nodesInitialState.get(A.id);E(t,"Node must be present in initial state");let r=A.parentid?e.initialState.parentsInitialState.get(A.parentid):void 0;E(r,"Node parent must be present in the initial state"),r.selectedNodeIds.size===1?PI(A,j,e,t):MI(A,e,t,r)}function PI(A,j,e,t){let r=t.rect,o={...r,width:r.width*j,height:r.height*j},a=JA(A)||SA(A)?A.clone({rotation:0}):A,i=as(r,e.anchorPoint),s=as(o,e.anchorPoint),c=Bj.convertPoint(a.originAdjustedMatrix(null,r),i),d=Bj.convertPoint(a.originAdjustedMatrix(null,o),s),p=sA.subtract(c,d),k=w.round(w.offset(o,p),2);if($A(A)){let{widthType:$,heightType:g,maxHeight:G,minHeight:I,maxWidth:S,minWidth:T,...v}=w6(A.constraints(),k,e.tree.getParentSizeInfo(A,e.tree.getParent(A.id)),null,!1);A.set(v)}else A.set({x:k.x,y:k.y})}function MI(A,j,e,t){let r=sA.add(as(j.initialRect,j.anchorPoint),j.initialRect),o=sA.add(as(j.resizedRect,j.anchorPoint),j.resizedRect),n=sA.subtract(r,o),a=t.matrix??null,i=j$(a,j.initialRect),s=j$(a,w.offset(j.resizedRect,n)),c=[i.x,i.x+i.width],d=[s.x,s.x+s.width],p=[i.y,i.y+i.height],k=[s.y,s.y+s.height],$=e.rect,g={x:Gj($.x,c,d,!1),y:Gj($.y,p,k,!1)},G={x:Gj($.x+$.width,c,d,!1),y:Gj($.y+$.height,p,k,!1)},I=w.round(w.fromTwoPoints(g,G));if($A(A)){let S=w6(A.constraints(),I,j.tree.getParentSizeInfo(A,j.tree.getParent(A.id)),null,!1);delete S.widthType,delete S.heightType,A.set(S)}else A.set({x:I.x,y:I.y})}function j$(A,j){if(!A)return j;let e=Bj.convertPointsWithClipping(A,w.cornerPoints(j));return w.boundingRectFromPoints(e)}function _I(A,j,e){let t={};return ze(A)&&(t.borderWidth=eA(A.borderWidth,j),t.borderBottom=eA(A.borderBottom,j),t.borderLeft=eA(A.borderLeft,j),t.borderTop=eA(A.borderTop,j),t.borderRight=eA(A.borderRight,j)),zt(A)&&(t.boxShadows=i$(A.boxShadows,j)),oe(A)&&(t.strokeWidth=eA(A.strokeWidth,j)),Ye(A)&&(t.padding=eA(A.padding,j),t.paddingBottom=eA(A.paddingBottom,j),t.paddingLeft=eA(A.paddingLeft,j),t.paddingTop=eA(A.paddingTop,j),t.paddingRight=eA(A.paddingRight,j)),ir(A)&&(t.radiusBottomLeft=eA(A.radiusBottomLeft,j),t.radiusBottomRight=eA(A.radiusBottomRight,j),t.radiusTopLeft=eA(A.radiusTopLeft,j),t.radiusTopRight=eA(A.radiusTopRight,j)),Gt(A)&&(t.radius=eA(A.radius,j)),Si(A)&&(t.gridColumnMinWidth=eA(A.gridColumnMinWidth,j),t.gridColumnWidth=eA(A.gridColumnWidth,j),A.gridRowHeightType==="fixed"&&(t.gridRowHeight=eA(A.gridRowHeight,j))),ie(A)&&(t.gap=n$(A.gap,j)),Er(A)&&(t.formInputFontSize=a$(A.formInputFontSize,j),A.formInputFontLetterSpacingUnit==="px"&&(t.formInputFontLetterSpacing=eA(A.formInputFontLetterSpacing,j)),A.formInputFontLineHeightUnit==="px"&&(t.formInputFontLineHeight=eA(A.formInputFontLineHeight,j))),an(A)&&(t.blur=eA(A.blur,j,0),t.backgroundBlur=eA(A.backgroundBlur,j,0)),Se(A)&&A.fillType==="image"&&A.fillImageResize==="tile"&&(t.fillImageTileSize=eA(A.fillImageTileSize??1,j)),Qr(A)&&(t.minWidth=is(A.minWidth,j,e),t.maxWidth=is(A.maxWidth,j,e),t.minHeight=is(A.minHeight,j,e),t.maxHeight=is(A.maxHeight,j,e)),t}function o$(A,j,e,t,r,o){if(!Je(A))return o.width=eA(A.width,j),o.height=eA(A.height,j),!0;let n=!1;return n=Eo("width",A,j,e,t,r,o)||n,n=Eo("height",A,j,e,t,r,o)||n,n}function DI(A,j){let e=A.getTextStylePresets(!1);for(let t of e){let r=j.getNode(t);ct(r)&&A.draftOrCurrent().detachTextStylePreset(r,!1)}}function Eo(A,j,e,t,r,o,n){let a=A==="width"?"widthType":"heightType",i=j[a],s=t.initialState.nodesInitialState.get(j.id)?.rect;E(s,"node should have cached rect");let c=A==="width"?"gridItemFillCellWidth":"gridItemFillCellHeight";if(Yt(j)&&j[c]&&o)return n[c]=!1,n[A]=eA(s[A],e),n[a]=0,!0;switch(i){case 0:return n[A]=eA(j[A],e),!0;case 4:return n[A]=eA(j[A],e,4),!0;case 1:return o?(n[A]=eA(j[A],e,4),!0):!1;case 3:return o?(n[A]=eA(s[A],e),n[a]=0,!0):!1;case 2:if(!r){let p=t.tree.getNodeParent(j),$=(p&&ge(p)?p.layout:void 0)==="grid"?s[A]:j[A];return n[A]=eA($,e),n[a]=0,!0}return!1;default:cA(i)}}function NI(A,j){let e=z(A)?A.getSupportedLayout(V):void 0;return!(e?.width==="auto"&&e?.height==="auto"||GA(A)||Kj(A)&&!j)}function xI(A){return!(!A.children||SA(A)||JA(A))}function eA(A,j,e=2){return Z(A)?rj(A*j,e):A}function n$(A,j){return Z(A)?eA(A,j):M(A)?_i(A,e=>eA(e,j)):A}function is(A,j,e){if(oA(A))return A;let[t,r]=Bp(A);return Number.isNaN(t)||r==="%"&&!e?A:ut(eA(t,j,0),r)}function i$(A,j){if(!(!A||UA(A)))return A.map(e=>e.type==="realistic"?e:Di(e,{x:eA(e.x,j),y:eA(e.y,j),spread:eA(e.spread,j)}))}function OI(A,j,e){let t=e.initialState.nodesInitialState.get(A.id);return t?(A$(e.tree,{canvasMatrix:t.matrix,rect:t.rect,descendantPaths:t.descendantPaths,descendantBasicShapes:t.descendantBasicShapes},e.initialRect,e.resizedRect,!0,r=>{let o=e.initialState.nodesInitialState.get(r.id);return E(o,"Basic shape initial state must exist"),o.matrix}),t.scalableShapeStylesMap&&rc(e.tree,t.scalableShapeStylesMap,j),!0):!1}function as(A,j){return{x:A.width*j.x,y:A.height*j.y}}function wI(A,j,e,t,r){let o=WA(A)?o$(A,j,e,!1,t,r):!1,n=e.initialState.nodesInitialState.get(A.id)?.codeComponentControlProps;if(!n)return o;for(let a in n){let i=n[a];if(!(!i||UA(i.value)))switch(i.type){case"borderradius":r[VA(a)]={...i,value:qI(i.value,j)};break;case"padding":r[VA(a)]={...i,value:KI(i.value,j)};break;case"gap":r[VA(a)]={...i,value:n$(i.value,j)};break;case"boxshadow":r[VA(a)]={...i,value:i$(i.value,j)};break;case"font":r[VA(a)]={...i,value:JI(i.value,j)};break;case"border":r[VA(a)]={...i,value:HI(i.value,j)};break;case"array":case"boolean":case"collectionreference":case"color":case"slot":case"cursor":case"customcursor":case"date":case"enum":case"eventhandler":case"file":case"link":case"linkrelvalues":case"multicollectionreference":case"number":case"object":case"pagescope":case"richtext":case"scrollsectionref":case"string":case"transition":case"fusednumber":case"image":case"trackingid":case"vectorsetitem":break;default:cA(i)}}return o}function LI(A){return A.includes("%")}function qI(A,j){return UA(A)||LI(A)?A:_i(A,e=>eA(e,j))}function KI(A,j){return UA(A)?A:_i(A,e=>eA(e,j))}var VI={px:2,rem:3};function a$(A,j){if(oA(A))return A;let[e,t]=Z(A)?[A,"px"]:Mi(A);return ut(eA(e,j,VI[t]),t)}function JI(A,j){if(oA(A))return A;let e=a$(A.fontSize,j);return{...A,fontSize:e,lineHeight:A.lineHeight?.[1]==="px"?[eA(A.lineHeight[0],j),"px"]:A.lineHeight,letterSpacing:A.letterSpacing?.[1]==="px"?[eA(A.letterSpacing[0],j),"px"]:A.letterSpacing}}function HI(A,j){return!A||pA(A)?A:{...A,borderWidth:eA(A.borderWidth,j),borderTop:eA(A.borderTop,j),borderRight:eA(A.borderRight,j),borderBottom:eA(A.borderBottom,j),borderLeft:eA(A.borderLeft,j)}}var kc;(nt=>{function A(l){return l.selection.ids.length>0}nt.hasSelection=A;function j(l){return l.some(u=>k$(u))}nt.canCopyNodes=j;function e(l){return l.some(u=>s$(u))}nt.canDuplicateNodes=e;function t(l,u){return j(u)&&i(l,u)}nt.canCutNodes=t;function r(l,u,m=void 0,f=!0){let h=l.tree,F=h.withoutDescendants(h.getNodes(u)),y=l.stores.scopeStore.active,b=F.length===1?F[0]:void 0;if(!oA(b)&&wi(b)&&!GA(b)&&fA(b)&&rA(y)){let AA=h.getRect(b),dj=$n(h,y,b,AA),IA=nt.createVariant(l,y,b,dj);return IA?new Set([IA.id]):void 0}let C=F.find(AA=>GA(AA));if(C){let AA=l.tree.getScopeNodeFor(C);if(AA&&J(AA)){l.stores.modalStore.set({type:"DuplicateWebPage",source:"context_menu",duplicateFromId:AA.id});return}}let D=F.map(AA=>h.getRect(AA)),x=new Map,K=new Set,iA=[],lA=new Map,EA=new Map,gA=0;if(F.forEach((AA,dj)=>{if(!s$(AA))return;let IA=h.getParent(AA.id);if(xo(AA))if(IA&&z(IA)){if(!dp(IA,V))return}else return;for(let MA of AA.walk())fA(MA)&&gA++;let kA=l.cloneNode(AA,!1,!0,x);if(x.set(AA.id,kA.id),EA.set(AA.id,kA.id),K.add(kA.id),lA.set(AA,kA),AA.isMaster)Fl({});else if(AA.replicaInfo){let{master:MA}=AA.replicaInfo,wA=MA&&h.getNode(MA);wA&&_o(wA)||Fl({})}else t7(AA)&&(!m||m.node&&r7(m.node))&&jE(l,AA,x);if(m){let MA=h.getParent(AA.id);if(m.node){let wA=m.node;if(hA(m.node)&&(wA=Ce(h,m.node),!wA))return;if(ht(l.tree,wA,kA,l.stores.scopeStore.active.id,V)){let ue=MA&&LA(MA)&&LA(wA),mj=MA&&fA(MA)&&fA(wA);if(ue||mj)l.moveNode(kA.id,wA.id,m.insertionIndex);else if($A(kA)){l.moveNode(kA.id,wA.id,m.insertionIndex);let Pe=h.getParentSizeInfo(kA,wA,!0,!1),Oj=kA.updateForSize(D[dj]??{},Pe);MA||(Oj.left=0,Oj.top=0),l.tree.current(kA)?.set(Oj)}else nt.convertNodeToNewParent(l,kA,MA,m.node,m.insertionIndex,AA);if(ij(m.node)){yl(l,kA,m.node,wA,K,x);let it=uA.getReplicaForTemplateNode(h,m.node);if(it){let Pe=ee(it.id,kA.id);EA.set(AA.id,Pe)}}}}else nt.convertNodeToNewParent(l,kA,MA,m.node,m.insertionIndex,AA),LA(MA)&&D[dj]&&l.tree.current(kA)?.set(kA.updateForSize(D[dj],null))}}),!m){let AA=F.some(IA=>h.isGroundNode(IA)),dj=F.some(IA=>Rt(IA)&&IA.resolveValue("rotation")!==0);if(F.length){let IA=F.map(ZA=>h.convertFrameToCanvas(ZA)),kA=w.merge(...IA),MA,wA=O(l,u),ue=Q(h,F),mj=F.some(ZA=>JA(ZA)),it=l.documentSettings.lastDuplicationMap,Pe=!1;if(!mj&&wA&&!ue&&!dj&&it){let ZA=it.keys(),wj=l.tree.getBoundingFrameForNodes(h.getNodes(ZA));Pe=!0,MA=sA.subtract(kA,wj)}let Oj=MA||{y:0,x:0},Lt=F[0];if(!mj&&AA&&!Pe&&Lt){let ZA=rE(h,l.stores.scopeStore.active,Lt,kA,F.every(Xe)?{x:l.tree.getRect(Lt).width}:MA);Oj=sA.subtract(ZA,kA)}for(let ZA of F){let{x:wj,y:yo,width:Xg,height:Yg}=h.getRect(ZA),Me=lA.get(ZA);if(!Me)continue;let bo=l.tree.getParent(ZA.id),Co=l.tree.getParent(Me.id);if(Co&&bo&&ij(bo)){yl(l,Me,bo,Co,K,x);let Gd=uA.getReplicaForTemplateNode(h,bo);if(Gd){let jh=ee(Gd.id,Me.id);EA.set(ZA.id,jh)}}if(Co&&LA(Co))continue;let Id=wj+Oj.x,Fd=yo+Oj.y,Zg=l.tree.getParentSizeInfo(ZA,bo),Ah=Me.updateForRect({rect:{x:JA(ZA)?Id:Math.round(Id),y:JA(ZA)?Fd:Math.round(Fd),width:Xg,height:Yg},parentSizeInfo:Zg,constraintsLocked:!1,shouldGuessPinToBottom:!0,shouldGuessPinToRight:Vj(l.tree,Me,Co)});l.tree.current(Me)?.set(Ah),AA&&h.isGroundNode(Me)&&iA.push(Me.rect())}}}l.documentSettings.lastDuplicationMap=EA;let RA=[];for(let AA of lA.values())tt(h,AA,x,!1),Xe(AA)&&RA.push(AA);if(RA.length&&l.codeGenerationStore.createVectorSet(RA),iA.length){let AA=w.merge(...iA);l.canvasStore.scrollToCenter(w.center(AA))}return f&&K.size>0&&l.selection.set(K,{sticky:!0}),gA>0&&BA("layout_frame",{source:"duplication",count:gA}),K}nt.duplicateNodes=r;function o(l){if(l.length>=50)return!0;let m=l.length;return l.forEach(f=>{m+=tc(f)}),m>=50}function n(l,u,m){let f=l.tree.withoutDescendants(u);function h(){let F=[],y=[];f.forEach(b=>{if(je(b))if(Ui(l.tree,b))y.push(b);else{let C=l.tree.get(b.originalid);C&&pc(C)&&F.push(C.id)}else pc(b)&&F.push(b.id)}),y.forEach(b=>b.set({visible:!1})),l.deleteNodes(F),l.selection.clear(),l.setHighlight(null)}m&&o(f)?l.stores.modalStore.set({type:"Confirmation",variant:"destructive",title:"Delete Selection",description:"You are about to delete the selected layers for all project collaborators.",confirmLabel:"Delete",onConfirm:h,source:"delete_node"}):h()}nt.deleteOrHideNodes=n;function a(l,u){l.tool.deleteAction?l.tool.deleteAction():u&&n(l,u,!0)}nt.deleteAction=a;function i(l,u){return l.tool.deleteAction?!!l.tool.canDelete&&l.tool.canDelete():!!u&&u.some(m=>WI(m))}nt.canDeleteOrHideNodes=i;function s(l,u){return we(u)?!1:jj(u)?je(u):!qr(u)}nt.canRenameNode=s;function c(l,u){return u.filter(m=>s(l,m)).length===1}nt.canRename=c;function d(l,u){return l.stores.chromeStore.contentPanelTab!=="Pages"||l.stores.scopeStore.active.id===l.tree.root.homePageNodeId||u.length!==0?!1:J(l.stores.scopeStore.active)||sj(l.stores.scopeStore.active)}nt.canRenameActivePage=d;function p(l,u){if(d(l,u)){let m=l.stores.scopeStore.active.id,f=er(l.tree,m)?.id||m;Ma(f)}else u.length===1&&(l.stores.chromeStore.layersExpanded=!0,l.stores.chromeStore.contentPanelTab="Layers",l.runBeforeNextFrame(()=>{let m=document.querySelectorAll(".layerPanelPlaceholder.active");if(m.length===1&&m[0]){let f=new MouseEvent("dblclick",{view:window,bubbles:!0,cancelable:!0}),h=m[0].parentElement;h&&h.dispatchEvent(f)}}))}nt.rename=p;async function k(l,u){if(!yn.isAvailable)return;let m=mA("generateLayerNames");TA({type:"add",key:"generate-layer-names",text:"Snapshotting layer\u2026",variant:"progress",duration:1/0});let f=await yn.whenAvailable({toastIfNot:!0},l);if(f){let h=await f.getImageData({nodeId:u.id,type:"image/png",pixelRatio:1});m.debug("imageData",h);let F=JSON.stringify(u.toJS()),y="Here is an image and the document structure for a webpage section. Please provide me a nice and short name for every node in this hierarchy to display in the layer panel. Make them specific to their visual content and avoid generic names like 'Frame' or 'Stack'. Also avoid numbering them, as they do not have to be unique.";TA({type:"add",key:"generate-layer-names",text:"Generating layer names\u2026",variant:"progress",duration:1/0});let b=await Zm({messages:[{role:"user",content:y},{role:"user",content:h},{role:"user",content:F}],model:"google/gemini-2.0-flash-001",schema:{$schema:"http://json-schema.org/draft-07/schema#",type:"array",items:{type:"object",properties:{nodeId:{type:"string"},name:{type:"string"}},required:["nodeId","name"]}}});TA({type:"add",key:"generate-layer-names",text:"Updating layers\u2026",variant:"progress",duration:1/0}),await l.processWhenReadyAsync(()=>{for(let C of b){let{nodeId:D,name:x}=C;if(typeof D!="string"||typeof x!="string")continue;let K=l.tree.get(D);m.debug("nodeId",K,x),K&&K.set({name:x})}}),TA({type:"remove",key:"generate-layer-names"})}}nt.generateLayerNames=k;function $(l,u){let m=l.tree,f=m.withoutDescendants(u),h=vr(f);T(m,u,h)&&fd(l,h,"front")}nt.sendToFront=$;function g(l,u){let m=l.tree,f=m.withoutDescendants(u),h=vr(f);S(m,u,h)&&fd(l,h,"back")}nt.sendToBack=g;function G(l,u){let m=l.tree,f=m.withoutDescendants(u),h=vr(f);T(m,u,h)&&$d(l,h,1)}nt.sendForward=G;function I(l,u){let m=l.tree,f=m.withoutDescendants(u),h=vr(f);S(m,u,h)&&$d(l,h,-1)}nt.sendBackward=I;function S(l,u,m){if(Ed(u))return!1;if(!m){let f=l.withoutDescendants(u);m=vr(f)}return Bd(l,m,-1)}nt.sendBackwardEnabled=S;function T(l,u,m){if(Ed(u))return!1;if(!m){let f=l.withoutDescendants(u);m=vr(f)}return Bd(l,m,1)}nt.sendForwardEnabled=T;function v(l,u){return PA(l,u,0)}nt.addFrame=v;function P(l,u){return PA(l,u,1)}nt.addStack=P;function _(l,u){let m=l.stores.scopeStore.active,f=l.tree.withoutDescendants(u);return f.length>1&&Ij(l,f)&&(!J(m)||f.every(h=>l.tree.isGroundNode(h)))}nt.canWrapInAutoSizedFrame=_;function H(l,u,m){let f=v(l,u);E(f!==void 0,"new frame ID must be defined");let h=l.tree.getNode(f);E(h!==null,"new frame must exist");let F=l.tree.withoutDescendants([h]);return Nf(l,F,m),h}nt.wrapInAutoSizedFrame=H;function O(l,u){if(!l.documentSettings.lastDuplicationMap||!hn(u,l.selection.ids))return!1;let m=[...l.documentSettings.lastDuplicationMap.values()];if(!hn(l.selection.ids,m))return!1;let f=[...l.documentSettings.lastDuplicationMap.keys()];return hn(l.selection.previousIds,f)}function Q(l,u){let m=l.getCommonGroundNode(u);return!!m&&LA(m)}function L(l,u,m){if(m!==null){let f=u.flatMap(b=>l.convertCornerPointsToCanvas(b)),h=l.transformMatrixToNode(m),F=(H6(m)?h:Bj.flatProjectionMatrix(h)).invertSelf(),y=f.map(b=>Bj.convertPoint(F,b));return w.roundToOutside(w.boundingRectFromPoints(y))}return w.roundToOutside(w.merge(...u.map(f=>l.convertFrameToCanvas(f))))}nt.getUntransformedBoundingRect=L;function dA(l,u,m,f,h,F){let y={top:m.y,left:m.x,width:m.width,height:m.height,fillEnabled:!1},b=h.length===1?h[0]:null;E(b!==void 0,"node must be defined",h),f&&Object.assign(y,N(u,m,f,b,F));let C=f===null,D=J(l.stores.scopeStore.active);return y.overflow=C||D?Fe():"visible",y}function N(l,u,m,f,h){let F=l.getViewportRect(m),y=l.getRect(m),b=f?l.getParentSizeInfo(f,m):{sizing:y,positioning:y,viewport:F,layout:he(m)},C=!!f&&$A(f),D=X(f,h),x=Fk({rect:u,parentSizeInfo:b,currentConstraints:D,constraintsLocked:C,shouldGuessPinToBottom:jt(l,null,m),shouldGuessPinToRight:Vj(l,null,m),floatingPosition:null});return h&&m?{...Xr(f,m),...Y(f),...x,widthType:ie(m)?3:1,heightType:2,width:1,left:0}:{...Xr(f,m),...Y(f),...x}}function X(l,u){let f=!!l&&$A(l)?l.constraints():void 0;if(!f)return;let h={...f};return!u&&h.widthType===2&&(h.widthType=0),!u&&h.heightType===2&&(h.heightType=0),h}function Y(l){if(!(!l||!WA(l)))return{width:l.width,height:l.height}}function nA(l,u,m,f,h,F,y,b,C){let D=F?.id??pj;switch(u){case 0:{let x=l.createFrame(D,{id:m,...C},f);return l.moveNode(x.id,D,y),E(x&&vA(x),"Fail to create a wrapping frame: the created frame should have the `children` field"),b.forEach(K=>{let iA=So(l.tree,K,F,x);l.moveNode(K.id,x.id),l.tree.current(K)?.set(iA)}),x}case 1:{let x=aA(l,m,D,C,b,h);return l.moveNode(x.id,D,y),x}case 2:{let x=l.createShapeContainer(D,{id:m,...C});return l.moveNode(x.id,D,y),E(x&&vA(x),"Fail to create a wrapping frame: the created frame should have the `children` field"),b.forEach(K=>{let iA=So(l.tree,K,F,x);l.moveNode(K.id,x.id),l.tree.current(K)?.set(iA)}),x}default:cA(u)}}function aA(l,u,m,f,h,F,y){let b=Ol(l,h,F),C=l.createNode(pe,{id:u,...f,...b},m,y);E(ae(C),"Fail to create stack: the created node should have stack layout");let{stackDirection:D}=b;return PE(l,u,F,h,D),C}function PA(l,u,m){let f=l.tree;if(!Ij(l,u))return;let h=f.sortVisually(f.withoutDescendants(u)),F=h[0]?f.getParent(h[0].id):null,y=F&&ij(F),b=y?l.tree.getNode(F.originalid):F,C=!0,D=y?h.map(RA=>{if(!jj(RA))return RA;let AA=l.tree.getNode(RA.originalid);return E(AA,"Fail to create a wrapping frame: the original node must exist"),C&&(C=!AA.cache.visible),AA}):h,x=F?.children.findIndex(RA=>h.includes(RA))??-1,K=f.newId(),iA=L(f,D,b),lA=dA(l,f,iA,b,D,m===1),EA=nA(l,m,K,D[0]?.id,iA,b,x,D,lA),gA=K;if(y){E(F,"Fail to create a wrapping frame: parentNode should not be null"),E(hA(F),"Fail to create a wrapping frame: parentNode should be a replica node"),C&&fn(l,EA,F,b);let RA=uA.getReplicaForTemplateNode(l.tree,F);E(RA,"Fail to create a wrapping frame: replica must exist");let AA=L(f,h,F),dj=dA(l,f,AA,F,h,m===1);dn(f,RA,EA.id,dj),uA.replicaWithChanges(l.tree,RA.draftOrCurrent());let IA=ee(RA.id,K);gA=IA;let kA=l.tree.get(IA);if(E(kA&&vA(kA),"Fail to create a wrapping frame: replica wrapping node should exist and should have the `children` field"),m===0||m===2)h.forEach(MA=>{let wA=So(f,MA,F,kA);l.tree.current(MA)?.set(wA)});else if(m===1){E(fA(EA),"Fail to create a wrapping frame: the wrapping node should be a FrameNode"),E(ae(EA),"Fail to create a wrapping frame: the wrapping node should have stack layout");let MA=Ol(l,h,AA);dn(f,RA,EA.id,MA),vE(l,EA,MA.stackDirection,h,AA)}}return l.selection.set(gA),K}function YA(l){return Vo(l)||CA(l)||$j(l)||Ti(l)||we(l)||xo(l)?!1:jj(l)?je(l):!0}function Ij(l,u){if(u.length===0)return!1;switch(l.tool.enum){case 0:case 1:case 6:break;default:return!1}if(!u.every(y=>YA(y)))return!1;let m=l.tree,f=m.withoutDescendants(u),[h,F]=f.reduce(([y,b],C)=>{let D=m.isInlineVectorNode(C)||!JA(C)&&!$j(C),x=f[0]?m.getParentId(f[0]):void 0,K=m.getParentId(C);return[y&&x===K,b&&D]},[!0,!0]);return h&&F}nt.wrappingEnabled=Ij;function uj(l){return l.some(Qe)}nt.overflowEnabled=uj;function cj(l){return l.find(m=>vp(m))!==void 0}nt.nodesAreClipping=cj;function xj(l){l.stores.chromeStore.removePanelOverrides(),l.stores.chromeStore.chromeIsVisible=!0,l.stores.chromeStore.pagesExpanded=!0,l.stores.chromeStore.contentPanelTab="Pages";let u=new Set(l.stores.scopeStore.getDesignPageNodes().map(f=>f.name??"")),m=l.createNode(cu,{name:Pj("Exploration",u,{startIndex:u.size+1,omitCountIfFirst:!1})},l.tree.root.id);l.stores.scopeStore.select(m.id,{keepHistory:!1}),l.runAtEndOfFrame(()=>Ma(m.id))}nt.createDesignPage=xj;function ke(l){l.stores.chromeStore.removePanelOverrides(),l.stores.chromeStore.chromeIsVisible=!0,l.stores.chromeStore.pagesExpanded=!0,l.stores.chromeStore.contentPanelTab="Pages";let u=new Set(l.stores.scopeStore.getCanvasPageNodes().map(F=>F.name??"")),m=l.createNode($k,{name:Pj("Canvas",u,{startIndex:u.size+1,omitCountIfFirst:!1})},l.tree.root.id),f=$u("iPhone_390_844"),h=l.createFrame(m.id,{width:f.screenWidth,height:f.screenHeight,name:f.title,framePreset:f.id,isScreen:!0});l.codeGenerationStore.updateComponent(h.id).catch(yA),l.stores.scopeStore.select(m.id,{keepHistory:!1}),Om({pageId:m.id}),l.runAtEndOfFrame(()=>Ma(m.id))}nt.createCanvasPage=ke,nt.toggleContentManagementScope=l=>{let u=l.stores.chromeStore.mainView;if(u===2){l.stores.scopeStore.selectPreviousActiveScope();return}switch(u){case 0:l.cancelTool();break;case 5:l.stores.chromeStore.setLocalizationsVisible(!1);break;case 6:l.analytics.close();break;case 4:l.siteSettings.close();break;case 1:l.codeEditorStore.closeEditor();break;case 3:break;default:cA(u)}let m=l.tree.getContentManagementNode()?.loaded;if(m&&m.children.length>0){let f=l.stores.scopeStore.active,h=l.selection.nodes.at(0);l.stores.scopeStore.select(m.id,{keepHistory:!1});let F=zI(l,f,h);if(F){l.selection.set(F);return}if(l.selection.ids.length===0){let y=m.children[0];y&&l.selection.set(y.id)}}else l.stores.chromeStore.toggleContentManagementSidebar()};function ni(l,u){l.stores.chromeStore.chromeIsVisible=!0,l.stores.scopeStore.select(rr,{keepHistory:!1}),l.selection.set(u)}nt.openContentCollection=ni;function ii(l,u,m,f){l.stores.modalStore.set({type:"CreateComponent",source:u,onSuccess:h=>{if(Sj(h.name)||Sj(l.tree.getEntityRootNode()))return;let F=Na(l.tree,h.name,m??Yo);Br(l.tree,F,h.id),f?.(h)}})}nt.makeComponent=ii;function Ms(l){let u="Create Component";if(l.length!==1)return u;let m=l[0];return m&&lE(m)?"Convert Component":u}nt.makeComponentTitle=Ms;function Go(l,u){return Wg(l,u)}nt.canMakeComponent=Go;function ai(l,u){if(u.length!==1||Xt(l.stores.scopeStore.active))return;let m=u[0];m&&hi(m)&&uA.canMakeMaster(m)&&l.tree.current(m)?.set({isMaster:!0,replicaInfo:null,originalid:null})}nt.makeMaster=ai;function _s(l,u){for(let m of u)if(m.originalid&&hA(m)&&uA.overrideKeys(l,[m]).size>0)return!0;return!1}nt.canResetToMasterValues=_s;function Ds(l,u){for(let m of u){if(!m.originalid)continue;let h=uA.getReplicaForTemplateNode(l,m);h&&uA.resetOverrides(l,h,m)}}nt.resetToMasterValues=Ds;function si(l,u,m){for(let f of u){if(!hA(f))continue;let h=uA.getReplicaForTemplateNode(l,f);h&&uA.resetOverridesByProperty(l,h,f,m)}}nt.resetPropertiesToMasterValues=si;function Ay(l,u){if(u.length===0)return!1;for(let m of u){if(nj(m))return!1;if(wi(m)){let f=l.tree.getScopeNodeFor(m);if(!f)return!1;if(rA(f)){let{hover:h,pressed:F}=f.getGesturesForTopLevelVariant(m);return!(h||F)}return J(f)&&!GA(m)}if(QA(m))return!0}return!1}nt.canDetachFromMaster=Ay;function jy(l,u){let m=new Map;u.filter(QA).forEach(h=>{if(!ns(h,{allowVariants:!0}))return;let F=h.clone({parentid:null});F.replicaInfo=null,z7(F)&&(F.isVariant=void 0);for(let C of F.walk())C.originalid=null;E(h.id!==F.id),l.tree.insertNode(F);let y=l.tree.getParent(h.id)||l.stores.scopeStore.active,b=y.children.indexOf(h);l.tree.removeNode(h),l.moveNode(F.id,y.id,b),l.tree.current(F)?.set(F.constraintValues()),m.set(h.id,F.id)}),tt(l.tree,l.tree.root,m,!1);let f=l.selection.ids.map(h=>m.get(h)??h);return l.selection.set(f),m}nt.detachFromMaster=jy;function ey(l,u){if(!Mg(u))return;let m=cd(u);u.filter(ro).forEach(h=>h.set({visible:!m})),l.setHighlight(pj)}nt.visibility=ey;function Mg(l){return l.some(ro)}nt.visibilityEnabled=Mg;let cd=l=>l.every(u=>u.isVisible());function ty(l){return cd(l)?"Hide":"Show"}nt.visibilityTitle=ty;function ry(l,u){let m=l.withoutDescendants(u);if(!_g(m))return;let f=!dd(m),h=new Set;for(let F of m){if(!cr(F))continue;let y=F.cache.lockedByParent,b=f===y?void 0:f;F.set({locked:b});for(let C of F.descendants())h.add(C)}for(let F of h)cr(F)&&F.locked!==void 0&&F.set({locked:void 0})}nt.toggleLock=ry;function _g(l){return l.some(cr)}nt.toggleLockEnabled=_g;function dd(l){return l.some(u=>cr(u)&&yt(u))}function oy(l){return dd(l)?"Unlock":"Lock"}nt.toggleLockTitle=oy;function ny(l){return l.every(Xe)}nt.copyURLEnabled=ny;function iy(l){return l.length>0&&l.every(h=>pd(h))?`Remove ${l.length>1?"Viewboxes":"Viewbox"}`:`Remove ${l.length>0&&l.find(h=>!LA(h))===void 0?"Stack":"Frame"}${l.length>1?"s":""}`}nt.removeFrameTitle=iy;function ay(l,u){Dg(l,u)&&Lg(l,u)}nt.removeFrame=ay;function Dg(l,u){if(u.length===0)return!1;let m=l.stores.scopeStore.active.id;return u.every(f=>{if(!fA(f)&&!LA(f)&&!pd(f)||!f.children||f.children.length===0||vj(f)||QA(f)||jj(f)&&!je(f))return!1;let h=l.tree.getParent(f.id);if(!h)return!0;for(let F of f.children)if(!ht(l.tree,h,F,m,V))return!1;return!0})}nt.removeFrameEnabled=Dg;function pd(l){return SA(l)&&!Xe(l)}function sy(l,u){u.forEach(m=>{let f=l.getParentSizeInfo(m);if(m.intrinsicWidth!==null&&m.intrinsicHeight!==null){let h={width:m.intrinsicWidth,height:m.intrinsicHeight},F=h.width/h.height;if(Vo(m))m.set(am(m,h,{aspectRatio:F}),l);else if(Hr(m)&&m.aspectRatio){m=m.set({aspectRatio:null},l);let y=m.updateForSize(h,f);y.aspectRatio=F,m.set(y,l)}else m.set(m.updateForSize(h,f),l)}})}nt.resetToIntrinsicSize=sy;function So(l,u,m,f){let h=l.getRect(u),F=l.getOriginPoint(u),y=l.convertPointToCanvas(u,{x:h.width*F.x,y:h.height*F.y});if(f){let x=l.transformMatrixToNode(f),K=H6(f)?x:Bj.flatProjectionMatrix(x);y=Bj.convertPoint(K.inverse(),y)}let b={...h,x:y.x-h.width*F.x,y:y.y-h.height*F.y},C=u.updateForRect({rect:b,parentSizeInfo:l.getParentSizeInfo(u,f),constraintsLocked:!1,shouldGuessPinToBottom:f?jt(l,u,f):!0,shouldGuessPinToRight:Vj(l,u,f)});return LA(f)||(C.widthType===3&&(C.widthType=0,C.width=h.width),C.heightType===3&&(C.heightType=0,C.height=h.height)),Rt(u)&&(C.rotation=u.resolveValue("rotation")-wg(l,m,f)),f&&ie(f)&&!Zi(u)&&!Aa(u)&&(C.top=null,C.left=null,C.bottom=null,C.right=null),Object.assign(C,Xr(u,f)),C}nt.convertNodeToNewParentUpdate=So;function ly(l,u,m,f,h=-1,F){let{tree:y}=l,b=u;if(jj(u)&&(b=Ce(y,u),!b))return null;let C=f;if(f&&hA(f)&&(C=Ce(y,f),!C))return null;let D=m;if(m&&hA(m)&&(D=Ce(y,m),!D))return null;let x=So(y,F??b,jj(u)?D:m,jj(u)?C:f);if(l.tree.current(b)?.set(x),l.moveNode(b.id,C?C.id:l.stores.scopeStore.active.id,h),b.id!==u.id){E(m,"Current parent must exist when editing variants");let iA=uA.getReplicaForTemplateNode(y,m);E(iA,"The current parent should located in a variant node");let lA=f?uA.getReplicaForTemplateNode(y,f):null;if(iA.id===lA?.id){let EA=So(y,u,m,f);y.current(u)?.set(EA)}}return{originalNode:b,originalCurrentParent:D,originalNewParent:C}}nt.convertNodeToNewParent=ly;function kd(l,u){if(!_r(l)&&!yt(l)&&(u.push(l.id),!!l.children))for(let m of l.children)kd(m,u)}function ud(l,u){let m=new Set;return u.forEach(f=>{let h=l.getParent(f.id);h&&m.add(h.id)}),m}function cy(l,u){let m=l.withoutDescendants(l.getNodes(u));return ud(l,m).size>0}nt.canSelectAncestor=cy;function dy(l,u){md(l,u,"parent")}nt.selectParent=dy;function py(l,u){md(l,u,"groundNode")}nt.selectGroundNode=py;function md(l,u,m){let{tree:f}=l,h=f.withoutDescendants(f.getNodes(u)),F=null;if(m==="groundNode"){let b=new Set(h.map(C=>f.getGroundNodeFor(C).id));b.size>0&&(F=Array.from(b))}else{let b=ud(f,h);b.size>0&&(F=Array.from(b))}if(!F)return!1;l.selection.set(F,{sticky:!0,switchToLayers:!0});let y=h.length===1?h[0]:null;return y&&l.overlayStore.activeOverlays.has(y.id)&&l.overlayStore.exitEditMode(l.selection,!1),l.setHighlight(null),!0}nt.selectAncestor=md;function ky(l,u){let m=l.tree,f=[];if(l.tool.selectAll){l.tool.selectAll();return}else{let h=u.map(F=>{let y=m.get(F);if(JA(y)){let C=Am(m,y);return C&&m.isGroundNode(C)?C.id:pj}let b=m.getGroundFrameAncestor(F,!0);return b!==null?b.id:pj});if(new Set(h).size===1&&h[0]!==null){let F=h[0];f=m.getSubtreeNodes(F).filter(y=>yt(y)?!1:y.id!==F).map(y=>y.id)}if(f.length===0)for(let F of l.stores.scopeStore.active.children)kd(F,f)}l.selection.set(f)}nt.selectAll=ky;function uy(l,u){let m=new Set;for(let f of u){let h=l.tree.get(f);if(!h)continue;let F=l.tree.getSiblingsIncludingSelf(h);for(let y of F)m.add(y.id)}l.selection.set(m)}nt.selectAllSiblings=uy;function my(l,u){return l.tree.getNodes(u).some(m=>vA(m)&&m.children.length>0)}nt.canSelectChildren=my;function Ey(l,u){let m=new Set;for(let f of u){let h=l.tree.get(f);if(!h)continue;let F=zr(h);for(let y of F)m.add(y.id)}m.size>0&&l.selection.set(m)}nt.selectAllChildren=Ey;function fy(l,u){let m=u.length>0?l.tree.getNodes(u):l.stores.scopeStore.active.getGroundNodes(),f=[];m.map(b=>{bj(b)?f.push(...l.tree.getSiblingsIncludingSelf(b)):f.push(b)});let h=new Set,F=new Set,y=b=>{if(!h.has(b.id)){if(bj(b)&&F.add(b.id),b.children)for(let C of b.children)y(C);h.add(b.id)}};for(let b of f)y(b);l.selection.set(F)}nt.selectAllTextNodes=fy;function $y(l,u){let[m]=l.tree.getNodes(u);if(!m||!bj(m))return;let f=[],h=qA(m)?He(m.getTextStylePresets(!1)):void 0,F=He(m.getFonts(!1)),y=He(m.getFontSizes(!1).map(C=>Lo(C)?ut(...C):Z(C)?ut(C,"px"):C)),b=He(m.getTextColors(!1));if(!(mt(h)||Xj(h))&&!(mt(F)||Xj(F))&&!(mt(y)||Xj(y))&&!(mt(b)||Xj(b))){for(let C of l.stores.scopeStore.active.walk())ij(C)||!bj(C)||(qA(C)?He(C.getTextStylePresets(!1)):void 0)!==h||He(C.getFonts(!1))!==F||He(C.getFontSizes(!1).map(lA=>Lo(lA)?ut(...lA):Z(lA)?ut(lA,"px"):lA))!==y||He(C.getTextColors(!1))!==b||f.push(C);l.selection.set(f)}}nt.selectAllTextNodesWithSameFontStyles=$y;function By(l,u){let m=l.tree.getNodes(u);E(u.length===1,"Cannot have multiple layers selected");let[f]=m;if(!f||!fA(f))return;let h=[],y=X7(l.tree,f.id)??l.stores.scopeStore.active;for(let b of y.walk())fA(b)&&Ng(f,b,l.tree)&&h.push(b);l.selection.set(h)}nt.selectAllLayersWithSameFill=By;function Ng(l,u,m){if(Ft(l)&&!l.fillEnabled||Ft(u)&&!u.fillEnabled)return!1;let{fillType:f}=l;if(f!==u.fillType||f===void 0)return!1;switch(f){case"color":return!M(l.fillColor)||!M(u.fillColor)?!1:Bi.equals(Pl(l.fillColor,m,void 0),Pl(u.fillColor,m,void 0));case"linear-gradient":return l.fillLinearGradient&&u.fillLinearGradient?l.fillLinearGradient.equals(u.fillLinearGradient):!1;case"radial-gradient":return l.fillRadialGradient&&u.fillRadialGradient?l.fillRadialGradient.equals(u.fillRadialGradient):!1;case"conic-gradient":return l.fillConicGradient&&u.fillConicGradient?l.fillConicGradient.equals(u.fillConicGradient):!1;case"image":return l.fillImage===u.fillImage;default:cA(f)}}function Ed(l){return l.some(u=>ea(u)?jj(u)?!je(u):!1:!0)}function vr(l){let u={};return l.forEach(m=>{let f=m.parentid?m.parentid:qo,h=u[f];h||(h=[],u[f]=h),h.push(m)}),u}function fd(l,u,m){let f=l.tree;for(let h in u){let F=h===qo?f.root:f.get(h);if(!F||!u[h])continue;let y=f.sortVisually(u[h]);m==="back"&&y.reverse();let b=m==="front"?-1:0,C=ij(F)&&se(F);y.forEach(D=>{let x=D.originalid?f.get(D.originalid):D;E(x,"Cannot send",D.id,"backward/forward: original node must exist."),C&&ea(x)?P6(x.id,F,b):l.tree.moveNodeIndex(x,b)})}}function xg(l,u,m){let f=l.tree.getParent(m.id);if(!f)return null;let h=f.children.indexOf(m),F=u==="backward"?h-1:h+1,y=f.children[F];if(!y||!Ge(y))return null;let b=l.tree.convertFrameToCanvas(m),C=l.tree.convertFrameToCanvas(y);if(u==="backward")return{...b,y:C.y};let D=C.height-b.height;return{...b,y:C.y+D}}function Og(l,u,m){let f=xg(l,u,m);!f||w.containsRect(l.canvasStore.getCanvasVisibleRectTakingOverlaysIntoAccount(),f)||l.canvasStore.zoomToCenter(f,{zoom:l.canvasStore.zoom,maxZoom:.5,animated:!0})}function $d(l,u,m){let f=l.tree,h=Object.keys(u).length===1;for(let F in u){let y=F===qo?f.root:f.get(F);if(!y||!vA(y))continue;let b=ij(y)&&se(y),C=u[F],D=h&&C?.length===1,x=Ar(y)?y.getChildrenInVisualOrder():y.children,K=!1;for(let iA=0,lA=x.length;iA<lA;iA++){let EA=m===1?lA-iA-1:iA,gA=x[EA];if(!C?.includes(gA))K=!0;else if(K)if(b&&ea(gA))E(gA.originalid,"Cannot send nodes: nodes in a replica variant parent must have originalid."),P6(gA.originalid,y,EA+m);else{D&&Ka(f,gA)&&Og(l,m===-1?"backward":"forward",gA);let AA=gA.originalid?f.get(gA.originalid):gA,dj=y.originalid?f.get(y.originalid):y;E(AA,"Cannot send node",gA.id,": original child node does not exist."),E(dj,"Cannot send node",y.id,": original parent node does not exist."),l.moveNode(AA.id,dj.id,EA+m)}}}}function Bd(l,u,m){for(let f in u){let h=f===qo?l.root:l.get(f);if(!h||!vA(h))continue;let F=u[f],y=Ar(h)?h.getChildrenInVisualOrder():h.children,b=!1;for(let C=0,D=y.length;C<D;C++){let x=m===1?D-C-1:C,K=y[x];if(!F?.includes(K))b=!0;else if(b)return!0}}return!1}function wg(l,u,m){let f=0,h=0;return u&&(f=l.totalAncestorRotation(u)),m&&(h=l.totalAncestorRotation(m)),Math.round(h-f)}function gy(l){if(l.length!==1)return!1;let u=l[0];return u&&no(u)&&!u.originalid}nt.reversePathDirectionEnabled=gy;function hy(l,u){let m=l.current(u);m&&m.set({pathSegments:Tj.reverse(m.pathSegments)})}nt.reversePathDirection=hy;function Ry(l,u){let m=gn(u,l);return m.length===0?!1:m.every(f=>JA(f)&&!f.originalid&&zr(f).length>0)}nt.canUngroup=Ry;function Lg(l,u){if(u.length===0)return;let m=l.tree,f=m.sortVisually(gn(u,m)),h=m.withoutDescendants(f),F=[];return h.forEach(y=>{if(!vA(y))return;let b=y,C=null;if(jj(y)){if(b=Ce(m,y),!b)return;C=uA.getReplicaForTemplateNode(m,y)}let D=m.getParent(y.id);if(y.children.length>0){let x=m.getIndex(y),K=b?.id??y.id;[...zr(y)].forEach((lA,EA)=>{let gA=lA;if(jj(lA)&&(gA=Ce(m,lA),!gA))return;if(Kj(gA)){m.removeNode(gA);return}let RA=D,AA=RA;if(RA&&hA(RA)&&(AA=Ce(m,RA),!AA))return;let dj=nt.convertNodeToNewParentUpdate(m,gA,b,AA);if(l.moveNode(gA.id,AA?.id??null,x+EA,K),l.tree.current(gA)?.set(dj),K=gA.id,C){let IA=nt.convertNodeToNewParentUpdate(m,lA,y,RA);l.tree.current(lA)?.set(IA)}F.push(lA.id)}),l.deleteNode(b.id)}}),l.selection.set(F),F}nt.ungroup=Lg;function Iy(l){return!l.hasPreferredSize(V)}nt.canSetDefaultSize=Iy;function Fy(l,u){if(u.hasPreferredSize(V))return;let m=u.getPreferredSize(V),f={aspectRatio:null};m.width==="auto"?(f.width=1,f.widthType=2):Z(m.width)&&(f.width=m.width,f.widthType=0),m.height==="auto"?(f.height=1,f.heightType=2):Z(m.height)&&(f.height=m.height,f.heightType=0),$A(u)&&Z(u.top)&&Z(u.bottom)&&(f.bottom=null),$A(u)&&Z(u.left)&&Z(u.right)&&(f.right=null),$f(u,f,"context_menu_default_size_item"),u.set(f,l.tree)}nt.setDefaultSize=Fy;function qg(l,u){if(!l.stores.toolStore.isDefaultToolActive)return!1;let m=gn(u,l.tree);return m.length===0?!1:m.every(f=>JA(f)&&!f.originalid)}nt.canJoinInGroup=qg;function Gy(l,u){let m=l.tree;if(E(u.length>0,"No nodes"),!qg(l,u))return;let f=gn(u,m),h=m.sortVisually(m.withoutDescendants(f)),F=h[0],y=F?m.getParent(F.id):void 0,b=y?y.id:pj,C=F?m.getIndex(F):void 0,D=m.newId();l.createShapeGroup(b,{id:D},C),h.forEach(x=>{let K=nt.convertNodeToNewParentUpdate(m,x,m.getParent(x.id),y);l.moveNode(x.id,D),l.tree.current(x)?.set(K)}),l.selection.set(D)}nt.joinInGroup=Gy;function Sy(l,u){if(u.originalid)return null;let m={width:u.width,height:u.height},f=kf(u.svg,$a.createEmpty,m,u);if(f){f.name=u.name||u.originalFilename,f.parentid=u.parentid;let h=l.cloneNode(f),F=u.parentid===null,y=F?"rgb(255,255,255)":"transparent",{aspectRatio:b,...C}=u.constraintValues();l.tree.current(h)?.set({...C,width:f.width,height:f.height,fillEnabled:F,fillColor:y});let D=l.tree.getParent(u.id);if(D!==null&&vA(D)){let x=D.children.indexOf(u);l.moveNode(h.id,D.id,x)}return gd(l,h.id,m),l.deleteNode(u.id),h.id}return null}nt.convertSVGToShape=Sy;function gd(l,u,m){let f=l.tree.get(u);if(!SA(f))return;let h=f.width>=f.height?"width":"height",F=h==="width"?"height":"width",y=m[h]/f[h];if(y===1)return;e$(l,[f],y,t$(l,[f]),Kg(f));let b=l.tree.current(f);E(b,"Node must exist after scaling");let C=m[F]-b[F];if(C===0)return;b.set({[F]:m[F]});let D=F==="width"?"x":"y";for(let x of b.children){let K=l.tree.current(x);!K||!oa(K)||K.set({[D]:K[D]+C/2})}}nt.scaleVector=gd;function Kg(l){let u=l.constraints(),m=0,f=0;return u.top===!1&&u.bottom===!1?f=.5:u.top===!1&&(f=1),u.left===!1&&u.right===!1?m=.5:u.left===!1&&(m=1),{x:m,y:f}}function yy(l,u){if(u.length>1)return!1;let m=uA.getReplicaForTemplateNode(l,u[0]);if(!m)return!1;let f=uA.getMaster(l,m);if(_r(f))return!1;for(let h=0,F=u.length;h<F;h++){let y=u[h];if(uA.overrideKeys(l,[y]).size>0)return!0}return!1}nt.canUpdateMasterFromInstance=yy;function by({tree:l},u){function m(C,D){for(let x of["id","update","cache","children","mutable","parentid","originalid","isMaster","isVariant","isBreakpoint","replicaInfo","duplicatedFrom","gesture"])delete C[x];if(D)for(let x of uA.positionKeysToIgnore)delete C[x];return C}function f(C,D){let x;if(D)for(let K of uA.positionKeysToIgnore)C[K]!==void 0&&(x=x||{},x[K]=C[K]);return C.gesture&&(x||(x={}),x.gesture=C.gesture),x}let h=uA.getReplicaForTemplateNode(l,u[0]);if(!h)return;let F=uA.getMaster(l,h);if(_r(F))return;let y={...h.replicaInfo.overrides},b={...h.replicaInfo,overrides:y};for(let C=0,D=u.length;C<D;C++){let x=u[C];if(!x?.originalid)continue;let K=l.get(x.originalid),iA=m(x.raw(),QA(x));K?.set(iA);let lA=f(y[x.originalid]??{},QA(x));lA?y[x.originalid]=lA:delete y[x.originalid]}h.asDraft().replicaInfo=b}nt.updateMasterFromInstance=by;function Cy(l,u){let m=hd(l,u);return!m||_o(m)?0:e7(m)?2:1}nt.canGoToMaster=Cy;let hd=(l,u)=>{let m=null;for(let h=0,F=u.length;h<F;h++){let y=u[h],b=uA.getReplicaForTemplateNode(l,y);if(b){if(!m)m=b.originalid;else if(m!==b.originalid)return null}}if(!m)return null;let f=l.getNode(m);return!f||!vj(f)?null:f};function vy(l,u){if(u.length===1){let f=l.tree.getNode(u[0]?.originalid);if(!f)return;Rd(l,f);return}let m=hd(l.tree,u);m&&(uA.showMaster(l.tree,m),Rd(l,m))}nt.goToMaster=vy;function Rd(l,u){let m=l.tree.getScopeNodeFor(u),f=l.stores.scopeStore.active;vj(u)&&uA.showMaster(l.tree,u),m===null&&(l.moveNode(u.id,f.id),m=f),l.stores.scopeStore.select(m.id,{keepHistory:!1}),l.selection.set(u);let h=l.tree.convertFrameToCanvas(u);l.canvasStore.scrollToCenter(w.center(h))}nt.showNodeOnCanvas=Rd;function Ty(l,u){l.exitMode(),l.stores.modalStore.set({type:"CodeFileCreation",source:"main_menu",creationType:"Component",parentId:u})}nt.createCodeComponent=Ty;function Py(l){l.exitMode(),l.stores.modalStore.set({type:"CodeFileCreation",source:"main_menu",creationType:"Override"})}nt.createCodeOverride=Py;function My(l,u,m,f,{gesture:h,overrides:F,overrideSize:y,variantName:b,viewportHeight:C,selectAndCenter:D=!0}={}){h&&E(wi(m),"gesture variant should inherit from top level variant");let x=u.getPrimaryVariant(),K=null;if(!h){let EA=new Set(u.getTopLevelVariants().map(gA=>gA.name??""));b?K=Pj(b,EA):K=Pj(GA(m)?"Breakpoint":"Variant",EA,{startIndex:EA.size+1,omitCountIfFirst:!1})}if(F||(F=h?void 0:m.replicaInfo?.overrides),K&&GA(m)){let EA=$E(l,K,m);EA&&(F?F=Zt(EA,F):F=EA);let gA={};m.children.forEach(RA=>{if(!se(RA)||$A(RA)&&RA.widthType===2||!(RA.originalid?l.tree.getNode(RA.originalid):RA))return;let dj=l.tree.getRect(RA);xl(l.tree,RA,dj,m,f.width,gA)}),F||(F={}),F=Zt(F,gA)}let iA=uA.create(l.tree,x,{overrides:F,inheritsFrom:h?m.id:void 0,duplicatedFrom:Qo(m)});if(l.stores.scopeStore.insertNode(iA,u.id,-1),!iA)return;let lA={top:f.y,left:f.x,gesture:h,isBreakpoint:Kr(u)?!0:void 0,name:K};if(C&&(lA.viewportHeight=C),y&&(lA.width=f.width,lA.widthType=0,GA(iA)||(lA.height=f.height,lA.heightType=0)),iA.set(lA),rA(u)){let EA=ga(h)?"variant":h??"variant";Km({variantId:iA.id,variantType:EA,componentId:u.id})}else GA(iA)&&BA("breakpoint_create",{scopeId:u.id,breakpointId:iA.id,width:iA.width});return D&&(l.selection.set(iA.id),l.canvasStore.scrollToCenter(w.center(f))),iA}nt.createVariant=My;function Vg(l,u){return l.filter(m=>sa(m)?zk(m)!==u:ve(m)?oE(m)!==u:!0)}function _y(l,u,m){for(let f of u.walk()){let h=da(f);for(let[F,y]of Object.entries(h)){let b=Vg(y,m);if(b.length!==y.length){if(Ie(f))l.tree.current(f)?.set({[F]:b});else if(z(f)){let C={type:"eventhandler",value:b};l.tree.current(f)?.set({[F]:C})}}}}}nt.removeActionsWithTarget=_y;function Dy(l,u){let m=l.tree.getParent(u.id)||l.stores.scopeStore.active;if(hA(m))return!1;let f=l.stores.treeStore.getPartialIndexes();return u.codeComponentIdentifier in f.localSmartComponentNameByIdentifier}nt.canDetachVariantInstance=Dy;function Ny(l,u,m,f){if(!m)return null;let h={...xa(u,V),...Df(u)},F=new Map;m.getTopLevelVariants().forEach(IA=>F.set(IA.id,IA));let y=M(h.variant)&&F.get(h.variant)||m.getPrimaryVariant();E(fA(y),"Variant must be a frame node");let b=l.tree.getParent(u.id)||l.tree.getScopeNodeFor(u)||l.stores.scopeStore.active;if(hA(b))return null;let C=new Map,D=Cn(y,new Map,new Map,C);C.set(u.id,D.id);let x=l.tree.getScopeNodeFor(b);if(J(x)||rA(x)){let IA=x.getTopLevelReplicaVariants();for(let kA of IA){let MA=ee(kA.id,u.id),wA=l.tree.getNode(MA);if(!wA||!z(wA))continue;let ue=wA.getResolvedControlPropValues(V).variant;if(!M(ue))continue;if(f){let wj=f.get(ue);wj&&(ue=wj)}let mj=M(ue)?F.get(ue):void 0;if(!mj||!fA(mj)||!CA(mj))continue;let it=uo(Mf(mj,l.tree,wA,m.id),C),Pe={},Oj=C.get(y.id)??y.id;if(Jo(mj)){let wj=uo(mj.replicaInfo.overrides,C,!0);Object.assign(Pe,{...wj,[Oj]:_f(wj[Oj]??{})})}let Lt=Zt(it,Pe);if(Jo(mj)){let{opacity:wj,rotation:yo}=kA.replicaInfo.overrides?.[u.id]||{};rs(Lt[Oj]??{},{opacity:wj,rotation:yo})}else if(kA.replicaInfo.overrides?.[u.id]){let{opacity:wj,rotation:yo}=mj;rs(kA.replicaInfo.overrides[u.id]??{},{opacity:wj,rotation:yo})}let ZA={};wA.heightType===2&&(ZA.heightType=mj.heightType,ZA.height=mj.height),wA.widthType===2&&(ZA.widthType=mj.widthType,ZA.width=mj.width),l.tree.current(kA)?.set({replicaInfo:{...kA.replicaInfo,overrides:Zt({...kA.replicaInfo.overrides,[u.id]:{}},{...Lt,[Oj]:{...kA.replicaInfo.overrides[u.id],...Lt[Oj],...ZA}})}})}}let K=La(l.tree,u,D,b);rs(K,{opacity:pA(y.opacity)?h[y.opacity.id]:y.opacity,rotation:pA(y.rotation)?h[y.rotation.id]:y.rotation});let iA=u.constraintValues(),lA=y.constraintValues();iA.widthType===2&&lA.widthType!==2&&(iA.widthType=lA.widthType),iA.heightType===2&&lA.heightType!==2&&(iA.heightType=lA.heightType),D.set({...iA,...K,...b?$t(u):void 0,isVariant:!1,isMaster:!1,gesture:void 0,replicaInfo:null,originalid:null,name:u.name??At(u)});let EA=vu(m),gA=new Map([...EA??[],...Object.entries(h)]),RA=new Map;RA.set(m.id,gA);let AA={};for(let IA of D.walk()){if(IA.originalid=null,Xk(IA))for(let[kA,MA]of Object.entries(IA.getActions(V)))MA&&IA.set({[kA]:MA.filter(wA=>Ki(wA)||qi(wA))});if(gA.size>0){let kA=ua(l.tree,m.id,IA,RA,AA);kA&&IA.set(kA)}}E(D.id!==y.id);let dj=b.children.indexOf(u);l.tree.insertNode(D,b.id,dj);for(let IA of u.children)Kj(IA)&&l.tree.moveNode(IA,AA[IA.id]??D.id);return tt(l.tree,b,C,Kj(b)||Qi(b)),l.deleteNode(u.id),$j(D)&&l.overlayStore.showOverlay(l.selection,D,D.parentid),D}nt.detachSmartComponentOrWebPageInstance=Ny;function xy(l){Jg(l,{openLibrary:!0})}nt.toggleTeamLibrary=xy;function Jg(l,{openLibrary:u}={}){let{modalStore:m,popoverStore:f}=l.stores;m.active.type==="QuickActions"?m.dismiss():(l.cancelTool(),f.active=0,m.set({type:"QuickActions",source:"main_menu",initialCategory:u?{type:"TeamLibraryCategory"}:void 0}),u?BA("ui_interaction",{page:"main-menu",id:"team-library"}):BA("ui_interaction",{page:"main-menu",id:"quick-actions"}))}nt.toggleQuickActions=Jg;function Oy(l){return!!GA(l)}nt.canCreateBreakpoint=Oy;function wy(l,u,m,f,h){let{modalStore:F}=l.stores;F.active.type!=="CustomBreakpoint"&&(l.cancelTool(),F.set({type:"CustomBreakpoint",actionType:u,baseNodeId:m,name:f,width:h,source:"undefined"}))}nt.showCustomBreakpointModal=wy;function Ly(l,u,m,f,h,F,y,b){let C={...f,width:h};nt.createVariant(l,m,u,C,{overrideSize:!0,variantName:F,viewportHeight:y,selectAndCenter:b})}nt.createBreakpoint=Ly;function Hg(l){return l.some(u=>u!==l&&vj(u))}nt.containsMaster=Hg;function Qg(l){return fA(l)||xr(l)||SA(l)||bj(l)||B7(l)||g7(l)||h7(l)}nt.nodeTypeCanBePrimaryVariantSource=Qg;function Ug(l,u){return!(!Qg(u)||pE(l,u)||CA(u)||QA(u)||vj(u)||Hg(u))}nt.canConvertNodeToSmartComponentPrimaryVariant=Ug;function Wg(l,u){let m=u.length;if(m===0)return!0;let f=u[0];return E(f,"node must be defined",u),m===1&&Ug(l.tree,f)}nt.canMakeSmartComponent=Wg;function zg(l,u){if(u.length!==1)return!1;let f=u[0];if(E(f,"node must be defined",u),!fA(f)||hA(f))return!1;let h=l.tree.get(f.parentid);return qj(h)}nt.canMakeWebPagePrimaryBreakpoint=zg;function qy(l,u){if(!zg(l,u))return;let m=u[0];E(m,"node must be defined",u),l.createWebPage({primaryBreakpointId:m.id,shouldRemovePanelOverrides:!1})}nt.convertNodeToWebPagePrimaryBreakpoint=qy;function Ky(l){if(l.length>1)return!1;let u=l[0];return E(u,"node must be defined",l),!Ru(u)&&!qA(u)?!1:!kE(u)}nt.canAddLink=Ky;function Vy(l,u,m="Template",f,h){let F=new pe({...Tt,...QI(f),isMaster:!0,isVariant:!0,isBreakpoint:!0,widthType:0,heightType:0,width:f?.width??1200,name:f?.name??"Desktop"}),y=new em;F.addChild(y);let b=Pj(m,UI(l)),C=new Pu({baseVariantId:F.id,name:b});E(C.isLoaded(),"A newly created LayoutTemplateNode must be loaded."),C.addChild(F),l.latestTree().insertNode(C);let D=Na(l,b,h??Zo);return Br(l,D,C.id),BA("layout_template_create",{source:u}),C}nt.createLayoutTemplate=Vy;function Jy(l,u,m=!0,f=null,h=kj(),F="context_menu",y=0){let b=new el({name:u,id:h});if(E(b.isLoaded(),"A newly created VectorSetNode must be loaded"),l.tree.latestTree().insertNode(b),Br(l.tree,f??Wr,b.id),m)for(let D of ZI())l.tree.latestTree().insertNode(D,b.id);let C=l.tree.current(b);return E(C,"A newly created VectorSetNode must exist"),l.codeGenerationStore.createVectorSet(C.getVectorSetItems()),BA("vector_set_create",{source:F,items:m?3:y}),b}nt.createVectorSet=Jy;async function Hy(l,u,m){let f=l.tree.get(m);if(!Ae(f))return;let h=f.isLoaded()?f:await f.load();if(!h)return;let F=h.children.find(Xe);if(!Xe(F))return;let y=l.tree.getRect(F);l.process(()=>{let b=c$(l,u),C=[],D=Ft(F)?{fillEnabled:F.fillEnabled,fillType:F.fillType,fillColor:F.fillColor}:void 0;for(let x of b){let K=l.tree.get(x);if(!K)continue;let iA=l.tree.getIndex(K),lA=$n(l.tree,h,K,y,y.width),EA=l$(K,lA,D);if(Xe(EA)){if(l.tree.insertNode(EA,h.id),C.push(EA),gd(l,EA.id,y),BA("vector_set_item_create",{source:"context_menu"}),m!==l.stores.scopeStore.active.id){let gA=new pr({...d$(K),codeComponentIdentifier:Kt("vector",EA.id,"default").value,width:K.width,height:K.height,widthType:0,heightType:0,slotsAreChildNodes:zA.isOn("componentSlotsAreChildNodes"),name:K.name});l.tree.insertNode(gA,K.parentid,iA)}l.tree.removeNode(K)}}C.length!==0&&(l.stores.scopeStore.select(f.id,{keepHistory:!1}),l.selection.set(C),l.stores.chromeStore.layersExpanded=!0,l.stores.chromeStore.contentPanelTab="Layers",l.codeGenerationStore.createVectorSet(C))})}nt.addToVectorSet=Hy;function Qy(l,u,m="Icon Set",f="context_menu"){let h=new el({name:m});E(h.isLoaded(),"A newly created VectorSetNode must be loaded");let F=c$(l,u),y=0,b=[];for(let C of F){let D=l.tree.get(C);if(!D)continue;let x=l.tree.getRect(D),K=l$(D,{x:y,y:0});if(!Xe(K))continue;let iA=l.tree.getIndex(D);b.push(K),h.addChild(K),y+=x.width*2;let lA=new pr({...d$(D),codeComponentIdentifier:Kt("vector",K.id,"default").value,width:D.width,height:D.height,widthType:0,heightType:0,slotsAreChildNodes:zA.isOn("componentSlotsAreChildNodes"),name:D.name});l.tree.insertNode(lA,D.parentid,iA),l.tree.removeNode(D)}l.tree.latestTree().insertNode(h),Br(l.tree,Wr,h.id),l.codeGenerationStore.createVectorSet(b),l.stores.scopeStore.select(h.id,{keepHistory:!1}),l.selection.set(b),l.stores.chromeStore.layersExpanded=!0,l.stores.chromeStore.contentPanelTab="Layers",BA("vector_set_create",{source:f,items:F.size})}nt.createVectorSetFromNodes=Qy;function Uy(l,u,m,f,h){let F=m.clone({children:[],name:"Vector"});l.stores.scopeStore.insertNode(F,u.id),E($A(F),"Vector must be pinnable."),F.set({top:f.y,left:f.x}),l.codeGenerationStore.createVectorSet([F]),l.selection.set(F.id),l.canvasStore.scrollToCenter(w.center(f)),BA("vector_set_item_create",{source:h})}nt.createVectorSetItem=Uy})(kc||={});var Tt={height:Tu,left:0,top:0,layout:"stack",stackDirection:"vertical",stackAlignment:"center",stackDistribution:"start",stackWrapEnabled:!1,gap:0,padding:0,paddingPerSide:!1,paddingLeft:0,paddingBottom:0,paddingTop:0,paddingRight:0,overflow:Fe()};function QI(A){if(!A||!ge(A)||!Ye(A)||!Ft(A))return;let j=Yr(A);return{gap:A.resolveValue("gap")??Tt.gap,padding:j.perSide?Tt.padding:j.top,paddingPerSide:j.perSide??Tt.paddingPerSide,paddingLeft:j.left??Tt.paddingLeft,paddingBottom:j.bottom??Tt.paddingBottom,paddingTop:j.top??Tt.paddingTop,paddingRight:j.right??Tt.paddingRight,fillEnabled:A.resolveValue("fillEnabled"),fillType:A.resolveValue("fillType"),fillColor:A.resolveValue("fillColor"),fillLinearGradient:A.resolveValue("fillLinearGradient"),fillRadialGradient:A.resolveValue("fillRadialGradient"),fillConicGradient:A.resolveValue("fillConicGradient"),fillImage:UA(A.fillImage)?void 0:A.fillImage,fillImageOriginalName:A.resolveValue("fillImageOriginalName"),fillImageResize:A.resolveValue("fillImageResize"),fillImagePixelWidth:A.resolveValue("fillImagePixelWidth"),fillImagePixelHeight:A.resolveValue("fillImagePixelHeight"),fillImagePositionX:A.resolveValue("fillImagePositionX"),fillImagePositionY:A.resolveValue("fillImagePositionY"),fillImageTileSize:A.resolveValue("fillImageTileSize")}}function UI(A){let j=new Set;return A.root.children.forEach(e=>{!oj(e)||!e.name||j.add(e.name)}),j}function k$(A){return!(qr(A)||Ti(A)||we(A))}function pc(A){return!(nj(A)||Ti(A)||we(A)||jj(A))}function WI(A){return je(A)&&A.isVisible()?!0:pc(A)}function s$(A){return k$(A)?jj(A)?je(A):!0:!1}function Mn(A,j){if(Dj(j)){let e=lr(A.tree,j.dataIdentifier);if(e)return e.id}return null}function zI(A,j,e){if(e){let r=Mn(A,e);if(r)return r;for(let o of e.ancestors()){let n=Mn(A,o);if(n)return n}}let t=Mn(A,j);if(t)return t;if(e)for(let r of e.walk()){let o=Mn(A,r);if(o)return o}for(let{node:r,skipChildren:o}of j.walkWithSkipChildren())if(e&&r.id===e.id)o();else{let n=Mn(A,r);if(n)return n}return null}function l$(A,{x:j,y:e},t){if(JA(A)){let r=new ur({...t,isVectorSetItem:!0,width:A.width,height:A.height,left:j,top:e,name:A.name}),o=A.clone({x:0,y:0});return r.addChild(o),r}return A.clone({...t,isVectorSetItem:!0,left:j,top:e})}function c$(A,j){return new Set(j.map(e=>{if(!e)return null;if(SA(e))return e.originalid??e.id;let t=A.tree.getAncestorThatMatches(e,o=>XI(A,o),!0,!0);if(!t)return null;let r=A.tree.getNodeParent(t);return r&&SA(r)?r.originalid??r.id:t.originalid??t.id}))}function XI(A,j){return JA(j)&&A.tree.isRootVectorNode(j)}function d$(A){return $A(A)?{top:A.top,bottom:A.bottom,left:A.left,right:A.right,centerAnchorX:A.centerAnchorX,centerAnchorY:A.centerAnchorY,constraintsLocked:A.constraintsLocked}:{top:A.y,left:A.x}}var YI="rgb(0, 153, 255)",cc={fillType:"color",fillColor:YI,fillEnabled:!0},dc={isVectorSetItem:!0,top:0,width:40,height:40,autoSize:!1},ZI=()=>{let A=new nl({...cc,x:-3,y:-3,width:46,height:46,polygonSides:3,centered:!0,radius:1}),j=new nl({...cc,x:0,y:0,width:40,height:40,polygonSides:4,centered:!0,radius:1}),e=new rm({...cc,x:2,y:2,width:36,height:36}),t=new ur({...dc,name:"Triangle"});t.addChild(A);let r=new ur({...dc,left:80,name:"Diamond"});r.addChild(j);let o=new ur({...dc,left:160,name:"Oval"});return o.addChild(e),[t,r,o]};function ss(A){let j={},e=A.getPresetsListNode();if(!e)return j;for(let t of e.children)if(!QA(t)){if(ct(t)){let r=Nu(t.tag);j[r]??=t.id;continue}if(dt(t)){j.stylePresetLink??=t.id;continue}if(pt(t)){j.stylePresetInlineCode??=t.id;continue}if(vi(t)){j.stylePresetImage??=t.id;continue}if(I7(t)){j.stylePresetBlockquote??=t.id;continue}if(Ci(t)){j.stylePresetTable??=t.id;continue}if(Or(t)){let r=Ho(t.componentIdentifier);j[r]??=t.id;continue}cA(t)}return j}function EJ(A,j){let e=ss(A),t={};for(let r in e){let o=j[r];A.get(o)||(t[r]=e[r])}Object.keys(t).length>0&&j.set(t)}function fJ(A,j,e="",t={}){let r=document.createElement(j);r.innerText=e;let o=Ea(A,j);if(o)tp(r,o.id);else{let n=uk[j],a=n.fontSize,i;_7(a)?i=Mi(a):Z(a)&&(i=[a,"px"]),jp(r.style,Ap.transforms,{...n,fontSize:i})}return new Wu({html:r.outerHTML,...ss(A),...t})}function u$(A,j,e,t){let r=`${t}/${e.segment}`;A.add(r);for(let o of e.children)u$(A,j,o,r)}function m$(A){let j=new Set,e=Ur(A);if(!e)return j;for(let t of e.children)u$(j,A,t,"");return j}function E$(A){A=[...A].sort((e,t)=>e[0]-t[0]||e[1]-t[1]);let j=[];for(let e of A){if(e[0]===e[1])continue;let t=j[j.length-1];if(!t){j.push(e);continue}if(e[0]<=t[1]){t[1]<e[1]&&(t[1]=e[1]);continue}j.push(e)}return j}function f$(A,j){let e=[],t=0;for(let[r,o]of A){if(r<=t){t=o;continue}e.push([t,r]),t=o}return j!==void 0&&t<j&&e.push([t,j]),e}var AF=/\/+/gu,jF=/\/{2,}/gu,eF=new RegExp(`-?${o7}-?`,"g"),tF=/\s+/gu,rF=/[?#[\]@!$&'()*+,;="<>%{}|\\^`]/gu;function oF(A){return A.startsWith("/")?A:"/"+A}function nF(A){return A.replace(jF,"/")}function iF(A){return A.toLowerCase().replaceAll(rF,"").replaceAll(tF,"-")}function ls(A){let j=aF(A,AF,eF),e=f$(j,A.length);return A.startsWith("/")?A=$$(A,e,iF):A=$$(A,e,v7),A=oF(A),A=nF(A),A}function aF(A,...j){let e=[];for(let t of j)for(let r of A.matchAll(t))E(r.index!==void 0),e.push([r.index,r.index+r[0].length]);return E$(e)}function $$(A,j,e){let t="",r=0;for(let[o,n]of j)o>r&&(t+=A.substring(r,o)),t+=e(A.substring(o,n)),r=n;return r<A.length&&(t+=A.substring(r)),t}var B$=":missing-slug";function uc(A,j){if(!j)return"/unknown";let e=V.dataForIdentifier(A);if(!e)return j;let t=e.properties;if(!t)return j;let r=new Set(Object.keys(t)),o=0,n=j.replace(Ri,(i,s)=>{if(o++,r.has(s))return i;for(let[d,p]of Object.entries(t))if(s.toLowerCase()===(p?.title??d).toLowerCase())return`:${d}`;let c=e.annotations?.framerSlug;return c?`:${c}`:B$});if(o>0)return n;n.endsWith("/")||(n+="/");let a=e.annotations?.framerSlug;return a?n+`:${a}`:n+B$}function sF(A){if(Xi(A.tree)){let j=m$(A.tree),e=new Set(A.stores.scopeStore.getWebPageNodesWithCollection().map(t=>ye(A.tree,t)).filter(M));return new Set([...j,...e])}return new Set(A.stores.scopeStore.getWebPageNodes().map(j=>ye(A.tree,j)).filter(M))}function lF(A){let j=A.split("/"),e=j[j.length-1];return e?aa(e):!1}var mc=(A,j,e,t=!1)=>{A=ls(A);let r=sF(j),o=j.tree.root.homePageNodeId,n=!!e&&e.id===o;A==="/"&&!n&&(A="/page"),e?.dataIdentifier&&(A=uc(e.dataIdentifier,A));let a=A.endsWith("/")&&!n,i=A;a&&(i=A.slice(0,-1));let s=ye(j.tree,e);return r.has(A)&&(t||A!==s)&&(r.add(i),lF(i)&&(i+="/copy"),i=Pj(i,r,{withDash:!0})),{path:a?`${i}/`:i,suggestedName:mo(A)}};var rt=Fj(Mr()),g$="dismissedInstantNPMToast",h$="showedInstantNPMToast",R$="instant-npm-toast",qJ=()=>window.localStorage.getItem(h$)==="true",I$=()=>window.localStorage.getItem(g$)==="true";function cF(){return(0,rt.jsxs)(rt.Fragment,{children:[(0,rt.jsx)(al,{children:"You installed an external NPM library."}),(0,rt.jsxs)("a",{href:"https://www.framer.com/developers/#faq",target:"_blank",children:[" ",(0,rt.jsx)(al,{children:"Learn More"})]})]})}function F$(){window.localStorage.setItem(h$,"true"),TA({type:"add",variant:"info",text:(0,rt.jsx)(cF,{}),key:R$,duration:1/0,action:{title:"Dismiss",onClick:()=>window.localStorage.setItem(g$,"true")}})}function KJ(){TA({type:"remove",key:R$})}function dF(A){if(A.length>=255)throw new TypeError("Alphabet too long");let j=new Uint8Array(256);for(let s=0;s<j.length;s++)j[s]=255;for(let s=0;s<A.length;s++){let c=A.charAt(s),d=c.charCodeAt(0);if(j[d]!==255)throw new TypeError(c+" is ambiguous");j[d]=s}let e=A.length,t=A.charAt(0),r=Math.log(e)/Math.log(256),o=Math.log(256)/Math.log(e);function n(s){if(s instanceof Uint8Array||(ArrayBuffer.isView(s)?s=new Uint8Array(s.buffer,s.byteOffset,s.byteLength):Array.isArray(s)&&(s=Uint8Array.from(s))),!(s instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(s.length===0)return"";let c=0,d=0,p=0,k=s.length;for(;p!==k&&s[p]===0;)p++,c++;let $=(k-p)*o+1>>>0,g=new Uint8Array($);for(;p!==k;){let S=s[p],T=0;for(let v=$-1;(S!==0||T<d)&&v!==-1;v--,T++)S+=256*g[v]>>>0,g[v]=S%e>>>0,S=S/e>>>0;if(S!==0)throw new Error("Non-zero carry");d=T,p++}let G=$-d;for(;G!==$&&g[G]===0;)G++;let I=t.repeat(c);for(;G<$;++G)I+=A.charAt(g[G]);return I}function a(s){if(typeof s!="string")throw new TypeError("Expected String");if(s.length===0)return new Uint8Array;let c=0,d=0,p=0;for(;s[c]===t;)d++,c++;let k=(s.length-c)*r+1>>>0,$=new Uint8Array(k);for(;c<s.length;){let S=s.charCodeAt(c);if(S>255)return;let T=j[S];if(T===255)return;let v=0;for(let P=k-1;(T!==0||v<p)&&P!==-1;P--,v++)T+=e*$[P]>>>0,$[P]=T%256>>>0,T=T/256>>>0;if(T!==0)throw new Error("Non-zero carry");p=v,c++}let g=k-p;for(;g!==k&&$[g]===0;)g++;let G=new Uint8Array(d+(k-g)),I=d;for(;g!==k;)G[I++]=$[g++];return G}function i(s){let c=a(s);if(c)return c;throw new Error("Non-base"+e+" character")}return{encode:n,decodeUnsafe:a,decode:i}}var G$=dF;var Ec="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz",pF=G$(Ec),kF=8/Math.log2(62),QJ=A=>pF.encode(A).padStart(Math.ceil(A.length*kF),"0"),_n=(A=20)=>Array(A).fill(0).map(()=>Ec[Math.floor(Math.random()*Ec.length)]).join("");var S$="https://app.framerstatic.com/framer_compiler_bg-UTRYLQ4Z.wasm";var ot=mA("compiler");async function aH(){await Nn()}function y$(A){return{code:`const err = new Error(${JSON.stringify(String(A))}); err.name = "CompilationError"; throw err;`,sourceMap:void 0,annotations:{},exportedNames:[],reExportedModules:[],imports:{absolute:[],relative:[],bare:[]}}}function b$(A,j,e){let t={...j.exports};e&&(t.__FramerMetadata__={type:"variable"},A=A.concat(`
export const __FramerMetadata__ = `,JSON.stringify({exports:t})));let r=Object.entries(t).filter(([,n])=>n.type!=="tsType").map(([n])=>n),o={};for(let[n,a]of Object.entries(j.exports))a.annotations&&(o[n]=a.annotations);return{moduleCode:A,annotations:o,exportedNames:r}}async function C$({localId:A,name:j,source:e,includeSourceMap:t=!0}){let r=await Nn();try{let{code:o,metadata:n,map:a}=await r.transformSync(e,{fileName:Qj(j).source,framerContractVersion:1,mediaType:"tsx",minify:!1,compress:!1,mangle:!1,sourceMap:t,useReactRefresh:!0}),i=`
if (!window.$RefreshReg$) throw new Error("React refresh preamble was not loaded. Something is wrong.");
const prevRefreshReg = window.$RefreshReg$;
const prevRefreshSig = window.$RefreshSig$;
window.$RefreshReg$ = window.reactRefreshRuntime.getRefreshReg("${A}");
window.$RefreshSig$ = window.reactRefreshRuntime.createSignatureFunctionForTransform;

${o}

window.$RefreshReg$ = prevRefreshReg;
window.$RefreshSig$ = prevRefreshSig;`,{moduleCode:s,annotations:c,exportedNames:d}=b$(i,n,!0);return{code:s,sourceMap:a??void 0,imports:n.requestedModules,annotations:c,exportedNames:d,reExportedModules:n.reExportedModules}}catch(o){let n=`Failed to compile development module ${j}: ${o}`;return ot.debug(n,"(enable trace logging to see full source)"),ot.trace(e),A.startsWith("codeFile/")||(ot.reportCriticalError(new Error(n),{moduleName:j,moduleSource:e}),BA("application_error",{message:n,area:"compiler"})),y$(o)}}async function sH(A,j){await(await Nn()).transformSync(j,{fileName:Qj(A).source,framerContractVersion:1,mediaType:"tsx",minify:!0,compress:!1,mangle:!1,sourceMap:!1,useReactRefresh:!1})}async function v$({name:A,source:j,type:e,includeSourceMap:t=!0,addFramerMetadata:r=!0,telemetrySession:o}){let n=_n(10),a=`compile-${A}-${n}`,i=`\u{1F4DD} Compile ${A}`;ot.debug("Compiling module",A,"; with source map:",t),pn(a);let s=await Nn(),c=o?.start("transform"),d=e==="collection";try{let{code:p,map:k,metadata:$}=await s.transformSync(j,{fileName:Qj(A).source,framerContractVersion:1,mediaType:"tsx",minify:!0,compress:d,mangle:d,sourceMap:t,useReactRefresh:!1}),{moduleCode:g,annotations:G,exportedNames:I}=b$(p,$,r);return{code:g,sourceMap:k??void 0,imports:$.requestedModules,annotations:G,exportedNames:I,reExportedModules:$.reExportedModules}}catch(p){let k=`Failed to compile module ${A}: ${p}`;return ot.debug(k,"(enable trace logging to see full source)"),ot.trace(j),A.startsWith("codeFile/")||(ot.reportCriticalError(new Error(k),{moduleName:A,moduleSource:j}),BA("application_error",{message:k,area:"compiler"})),y$(p)}finally{c?.end(),P$(i,a)}}async function T$(A){let e=`analyze-imports-${_n(10)}`,t="\u{1F575}\u{1F3FB} Analyze Imports";pn(e);try{return{ok:!0,value:await(await Nn()).analyzeImports(A)}}catch(r){return ot.warn("Failed to analyze imports:",r),r instanceof Error?{ok:!1,error:r}:{ok:!1,error:new Error(`${r}`)}}finally{P$(t,e)}}var cs;async function Nn(){if(!cs){let A=new Worker(yk("./modulesCompilerWorker.js")),j=Gk(A);cs=j.initWithPathToWasm(S$).then(()=>({transformSync:j.transformSync,analyzeImports:j.analyzeImports})),cs.catch(()=>{if(km()||!bd.isProduction)throw new Error(`\u274C Your dev setup is struggling to run the compiler\u2019s WASM binary.
To fix it, run "make clean" followed by "make dev".`)})}return cs}function P$(A,j){ha(A,j),performance.getEntriesByName(A,"measure").forEach(({name:e,duration:t})=>{ot.debug(e,"took",t.toFixed(2),"ms"),gm(e)}),Ra(j)}function M$(A,j){if(!z(A))return;let e=A.getSupportedLayout(V),t=A.getCurrentVariantSize(V);Ks(e.width)&&t?.widthType!==0&&(j.widthType=2,j.left!==null&&j.right!==null&&(j.right=null)),Ks(e.height)&&t?.heightType!==0&&(j.heightType=2,j.top!==null&&j.bottom!==null&&(j.bottom=null))}function _$(A,j,e=!0){A.processWhenReady(()=>{A.stores.scopeStore.selectByNode(j.id),A.selection.set(j.id);let t=A.tree.get(j.cache.overlayAncestorId);if(Kj(t)?A.overlayStore.showOverlay(A.selection,t,t.parentid):A.overlayStore.hideAll(),e){let r=A.tree.getBoundingFrameForNodes([j]);A.canvasStore.zoomToCenter(r,{animated:A.stores.persistedUserDefaults.animateOnZoom,maxZoom:1})}})}var Fr=class extends Error{constructor(e,t,r,o=!1){super(e);this.missing=t;this.error=r;this.wasTimeout=o}};function fH(A){return A instanceof Fr}var fc=mA("ensureComponentsInLoader"),mF=500,EF=30*1e3;async function ds(A,j,e,t){let r=D$(j,A).length;if(r===0)return;let o=t??EF+r*2e3;fc.debug("modules:",j.length,", new:",r,", timeout:",o),await fF(A,e,o);let n=D$(j,A);if(n.length===0)return;let a=$F(j,A);throw fc.debug("components loaded, but some are missing",{missing:n,errors:a}),new Fr("ensureComponentsInLoader: Some modules are missing.",n,a)}async function fF(A,j,e){let t=performance.now(),r=await BF(async()=>(await xs(e),"timeout"),async()=>{await j.whenIdle();let o=j.revision;return E(o>=0,"moduleStore.revision cannot be negative"),await j.loadAllLocalModules(),o});if(r==="timeout")throw new Fr("ensureComponentsInLoader: Modules store not ready in time.",[],[],!0);for(let o=0;o<1e3;o++){let n=A.modulesRevision;if(r<=n)break;if(performance.now()-t>e)throw fc.debug("component loader not updated in time: want:",r,"got:",n),new Fr("ensureComponentsInLoader: Component loader not updated in time.",[],[],!0);await xs(mF)}}function D$(A,j){let e=new Set;for(let t of A)j.componentForIdentifier(t)||e.add(t);return Array.from(e)}function $F(A,j){let e=new Set;for(let t of A)Sj(j.errorForIdentifier(t))||e.add(t);return Array.from(e)}async function BF(...A){return Promise.race(A.map(async j=>j()))}async function N$(A,j){let e=[];A.forEach(t=>{let r=jA(t);r&&r.kind==="externalModuleExport"&&e.push(r)}),e.length&&await j.preloadExternalModules(e),await ds(V,A,j)}function ps(A,j,e,t,r){if(pA(e.htmlContent))return;let o=A.getScopeNodeFor(j);E(o&&Kr(o),"Can't find scope with breakpoints");let a=o.getTopLevelVariants().map(i=>{let s=nj(i)?e.id:ee(i.id,e.id),c=A.get(s);return E(c&&qA(c),"Can't find rich text node in breakpoint"),[i,c]});for(let[i,s]of a){E(WA(i),"Can't read width attribute of node");let c=ma(t,d=>(d.breakpointWidth??0)>i.width)??r;s.detachTextStylePreset(c,!0)}}var $c=["formButtonSuccessVariant","formButtonPendingVariant","formButtonErrorVariant","formButtonIncompleteVariant","whileOpenEffectVariant","appearEffectVisibleVariantId","appearEffectObscuredVariantId","dataLoaderLoadingVariant","dataLoaderDisabledVariant"];function x$(A,j,e){let t=j.tokenOverrides;!t||me(t)||(O$(A,e,t),j.set({tokenOverrides:void 0}))}function O$(A,j,e){gF(A,j.id,e);let t=[];for(let r of j.variables){if(!L$(r)){t.push(r);continue}switch(r.type){case"border":t.push(jr(r.initialValue)?{...r,initialValue:{...r.initialValue,borderColor:Gr(r.initialValue.borderColor,e)}}:r);break;case"color":t.push({...r,initialValue:Gr(r.initialValue,e)});break;default:cA(r,"Unsupported variable type.")}}j.set({variables:t})}function gF(A,j,e){let t=A.tree.get(j);if(t)for(let{node:r,skipChildren:o}of t.walkWithSkipChildren()){if(hA(r)){o();continue}if(w$(r,e),hF(A,r,e),!z(r)||r.isVectorInstance)continue;let n=r.getLocalSmartComponentNodeId();if(!n){r.set({tokenOverrides:e});continue}let a=A.tree.get(n);rA(a)&&a.isLoaded()&&(O$(A,a,e),A.codeGenerationStore.updateComponent(a.id))}}function hF(A,j,e){let t=Bt(A.tree,j);for(let r of t){let{relatedNode:o,replicaRoot:n}=r;n.replicaInfo.overrides[j.id]&&w$(o,e)}}function w$(A,j){if(Se(A)){let e=Gr(A.fillColor,j);e&&A.set({fillColor:e})}if(ze(A)){let e=Gr(A.borderColor,j);e&&A.set({borderColor:e})}if(oe(A)){let e=Gr(A.strokeColor,j);e&&A.set({strokeColor:e})}if(qA(A)){let e=new Map;for(let t in j){if(!l6(t))continue;let r=j[t],o=U7(t);o&&e.set(o,`var(${t}, ${r})`)}A.replaceColorTokenVariables(e)}else if(z(A)){let e=V.componentForIdentifier(A.codeComponentIdentifier);if(!e)return;let t=A.getControlProps(e.properties);if(!t)return;for(let r in t){let o=t[r];if(!(!o||!L$(o)))switch(o.type){case"border":if(!jr(o.value))break;A.setControlProp(r,{...o,value:{...o.value,borderColor:Gr(o.value.borderColor,j)}});break;case"color":A.setControlProp(r,{...o,value:Gr(o.value,j)});break;default:cA(o,"Unsupported control type.")}}}}function Gr(A,j){if(Sj(A)||!qe(A))return A;let e=Q7(A);if(!l6(e))return A;let t=j[e];return t?`var(${e}, ${t})`:A}function L$(A){switch(A.type){case"color":case"border":return!0;case"array":case"boolean":case"number":case"string":case"richtext":case"eventhandler":case"image":case"file":case"scrollsectionref":case"customcursor":case"cursor":case"transition":case"boxshadow":case"gap":case"padding":case"borderradius":case"collectionreference":case"multicollectionreference":case"trackingid":case"vectorsetitem":case"date":case"enum":case"link":case"linkrelvalues":case"fusednumber":case"object":case"font":case"pagescope":case"slot":case"slug":case"controlReference":case"nodePropertyControlReference":return!1;default:cA(A,"Check if we support this variable type.")}}function q$(A){if(!J(A))return!1;for(let j of A.children)if(!GA(j)||vA(j)&&j.children.length>0)return!1;return!0}function K$(A,j,e){if(Dj(e))return;let t;A.stores.scopeStore.removeNode(j);let r=er(A.tree,e.id);r&&A.tree.removeNode(r);let o=A.tree.root.homePageNodeId,n=er(A.tree,j.id);n&&(j.id===o?A.tree.removeNode(n):n.set({webPageId:e.id})),A.tree.current(e)?.set({name:j.name,pagePath:j.pagePath}),A.tree.has(o)||(t??={},t.homePageNodeId=e.id),t&&A.tree.root.set(t)}function xn(A,j){return A.filter(e=>e.originalid===j.id).sort((e,t)=>(t.breakpointWidth??0)-(e.breakpointWidth??0))}function a5(A,j){let e=A.getPresetsListNode();E(e,"Can't find PresetsListNode");let t=e.children.filter(ct);return xn(t,j)}function P5(A,j,e){if(!qA(e))return;let t=e.getStylePresetsForCodeGeneration(A);for(let r of t){let o=A.getNodes(r.cache.replicaInstances??[]);for(let n of o)j[n.id]??=n.toJS();j[r.id]??=r.toJS()}}function Bc(A,j,e){for(let t of j){let r=A[t];if(!r)continue;let o=e(r);o&&o.id!==r&&A.set({[t]:o.id})}}function J$({engine:A,node:j,pastedPresetMap:e,stylePresetNodes:t,fromSameProject:r,breakpointVariantIds:o,shouldCreateNewPresets:n}){if(!t)return;let a={pastedPresetMap:e,stylePresetNodes:t,shouldCreateNewPresets:n},i=d=>RF(A,d,a);if(Bc(j,Du,i),j.remapTextStylePresets(i),r)return;let s=Do(j),c=A.tree.getGroundNodeFor(j);for(let d of j.getStylePresetIdsForCodeGeneration()){let p=t.find($=>$.id===d);if(!p||!wr(p))continue;let k=xn(t,p);if(s){ps(A.tree,s,j,k,p);continue}if(o?.has(c.id)&&WA(c)){let $=ma(k,g=>(g.breakpointWidth??0)>c.width)??p;j.detachTextStylePreset($,!1);continue}j.detachTextStylePreset(p,!1)}}function RF(A,j,{pastedPresetMap:e,stylePresetNodes:t,shouldCreateNewPresets:r}){if(!t)return;let o=t.find(p=>p.id===j);if(!o)return;let n=A.tree.get(j);if(n&&wr(n)&&n.equals(o))return e.set(j,n),n;if(!r)return;let i=kr(A.tree),s=i.getTextStylePresets().find(p=>p.equals(o));if(s&&wr(s))return e.set(j,s),s;let c=n?o.clone():o.cloneWithIds();A.tree.insertNode(c,i.id),e.set(j,c);let d=t.filter(p=>p.originalid===j);for(let p of d){let k=A.tree.get(j);if(k&&R7(k)&&k.equals(p)){e.set(j,k);continue}let g=k?p.clone():p.cloneWithIds();A.tree.insertNode(g,i.id),e.set(j,g)}return c}function H$({engine:A,node:j,pastedPresetMap:e,stylePresetNodes:t}){if(!t)return;let r={pastedPresetMap:e,stylePresetNodes:t},o=n=>IF(A,n,r);Bc(j,xu,o),j.remapLinkStylePresets(o)}function IF(A,j,{pastedPresetMap:e,stylePresetNodes:t}){if(!t)return;let r=t.find(c=>c.id===j);if(!r||!dt(r))return;let o=A.tree.get(j);if(o&&dt(o)&&o.equals(r))return e.set(j,o),o;let a=kr(A.tree),i=a.getLinkStylePresets().find(c=>c.equals(r));if(i&&dt(i))return e.set(j,i),i;let s=o?r.clone():r.cloneWithIds();return A.tree.insertNode(s,a.id),e.set(j,s),s}function Q$({engine:A,node:j,pastedPresetMap:e,stylePresetNodes:t}){if(!t)return;let r={pastedPresetMap:e,stylePresetNodes:t},o=n=>FF(A,n,r);Bc(j,Ou,o),j.remapInlineCodeStylePresets(o)}function FF(A,j,{pastedPresetMap:e,stylePresetNodes:t}){if(!t)return;let r=t.find(c=>c.id===j);if(!r||!pt(r))return;let o=A.tree.get(j);if(o&&pt(o)&&o.equals(r))return e.set(j,o),o;let a=kr(A.tree),i=a.getInlineCodeStylePresets().find(c=>c.equals(r));if(i&&pt(i))return e.set(j,i),i;let s=o?r.clone():r.cloneWithIds();return A.tree.insertNode(s,a.id),e.set(j,s),s}function M5(A){if(J(A))return{id:A.id,pagePath:A.pagePath,webMetadata:A.webMetadata,customHTML:A.customHTML,dataIdentifier:A.dataIdentifier}}function _5(A,j,e,t){let r={},o=new Set;function n(a){es(a,i=>{if(t.has(i))return;let s=GF(A,i);s&&(r[i]=s);let c=Wk(i,A.tree,A.stores.modulesStore,o);c&&Object.assign(r,c)})}for(let a of j.walk())n(a);return J(e)&&n(e),{moduleData:r}}function GF(A,j){let e=jA(j);if(e&&e.kind==="localModuleExport"){let t=A.stores.modulesStore.getPersistedModuleByLocalId(e.localId);return t?(E(t.files.module,"expected module typed file in persisted module"),Yj(t.id,t.saveId,t.files.module,e.exportSpecifier)):void 0}if(e&&e.kind==="externalModuleExport")return e}function SF(A,j,e){let t=jA(j);if(KA(t))return E(A.stores.modulesStore.initialized,"Cannot paste modules before modulesStore has been initialized."),A.stores.modulesStore.getPersistedModuleByLocalId(t.localId)?.id===e.moduleId?null:e.value;if(ne(t)&&t.kind==="externalModuleExport"){let r=A.stores.modulesStore.getPersistedModuleByGlobalId(t.moduleId)?.localId;return r?Tr(t,r).value:null}return null}function yF(A,j,e,t,r){let o=t.cloneWithIds();o.set(r),A.removeNode(t),A.insertNode(o,j,e)}function D5(A,j,e){if(!e)return j;for(let t of j.root.walk())vA(t)&&t.children.forEach((r,o)=>{if(e){let n=ts(r,a=>{let i=e[a];if(!i)return;let s=SF(A,a,i);return s||void 0});if(!n)return;yF(j,t.id,o,r,n)}});return j.commit()}function bF(A){return QA(A)&&WA(A)}function N5(A,j,e){let t=A.get(e.id);if(!t)return;let r=Do(t);if(!r||!GA(r))return;let o=A.getNodes(r.cache.replicaInstances??[]).filter(bF);for(let{width:n,replicaInfo:a}of o){let i=j.get(n)??{},s=a.overrides[e.id];s&&(i[e.id]=s),j.set(n,i)}WA(r)&&!j.get(r.width)&&j.set(r.width,{})}function fo(A,j,e,t){if(qe(j)){let r=Oi(j),o=A.get(r);if(o&&!(o.id in e)){let n=o.cloneWithIds();e[n.id]=n.toJS(),t&&(t[o.id]=Et())}}else if(x7(j))fo(A,j.color,e,t);else if(ik(j)||nk(j)||sk(j))for(let r of j.stops)fo(A,r.value,e,t);else if(Aj(j))for(let r of j)fo(A,r,e,t);else jr(j)&&fo(A,j.borderColor,e,t)}function x5(A,j,e,t){if(qA(j)){let r=j.getInlineStyleTokenVariables();fo(A,r,e,t)}for(let r in j)fo(A,j[r],e,t)}function O5(A,j,e){let t=e-j;return Math.ceil(A/100*t+j)}function V$({collectedCollections:A,node:j,tree:e}){if(Dj(j)){let t=jA(j.dataIdentifier);if(!KA(t))return;let r=e.getNodeWithTrait(t.localIdName,ej);r&&(A.set(j.dataIdentifier,r),V$({collectedCollections:A,node:r,tree:e}))}if(ej(j))for(let t of j.variables){if(!zi(t))continue;let r=jA(t.dataIdentifier);if(!KA(r))continue;let o=e.getNodeWithTrait(r.localIdName,ej);o&&(A.has(t.dataIdentifier)||(A.set(t.dataIdentifier,o),V$({collectedCollections:A,node:o,tree:e})))}}function H5(A){return sj(A)?A.getGroundNodes().length===0:!1}function Q5(A){if(!J(A))return!1;let j=A.getGroundNodes();return j.length>1?!1:j.length===0?!0:j[0]?.children?.length===0}function U5(A){return A?!A.children||A.children.length===0:!1}function W5(A,j){let e=A.get(j);if(!kt(e))return!1;for(let t of e.walk())if(kt(t)&&t.webPageId)return!0;return!1}function gc(A,j=!0){let e=A.trim().split("/").filter(Boolean).map(t=>{let r="/"+t,o=ls(r);return o.startsWith("/")?o.slice(1):o});return A.endsWith("/")&&j&&e.push(""),e}function z5(A){return`/${gc(A).join("/")}`}function CF(A){return A===""}function X5(A){return!!(A.webPageId&&CF(A.segment))}function vF(A,j){let e=j.get(A);if(!kt(e))return;let t=j.get(e.webPageId);if(J(t)||e.children.length>0)return;let r=e.parentid;j.removeNode(e),r&&vF(r,j)}function Y5(A,j){if(!A)return;let e=V.dataForIdentifier(A);if(e)return Lk(void 0,e,j??Rp)}function U$(A,j,e,t,r){let o=gc(t,J(j,!0));E(o.length>0,"Path must have at least one segment");let n=Ur(A.tree,{shouldAssert:!0});return o.forEach((a,i)=>{let s=i===o.length-1,c=s?r?.positionInParent:void 0,d=aa(a)?e:void 0;d&&(a=uc(d,a));let p=n.children.find($=>$.segment===a),k=p&&s&&j;if(!p||k&&p.webPageId){let $=new Xu({segment:a,webPageId:s?j?.id:void 0,dataIdentifier:d});A.tree.insertNode($,n.id,c),n=$}else k&&p.set({webPageId:j.id,dataIdentifier:d}),n=p}),E(kt(n),"Current parent should be the created RouteSegmentNode"),n}function W$(A,j){let e=er(A,j);return A.get(e?.parentid)?.children.findIndex(r=>r.id===e?.id)}function TF(A,j,e){let t=new Set(A.stores.scopeStore.getSmartComponentNodes().map(r=>r.name).filter(M));return e||j===null?Pj(e??"Component",t):Pj(j,t)}function hc(A,j,e,t,{insertionIndex:r,preferredName:o,enterIsolation:n=!0,localIdsToExternalIdentifiers:a=new Map,externalModuleIdsToLocalIds:i=new Map,instance:s,renamedIds:c=new Map,isAutoDetach:d=!1,intrinsicSize:p,textStylePresets:k,linkStylePresets:$,inlineCodeStylePresets:g,pastedPresetMap:G=new Map,fromInsertSidebar:I=!1,abTesting:S=!1}={}){let T=d?$a.createEmpty():A.tree,v={children:[]};if(J(j)){let N=j.id===A.tree.root.homePageNodeId?"Home":ye(A.tree,j),{suggestedName:X,path:Y}=mc(o??N??"Page",A,j,!0);v.pagePath=Y,v.name=X}else v.name=TF(A,j.name,o);let P=j.clone(v);c.set(j.id,P.id),rA(j)&&Lm({componentId:P.id,source:t});let _=P.instanceIdentifier,H=GA(e),O=Cn(e,a,i,c,H),Q=[O];P.baseVariantId=O.id,P.addChild(O);for(let N of j.children)if(!(N.id===e.id||qr(N)))if(QA(N)&&CA(N)){let X=uo(N.replicaInfo.overrides,c,!0);if($A(N)){X[O.id]??={};let nA=X[O.id];nA.top=N.top,nA.left=N.left,nA.right=N.right,nA.bottom=N.bottom,nA.centerAnchorX=N.centerAnchorX,nA.centerAnchorY=N.centerAnchorY}let Y=uA.create(A.tree,O,{overrides:X,duplicatedFrom:Qo(N)});c.set(N.id,Y.id),Q.push(Y),P.addChild(Y)}else{let X=Cn(N,a,i,void 0,H);Q.push(X),c.set(N.id,X.id),P.addChild(X)}T.insertNode(P,void 0,r);for(let N=0;N<j.children.length;N++){let X=j.children[N];if(!qr(X))continue;let Y=uA.create(T,O,{overrides:uo(X.replicaInfo.overrides,c,!0),inheritsFrom:c.get(X.replicaInfo.inheritsFrom),duplicatedFrom:Qo(X)});c.set(X.id,Y.id),Q.push(Y),T.insertNode(Y,P.id,N)}let L=ss(T);for(let N of Q){if(tt(T,N,c,!1),!k&&!$&&!g)continue;let X=[];for(let Y of N.walk())qA(Y)&&X.push(Y);for(let Y of X){let nA=Y.getStylePresetIdsForCodeGeneration();if($&&H$({engine:A,node:Y,pastedPresetMap:G,stylePresetNodes:$}),g&&Q$({engine:A,node:Y,pastedPresetMap:G,stylePresetNodes:g}),k){if(I)J$({engine:A,node:Y,pastedPresetMap:G,stylePresetNodes:k,fromSameProject:!0,shouldCreateNewPresets:I});else for(let aA of k)if(nA.has(aA.id))if(J(j)&&GA(N)){if(vj(N)){let PA=xn(k,aA);ps(T,O,Y,PA,aA)}}else(vj(N)||de(T,Y,"html"))&&Y.detachTextStylePreset(aA,!1)}}for(let Y of X){de(T,Y,"html")&&(Y.remapTextStylePresets((nA,aA)=>{let PA=kk(aA)?aA:"p",YA=Y.getNodeTextStylePreset(T,PA)??Ea(T,PA)??Ek.createDefault(PA);return Uu(A,YA),YA}),Y.remapLinkStylePresets(()=>{let nA=Y.getNodeLinkStylePreset(T)??Hu(T)??Mu.createDefault();return Qu(A,nA),nA}),Y.remapInlineCodeStylePresets(()=>{let nA=Y.getNodeInlineCodeStylePreset(T)??Vu(T)??new Gu;return Ju(A,nA),nA}));for(let nA in L)de(T,Y,nA)&&Y.set({[nA]:L[nA]})}}for(let N of G.values())hA(N)||A.codeGenerationStore.createModuleFromComponentSource(N).catch(yA);if(d)return T.commit(),P.draftOrCurrent();{let N=T.get(P.baseVariantId);if(N&&nj(N))for(let X of P.children)Jo(X)&&X.replicaInfo.master===N.id&&uA.registerInInheritedNode(N,X)}A.process(()=>{if(!s)return;let N=A.tree.current(s);if(!N)return;let X={},Y={},nA=s.getRawControlProps();if(nA.variant?.value&&M(nA.variant.value)){let aA=c.get(nA.variant.value)??O.id,PA={type:"enum",value:aA};X.variant=PA}for(let aA of $c){let PA=s[aA];M(PA)&&(Y[aA]=c.get(PA)??void 0)}Bt(A.tree,N).forEach(({relatedNode:aA,replicaRoot:PA})=>{let YA=PA.replicaInfo.overrides[aA.originalid];if(!YA)return;let Ij={};for(let ke of $c){if(!(ke in YA))continue;let wt=YA[ke];M(wt)&&(Y[ke]=c.get(wt)??void 0)}if(aA.set(Ij),!(VA("variant")in YA))return;let uj=aA.getRawControlProp("variant");if(!uj||!M(uj.value))return;let cj=c.get(uj.value);if(!cj)return;let xj={type:"enum",value:cj};aA.set(Lr({variant:xj}))}),N.set({codeComponentIdentifier:_,...Y,...Lr(X)})});let dA=A.codeGenerationStore.createModuleFromComponentSource(P,p);if(s&&dA.then(A.wrapHandler(()=>{if(s=A.tree.get(s?.id),!s)return;let N=A.stores.treeStore.tree.getScopeNodeFor(s)?.loaded;if(!N||!Xt(N))return;let X=A.stores.treeStore.tree.get(N.baseVariantId);X&&nj(X)&&A.codeGenerationStore.updateComponent(N.id).catch(yA)})).catch(yA),n&&(A.stores.chromeStore.contentPanelTab="Layers",A.stores.scopeStore.select(P.id,{keepHistory:!0})),Xi(A.tree)&&J(P)&&!S){E(M(v.pagePath),"pagePath should be a string");let N=W$(A.tree,j.id),X=Z(N)?N+1:void 0;U$(A,P,P.dataIdentifier,v.pagePath,{positionInParent:X})}return P.draftOrCurrent()}async function z$(A,{identifier:j,enterIsolation:e,instance:t,isAutoDetach:r,renamedIds:o=new Map,info:n}){let{node:a,dependencies:i}=await Tf(A,j);E(_a(a),"Should be a generated node.");let s=A.tree.get(t?.originalid??t?.id);E(!s||z(s),"instance should be a code component.");let c=a.children.find(I=>I.id===a.baseVariantId);E(c&&nj(c),"Unlink: Can't unlink a tree which doesn't have a Primary Variant node");let{identifiers:d,localIdsToExternalIdentifiers:p,externalModuleIdsToLocalIds:k}=Cf(a,A.stores.modulesStore,i);if(await N$(d.map(I=>I.value),A.stores.modulesStore),d.some(I=>{let S=V.dataForIdentifier(I.value);return S?Xp(S):!1})){TA({type:"add",variant:"info",text:"Remove collection references before unlinking"});return}let g=await bf(i.imports);return await Pf(A,i,j),await A.stores.modulesStore.addExternalModulesToProject(d,{onTreeUpdate:()=>{let I=A.tree.current(s),S=Ve(n.module.metadata.intrinsicWidth)??200,T=Ve(n.module.metadata.intrinsicHeight)??200,v=hc(A,a,c,"unlink",{enterIsolation:e,localIdsToExternalIdentifiers:p,externalModuleIdsToLocalIds:k,instance:I,renamedIds:o,isAutoDetach:r,intrinsicSize:{width:S,height:T},textStylePresets:g});return I&&rA(v)&&x$(A,I,v),v}})}async function X$(A,j){let e=await z$(A,j);if(!e)return;E(rA(e),"node should be a smart component");let{isAutoDetach:t}=j;return t||await A.codeGenerationStore.untilCompiled(e.id),e.draftOrCurrent()}async function Y$(A,j){let[e]=await A.stores.modulesStore.preloadExternalModules([j]);if(!e)return;let t=await z$(A,{identifier:j,enterIsolation:!1,info:e});E(J(t),"node should be a web page");let{path:r,suggestedName:o}=mc(t.name??"Page",A,t,!0);return A.processWhenReady(()=>{A.tree.current(t)?.set({name:o,pagePath:r});let n=A.stores.scopeStore.active;q$(n)&&K$(A,n,t),A.stores.scopeStore.select(t.id,{keepHistory:!1})}),t}function Z$(A,j,e,t){let r=hc(A,j,e,"duplicate",{enterIsolation:!1,preferredName:t,insertionIndex:A.tree.root.children.findIndex(o=>o.id===j.id)+1});A.stores.persistedUserDefaults.newContentAsDraft&&r.set({isDraft:!0,duplicatedFrom:Li(r.duplicatedFrom,j.id)}),A.stores.scopeStore.select(r.id,{keepHistory:!1})}function AB(A,j){let[e,...t]=j.selection.ids;if(!e||t.length)return null;let r=j.tree,o=r.getNode(e),n=!1;for(;!n&&o&&(n=ht(r,o,A,j.stores.scopeStore.active.id,V),!n);)o=r.getParent(o.id);return o}var Pt=".tsx";var PF=["arguments","await","break","case","catch","class","const","continue","debugger","default","delete","do","else","enum","eval","export","extends","false","finally","for","function","if","implements","import","in","instanceof","interface","let","new","null","package","private","protected","public","return","static","super","switch","this","throw","true","try","typeof","var","void","while","with","yield","Infinity","NaN","document","undefined","window"],MF=["toolbar"],_F=/^[$A-Z_a-z\xAA\xB5\xBA\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0370-\u0374\u0376\u0377\u037A-\u037D\u037F\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u048A-\u052F\u0531-\u0556\u0559\u0560-\u0588\u05D0-\u05EA\u05EF-\u05F2\u0620-\u064A\u066E\u066F\u0671-\u06D3\u06D5\u06E5\u06E6\u06EE\u06EF\u06FA-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07CA-\u07EA\u07F4\u07F5\u07FA\u0800-\u0815\u081A\u0824\u0828\u0840-\u0858\u0860-\u086A\u08A0-\u08B4\u08B6-\u08BD\u0904-\u0939\u093D\u0950\u0958-\u0961\u0971-\u0980\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC\u09DD\u09DF-\u09E1\u09F0\u09F1\u09FC\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A59-\u0A5C\u0A5E\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0\u0AE1\u0AF9\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3D\u0B5C\u0B5D\u0B5F-\u0B61\u0B71\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D\u0C58-\u0C5A\u0C60\u0C61\u0C80\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDE\u0CE0\u0CE1\u0CF1\u0CF2\u0D05-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D\u0D4E\u0D54-\u0D56\u0D5F-\u0D61\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0E01-\u0E30\u0E32\u0E33\u0E40-\u0E46\u0E81\u0E82\u0E84\u0E86-\u0E8A\u0E8C-\u0EA3\u0EA5\u0EA7-\u0EB0\u0EB2\u0EB3\u0EBD\u0EC0-\u0EC4\u0EC6\u0EDC-\u0EDF\u0F00\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8C\u1000-\u102A\u103F\u1050-\u1055\u105A-\u105D\u1061\u1065\u1066\u106E-\u1070\u1075-\u1081\u108E\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16EE-\u16F8\u1700-\u170C\u170E-\u1711\u1720-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17D7\u17DC\u1820-\u1878\u1880-\u1884\u1887-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191E\u1950-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u1A00-\u1A16\u1A20-\u1A54\u1AA7\u1B05-\u1B33\u1B45-\u1B4B\u1B83-\u1BA0\u1BAE\u1BAF\u1BBA-\u1BE5\u1C00-\u1C23\u1C4D-\u1C4F\u1C5A-\u1C7D\u1C80-\u1C88\u1C90-\u1CBA\u1CBD-\u1CBF\u1CE9-\u1CEC\u1CEE-\u1CF3\u1CF5\u1CF6\u1CFA\u1D00-\u1DBF\u1E00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u2071\u207F\u2090-\u209C\u2102\u2107\u210A-\u2113\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u212F-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2160-\u2188\u2C00-\u2C2E\u2C30-\u2C5E\u2C60-\u2CE4\u2CEB-\u2CEE\u2CF2\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2E2F\u3005-\u3007\u3021-\u3029\u3031-\u3035\u3038-\u303C\u3041-\u3096\u309D-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312F\u3131-\u318E\u31A0-\u31BA\u31F0-\u31FF\u3400-\u4DB5\u4E00-\u9FEF\uA000-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA61F\uA62A\uA62B\uA640-\uA66E\uA67F-\uA69D\uA6A0-\uA6EF\uA717-\uA71F\uA722-\uA788\uA78B-\uA7BF\uA7C2-\uA7C6\uA7F7-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA840-\uA873\uA882-\uA8B3\uA8F2-\uA8F7\uA8FB\uA8FD\uA8FE\uA90A-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uA9CF\uA9E0-\uA9E4\uA9E6-\uA9EF\uA9FA-\uA9FE\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA60-\uAA76\uAA7A\uAA7E-\uAAAF\uAAB1\uAAB5\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB-\uAADD\uAAE0-\uAAEA\uAAF2-\uAAF4\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB67\uAB70-\uABE2\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC\u{10000}-\u{1000B}\u{1000D}-\u{10026}\u{10028}-\u{1003A}\u{1003C}\u{1003D}\u{1003F}-\u{1004D}\u{10050}-\u{1005D}\u{10080}-\u{100FA}\u{10140}-\u{10174}\u{10280}-\u{1029C}\u{102A0}-\u{102D0}\u{10300}-\u{1031F}\u{1032D}-\u{1034A}\u{10350}-\u{10375}\u{10380}-\u{1039D}\u{103A0}-\u{103C3}\u{103C8}-\u{103CF}\u{103D1}-\u{103D5}\u{10400}-\u{1049D}\u{104B0}-\u{104D3}\u{104D8}-\u{104FB}\u{10500}-\u{10527}\u{10530}-\u{10563}\u{10600}-\u{10736}\u{10740}-\u{10755}\u{10760}-\u{10767}\u{10800}-\u{10805}\u{10808}\u{1080A}-\u{10835}\u{10837}\u{10838}\u{1083C}\u{1083F}-\u{10855}\u{10860}-\u{10876}\u{10880}-\u{1089E}\u{108E0}-\u{108F2}\u{108F4}\u{108F5}\u{10900}-\u{10915}\u{10920}-\u{10939}\u{10980}-\u{109B7}\u{109BE}\u{109BF}\u{10A00}\u{10A10}-\u{10A13}\u{10A15}-\u{10A17}\u{10A19}-\u{10A35}\u{10A60}-\u{10A7C}\u{10A80}-\u{10A9C}\u{10AC0}-\u{10AC7}\u{10AC9}-\u{10AE4}\u{10B00}-\u{10B35}\u{10B40}-\u{10B55}\u{10B60}-\u{10B72}\u{10B80}-\u{10B91}\u{10C00}-\u{10C48}\u{10C80}-\u{10CB2}\u{10CC0}-\u{10CF2}\u{10D00}-\u{10D23}\u{10F00}-\u{10F1C}\u{10F27}\u{10F30}-\u{10F45}\u{10FE0}-\u{10FF6}\u{11003}-\u{11037}\u{11083}-\u{110AF}\u{110D0}-\u{110E8}\u{11103}-\u{11126}\u{11144}\u{11150}-\u{11172}\u{11176}\u{11183}-\u{111B2}\u{111C1}-\u{111C4}\u{111DA}\u{111DC}\u{11200}-\u{11211}\u{11213}-\u{1122B}\u{11280}-\u{11286}\u{11288}\u{1128A}-\u{1128D}\u{1128F}-\u{1129D}\u{1129F}-\u{112A8}\u{112B0}-\u{112DE}\u{11305}-\u{1130C}\u{1130F}\u{11310}\u{11313}-\u{11328}\u{1132A}-\u{11330}\u{11332}\u{11333}\u{11335}-\u{11339}\u{1133D}\u{11350}\u{1135D}-\u{11361}\u{11400}-\u{11434}\u{11447}-\u{1144A}\u{1145F}\u{11480}-\u{114AF}\u{114C4}\u{114C5}\u{114C7}\u{11580}-\u{115AE}\u{115D8}-\u{115DB}\u{11600}-\u{1162F}\u{11644}\u{11680}-\u{116AA}\u{116B8}\u{11700}-\u{1171A}\u{11800}-\u{1182B}\u{118A0}-\u{118DF}\u{118FF}\u{119A0}-\u{119A7}\u{119AA}-\u{119D0}\u{119E1}\u{119E3}\u{11A00}\u{11A0B}-\u{11A32}\u{11A3A}\u{11A50}\u{11A5C}-\u{11A89}\u{11A9D}\u{11AC0}-\u{11AF8}\u{11C00}-\u{11C08}\u{11C0A}-\u{11C2E}\u{11C40}\u{11C72}-\u{11C8F}\u{11D00}-\u{11D06}\u{11D08}\u{11D09}\u{11D0B}-\u{11D30}\u{11D46}\u{11D60}-\u{11D65}\u{11D67}\u{11D68}\u{11D6A}-\u{11D89}\u{11D98}\u{11EE0}-\u{11EF2}\u{12000}-\u{12399}\u{12400}-\u{1246E}\u{12480}-\u{12543}\u{13000}-\u{1342E}\u{14400}-\u{14646}\u{16800}-\u{16A38}\u{16A40}-\u{16A5E}\u{16AD0}-\u{16AED}\u{16B00}-\u{16B2F}\u{16B40}-\u{16B43}\u{16B63}-\u{16B77}\u{16B7D}-\u{16B8F}\u{16E40}-\u{16E7F}\u{16F00}-\u{16F4A}\u{16F50}\u{16F93}-\u{16F9F}\u{16FE0}\u{16FE1}\u{16FE3}\u{17000}-\u{187F7}\u{18800}-\u{18AF2}\u{1B000}-\u{1B11E}\u{1B150}-\u{1B152}\u{1B164}-\u{1B167}\u{1B170}-\u{1B2FB}\u{1BC00}-\u{1BC6A}\u{1BC70}-\u{1BC7C}\u{1BC80}-\u{1BC88}\u{1BC90}-\u{1BC99}\u{1D400}-\u{1D454}\u{1D456}-\u{1D49C}\u{1D49E}\u{1D49F}\u{1D4A2}\u{1D4A5}\u{1D4A6}\u{1D4A9}-\u{1D4AC}\u{1D4AE}-\u{1D4B9}\u{1D4BB}\u{1D4BD}-\u{1D4C3}\u{1D4C5}-\u{1D505}\u{1D507}-\u{1D50A}\u{1D50D}-\u{1D514}\u{1D516}-\u{1D51C}\u{1D51E}-\u{1D539}\u{1D53B}-\u{1D53E}\u{1D540}-\u{1D544}\u{1D546}\u{1D54A}-\u{1D550}\u{1D552}-\u{1D6A5}\u{1D6A8}-\u{1D6C0}\u{1D6C2}-\u{1D6DA}\u{1D6DC}-\u{1D6FA}\u{1D6FC}-\u{1D714}\u{1D716}-\u{1D734}\u{1D736}-\u{1D74E}\u{1D750}-\u{1D76E}\u{1D770}-\u{1D788}\u{1D78A}-\u{1D7A8}\u{1D7AA}-\u{1D7C2}\u{1D7C4}-\u{1D7CB}\u{1E100}-\u{1E12C}\u{1E137}-\u{1E13D}\u{1E14E}\u{1E2C0}-\u{1E2EB}\u{1E800}-\u{1E8C4}\u{1E900}-\u{1E943}\u{1E94B}\u{1EE00}-\u{1EE03}\u{1EE05}-\u{1EE1F}\u{1EE21}\u{1EE22}\u{1EE24}\u{1EE27}\u{1EE29}-\u{1EE32}\u{1EE34}-\u{1EE37}\u{1EE39}\u{1EE3B}\u{1EE42}\u{1EE47}\u{1EE49}\u{1EE4B}\u{1EE4D}-\u{1EE4F}\u{1EE51}\u{1EE52}\u{1EE54}\u{1EE57}\u{1EE59}\u{1EE5B}\u{1EE5D}\u{1EE5F}\u{1EE61}\u{1EE62}\u{1EE64}\u{1EE67}-\u{1EE6A}\u{1EE6C}-\u{1EE72}\u{1EE74}-\u{1EE77}\u{1EE79}-\u{1EE7C}\u{1EE7E}\u{1EE80}-\u{1EE89}\u{1EE8B}-\u{1EE9B}\u{1EEA1}-\u{1EEA3}\u{1EEA5}-\u{1EEA9}\u{1EEAB}-\u{1EEBB}\u{20000}-\u{2A6D6}\u{2A700}-\u{2B734}\u{2B740}-\u{2B81D}\u{2B820}-\u{2CEA1}\u{2CEB0}-\u{2EBE0}\u{2F800}-\u{2FA1D}]+/u,DF=/[\0-#%-/:-@[-^`{-\xA9\xAB-\xB4\xB6-\xB9\xBB-\xBF\xD7\xF7\u02C2-\u02C5\u02D2-\u02DF\u02E5-\u02EB\u02ED\u02EF-\u02FF\u0375\u0378\u0379\u037E\u0380-\u0385\u0387\u038B\u038D\u03A2\u03F6\u0482\u0488\u0489\u0530\u0557\u0558\u055A-\u055F\u0589-\u0590\u05BE\u05C0\u05C3\u05C6\u05C8-\u05CF\u05EB-\u05EE\u05F3-\u060F\u061B-\u061F\u066A-\u066D\u06D4\u06DD\u06DE\u06E9\u06FD\u06FE\u0700-\u070F\u074B\u074C\u07B2-\u07BF\u07F6-\u07F9\u07FB\u07FC\u07FE\u07FF\u082E-\u083F\u085C-\u085F\u086B-\u089F\u08B5\u08BE-\u08D2\u08E2\u0964\u0965\u0970\u0984\u098D\u098E\u0991\u0992\u09A9\u09B1\u09B3-\u09B5\u09BA\u09BB\u09C5\u09C6\u09C9\u09CA\u09CF-\u09D6\u09D8-\u09DB\u09DE\u09E4\u09E5\u09F2-\u09FB\u09FD\u09FF\u0A00\u0A04\u0A0B-\u0A0E\u0A11\u0A12\u0A29\u0A31\u0A34\u0A37\u0A3A\u0A3B\u0A3D\u0A43-\u0A46\u0A49\u0A4A\u0A4E-\u0A50\u0A52-\u0A58\u0A5D\u0A5F-\u0A65\u0A76-\u0A80\u0A84\u0A8E\u0A92\u0AA9\u0AB1\u0AB4\u0ABA\u0ABB\u0AC6\u0ACA\u0ACE\u0ACF\u0AD1-\u0ADF\u0AE4\u0AE5\u0AF0-\u0AF8\u0B00\u0B04\u0B0D\u0B0E\u0B11\u0B12\u0B29\u0B31\u0B34\u0B3A\u0B3B\u0B45\u0B46\u0B49\u0B4A\u0B4E-\u0B55\u0B58-\u0B5B\u0B5E\u0B64\u0B65\u0B70\u0B72-\u0B81\u0B84\u0B8B-\u0B8D\u0B91\u0B96-\u0B98\u0B9B\u0B9D\u0BA0-\u0BA2\u0BA5-\u0BA7\u0BAB-\u0BAD\u0BBA-\u0BBD\u0BC3-\u0BC5\u0BC9\u0BCE\u0BCF\u0BD1-\u0BD6\u0BD8-\u0BE5\u0BF0-\u0BFF\u0C0D\u0C11\u0C29\u0C3A-\u0C3C\u0C45\u0C49\u0C4E-\u0C54\u0C57\u0C5B-\u0C5F\u0C64\u0C65\u0C70-\u0C7F\u0C84\u0C8D\u0C91\u0CA9\u0CB4\u0CBA\u0CBB\u0CC5\u0CC9\u0CCE-\u0CD4\u0CD7-\u0CDD\u0CDF\u0CE4\u0CE5\u0CF0\u0CF3-\u0CFF\u0D04\u0D0D\u0D11\u0D45\u0D49\u0D4F-\u0D53\u0D58-\u0D5E\u0D64\u0D65\u0D70-\u0D79\u0D80\u0D81\u0D84\u0D97-\u0D99\u0DB2\u0DBC\u0DBE\u0DBF\u0DC7-\u0DC9\u0DCB-\u0DCE\u0DD5\u0DD7\u0DE0-\u0DE5\u0DF0\u0DF1\u0DF4-\u0E00\u0E3B-\u0E3F\u0E4F\u0E5A-\u0E80\u0E83\u0E85\u0E8B\u0EA4\u0EA6\u0EBE\u0EBF\u0EC5\u0EC7\u0ECE\u0ECF\u0EDA\u0EDB\u0EE0-\u0EFF\u0F01-\u0F17\u0F1A-\u0F1F\u0F2A-\u0F34\u0F36\u0F38\u0F3A-\u0F3D\u0F48\u0F6D-\u0F70\u0F85\u0F98\u0FBD-\u0FC5\u0FC7-\u0FFF\u104A-\u104F\u109E\u109F\u10C6\u10C8-\u10CC\u10CE\u10CF\u10FB\u1249\u124E\u124F\u1257\u1259\u125E\u125F\u1289\u128E\u128F\u12B1\u12B6\u12B7\u12BF\u12C1\u12C6\u12C7\u12D7\u1311\u1316\u1317\u135B\u135C\u1360-\u137F\u1390-\u139F\u13F6\u13F7\u13FE-\u1400\u166D\u166E\u1680\u169B-\u169F\u16EB-\u16ED\u16F9-\u16FF\u170D\u1715-\u171F\u1735-\u173F\u1754-\u175F\u176D\u1771\u1774-\u177F\u17D4-\u17D6\u17D8-\u17DB\u17DE\u17DF\u17EA-\u180A\u180E\u180F\u181A-\u181F\u1879-\u187F\u18AB-\u18AF\u18F6-\u18FF\u191F\u192C-\u192F\u193C-\u1945\u196E\u196F\u1975-\u197F\u19AC-\u19AF\u19CA-\u19CF\u19DA-\u19FF\u1A1C-\u1A1F\u1A5F\u1A7D\u1A7E\u1A8A-\u1A8F\u1A9A-\u1AA6\u1AA8-\u1AAF\u1ABE-\u1AFF\u1B4C-\u1B4F\u1B5A-\u1B6A\u1B74-\u1B7F\u1BF4-\u1BFF\u1C38-\u1C3F\u1C4A-\u1C4C\u1C7E\u1C7F\u1C89-\u1C8F\u1CBB\u1CBC\u1CC0-\u1CCF\u1CD3\u1CFB-\u1CFF\u1DFA\u1F16\u1F17\u1F1E\u1F1F\u1F46\u1F47\u1F4E\u1F4F\u1F58\u1F5A\u1F5C\u1F5E\u1F7E\u1F7F\u1FB5\u1FBD\u1FBF-\u1FC1\u1FC5\u1FCD-\u1FCF\u1FD4\u1FD5\u1FDC-\u1FDF\u1FED-\u1FF1\u1FF5\u1FFD-\u200C\u200E-\u203E\u2041-\u2053\u2055-\u2070\u2072-\u207E\u2080-\u208F\u209D-\u20CF\u20DD-\u20E0\u20E2-\u20E4\u20F1-\u2101\u2103-\u2106\u2108\u2109\u2114\u2116-\u2118\u211E-\u2123\u2125\u2127\u2129\u212E\u213A\u213B\u2140-\u2144\u214A-\u214D\u214F-\u215F\u2189-\u220B\u220D-\u2BFF\u2C2F\u2C5F\u2CE5-\u2CEA\u2CF4-\u2CFF\u2D26\u2D28-\u2D2C\u2D2E\u2D2F\u2D68-\u2D6E\u2D70-\u2D7E\u2D97-\u2D9F\u2DA7\u2DAF\u2DB7\u2DBF\u2DC7\u2DCF\u2DD7\u2DDF\u2E00-\u2E2E\u2E30-\u3004\u3008-\u3020\u3030\u3036\u3037\u303D-\u3040\u3097\u3098\u309B\u309C\u30A0\u30FB\u3100-\u3104\u3130\u318F-\u319F\u31BB-\u31EF\u3200-\u33FF\u4DB6-\u4DFF\u9FF0-\u9FFF\uA48D-\uA4CF\uA4FE\uA4FF\uA60D-\uA60F\uA62C-\uA63F\uA670-\uA673\uA67E\uA6F2-\uA716\uA720\uA721\uA789\uA78A\uA7C0\uA7C1\uA7C7-\uA7F6\uA828-\uA83F\uA874-\uA87F\uA8C6-\uA8CF\uA8DA-\uA8DF\uA8F8-\uA8FA\uA8FC\uA92E\uA92F\uA954-\uA95F\uA97D-\uA97F\uA9C1-\uA9CE\uA9DA-\uA9DF\uA9FF\uAA37-\uAA3F\uAA4E\uAA4F\uAA5A-\uAA5F\uAA77-\uAA79\uAAC3-\uAADA\uAADE\uAADF\uAAF0\uAAF1\uAAF7-\uAB00\uAB07\uAB08\uAB0F\uAB10\uAB17-\uAB1F\uAB27\uAB2F\uAB5B\uAB68-\uAB6F\uABEB\uABEE\uABEF\uABFA-\uABFF\uD7A4-\uD7AF\uD7C7-\uD7CA\uD7FC-\uF8FF\uFA6E\uFA6F\uFADA-\uFAFF\uFB07-\uFB12\uFB18-\uFB1C\uFB29\uFB37\uFB3D\uFB3F\uFB42\uFB45\uFBB2-\uFBD2\uFD3E-\uFD4F\uFD90\uFD91\uFDC8-\uFDEF\uFDFC-\uFDFF\uFE10-\uFE1F\uFE30-\uFE32\uFE35-\uFE4C\uFE50-\uFE6F\uFE75\uFEFD-\uFF0F\uFF1A-\uFF20\uFF3B-\uFF3E\uFF40\uFF5B-\uFF65\uFFBF-\uFFC1\uFFC8\uFFC9\uFFD0\uFFD1\uFFD8\uFFD9\uFFDD-\uFFFF\u{1000C}\u{10027}\u{1003B}\u{1003E}\u{1004E}\u{1004F}\u{1005E}-\u{1007F}\u{100FB}-\u{1013F}\u{10175}-\u{101FC}\u{101FE}-\u{1027F}\u{1029D}-\u{1029F}\u{102D1}-\u{102DF}\u{102E1}-\u{102FF}\u{10320}-\u{1032C}\u{1034B}-\u{1034F}\u{1037B}-\u{1037F}\u{1039E}\u{1039F}\u{103C4}-\u{103C7}\u{103D0}\u{103D6}-\u{103FF}\u{1049E}\u{1049F}\u{104AA}-\u{104AF}\u{104D4}-\u{104D7}\u{104FC}-\u{104FF}\u{10528}-\u{1052F}\u{10564}-\u{105FF}\u{10737}-\u{1073F}\u{10756}-\u{1075F}\u{10768}-\u{107FF}\u{10806}\u{10807}\u{10809}\u{10836}\u{10839}-\u{1083B}\u{1083D}\u{1083E}\u{10856}-\u{1085F}\u{10877}-\u{1087F}\u{1089F}-\u{108DF}\u{108F3}\u{108F6}-\u{108FF}\u{10916}-\u{1091F}\u{1093A}-\u{1097F}\u{109B8}-\u{109BD}\u{109C0}-\u{109FF}\u{10A04}\u{10A07}-\u{10A0B}\u{10A14}\u{10A18}\u{10A36}\u{10A37}\u{10A3B}-\u{10A3E}\u{10A40}-\u{10A5F}\u{10A7D}-\u{10A7F}\u{10A9D}-\u{10ABF}\u{10AC8}\u{10AE7}-\u{10AFF}\u{10B36}-\u{10B3F}\u{10B56}-\u{10B5F}\u{10B73}-\u{10B7F}\u{10B92}-\u{10BFF}\u{10C49}-\u{10C7F}\u{10CB3}-\u{10CBF}\u{10CF3}-\u{10CFF}\u{10D28}-\u{10D2F}\u{10D3A}-\u{10EFF}\u{10F1D}-\u{10F26}\u{10F28}-\u{10F2F}\u{10F51}-\u{10FDF}\u{10FF7}-\u{10FFF}\u{11047}-\u{11065}\u{11070}-\u{1107E}\u{110BB}-\u{110CF}\u{110E9}-\u{110EF}\u{110FA}-\u{110FF}\u{11135}\u{11140}-\u{11143}\u{11147}-\u{1114F}\u{11174}\u{11175}\u{11177}-\u{1117F}\u{111C5}-\u{111C8}\u{111CD}-\u{111CF}\u{111DB}\u{111DD}-\u{111FF}\u{11212}\u{11238}-\u{1123D}\u{1123F}-\u{1127F}\u{11287}\u{11289}\u{1128E}\u{1129E}\u{112A9}-\u{112AF}\u{112EB}-\u{112EF}\u{112FA}-\u{112FF}\u{11304}\u{1130D}\u{1130E}\u{11311}\u{11312}\u{11329}\u{11331}\u{11334}\u{1133A}\u{11345}\u{11346}\u{11349}\u{1134A}\u{1134E}\u{1134F}\u{11351}-\u{11356}\u{11358}-\u{1135C}\u{11364}\u{11365}\u{1136D}-\u{1136F}\u{11375}-\u{113FF}\u{1144B}-\u{1144F}\u{1145A}-\u{1145D}\u{11460}-\u{1147F}\u{114C6}\u{114C8}-\u{114CF}\u{114DA}-\u{1157F}\u{115B6}\u{115B7}\u{115C1}-\u{115D7}\u{115DE}-\u{115FF}\u{11641}-\u{11643}\u{11645}-\u{1164F}\u{1165A}-\u{1167F}\u{116B9}-\u{116BF}\u{116CA}-\u{116FF}\u{1171B}\u{1171C}\u{1172C}-\u{1172F}\u{1173A}-\u{117FF}\u{1183B}-\u{1189F}\u{118EA}-\u{118FE}\u{11900}-\u{1199F}\u{119A8}\u{119A9}\u{119D8}\u{119D9}\u{119E2}\u{119E5}-\u{119FF}\u{11A3F}-\u{11A46}\u{11A48}-\u{11A4F}\u{11A9A}-\u{11A9C}\u{11A9E}-\u{11ABF}\u{11AF9}-\u{11BFF}\u{11C09}\u{11C37}\u{11C41}-\u{11C4F}\u{11C5A}-\u{11C71}\u{11C90}\u{11C91}\u{11CA8}\u{11CB7}-\u{11CFF}\u{11D07}\u{11D0A}\u{11D37}-\u{11D39}\u{11D3B}\u{11D3E}\u{11D48}-\u{11D4F}\u{11D5A}-\u{11D5F}\u{11D66}\u{11D69}\u{11D8F}\u{11D92}\u{11D99}-\u{11D9F}\u{11DAA}-\u{11EDF}\u{11EF7}-\u{11FFF}\u{1239A}-\u{123FF}\u{1246F}-\u{1247F}\u{12544}-\u{12FFF}\u{1342F}-\u{143FF}\u{14647}-\u{167FF}\u{16A39}-\u{16A3F}\u{16A5F}\u{16A6A}-\u{16ACF}\u{16AEE}\u{16AEF}\u{16AF5}-\u{16AFF}\u{16B37}-\u{16B3F}\u{16B44}-\u{16B4F}\u{16B5A}-\u{16B62}\u{16B78}-\u{16B7C}\u{16B90}-\u{16E3F}\u{16E80}-\u{16EFF}\u{16F4B}-\u{16F4E}\u{16F88}-\u{16F8E}\u{16FA0}-\u{16FDF}\u{16FE2}\u{16FE4}-\u{16FFF}\u{187F8}-\u{187FF}\u{18AF3}-\u{1AFFF}\u{1B11F}-\u{1B14F}\u{1B153}-\u{1B163}\u{1B168}-\u{1B16F}\u{1B2FC}-\u{1BBFF}\u{1BC6B}-\u{1BC6F}\u{1BC7D}-\u{1BC7F}\u{1BC89}-\u{1BC8F}\u{1BC9A}-\u{1BC9C}\u{1BC9F}-\u{1D164}\u{1D16A}-\u{1D16C}\u{1D173}-\u{1D17A}\u{1D183}\u{1D184}\u{1D18C}-\u{1D1A9}\u{1D1AE}-\u{1D241}\u{1D245}-\u{1D3FF}\u{1D455}\u{1D49D}\u{1D4A0}\u{1D4A1}\u{1D4A3}\u{1D4A4}\u{1D4A7}\u{1D4A8}\u{1D4AD}\u{1D4BA}\u{1D4BC}\u{1D4C4}\u{1D506}\u{1D50B}\u{1D50C}\u{1D515}\u{1D51D}\u{1D53A}\u{1D53F}\u{1D545}\u{1D547}-\u{1D549}\u{1D551}\u{1D6A6}\u{1D6A7}\u{1D6C1}\u{1D6DB}\u{1D6FB}\u{1D715}\u{1D735}\u{1D74F}\u{1D76F}\u{1D789}\u{1D7A9}\u{1D7C3}\u{1D7CC}\u{1D7CD}\u{1D800}-\u{1D9FF}\u{1DA37}-\u{1DA3A}\u{1DA6D}-\u{1DA74}\u{1DA76}-\u{1DA83}\u{1DA85}-\u{1DA9A}\u{1DAA0}\u{1DAB0}-\u{1DFFF}\u{1E007}\u{1E019}\u{1E01A}\u{1E022}\u{1E025}\u{1E02B}-\u{1E0FF}\u{1E12D}-\u{1E12F}\u{1E13E}\u{1E13F}\u{1E14A}-\u{1E14D}\u{1E14F}-\u{1E2BF}\u{1E2FA}-\u{1E7FF}\u{1E8C5}-\u{1E8CF}\u{1E8D7}-\u{1E8FF}\u{1E94C}-\u{1E94F}\u{1E95A}-\u{1EDFF}\u{1EE04}\u{1EE20}\u{1EE23}\u{1EE25}\u{1EE26}\u{1EE28}\u{1EE33}\u{1EE38}\u{1EE3A}\u{1EE3C}-\u{1EE41}\u{1EE43}-\u{1EE46}\u{1EE48}\u{1EE4A}\u{1EE4C}\u{1EE50}\u{1EE53}\u{1EE55}\u{1EE56}\u{1EE58}\u{1EE5A}\u{1EE5C}\u{1EE5E}\u{1EE60}\u{1EE63}\u{1EE65}\u{1EE66}\u{1EE6B}\u{1EE73}\u{1EE78}\u{1EE7D}\u{1EE7F}\u{1EE8A}\u{1EE9C}-\u{1EEA0}\u{1EEA4}\u{1EEAA}\u{1EEBC}-\u{1FFFF}\u{2A6D7}-\u{2A6FF}\u{2B735}-\u{2B73F}\u{2B81E}\u{2B81F}\u{2CEA2}-\u{2CEAF}\u{2EBE1}-\u{2F7FF}\u{2FA1E}-\u{E00FF}\u{E01F0}-\u{10FFFF}]+/gu,NF=/^\.+$/u,lQ=(A,j)=>{if(A===null||A.trim().length===0)return null;let e=1,t=A.replace(/_\d+$/u,""),r=A;for(;j.includes(r)||xF(r);)r=`${t}_${e}`,e++;return r},xF=A=>PF.includes(A)||window.hasOwnProperty(A)&&!MF.includes(A);function Rc(A,j){if(!j)return null;let e=j.trim();if(e.length===0)return null;let t=A==="selector"?"_":"$";if(A==="directory"){if(NF.test(e))return null}else _F.test(e)||(e=t+e);return e=e.replace(DF,"_"),e=e.replace(/_+/gu,"_"),e=e.replace(/^\$_/u,t),e}function Bo(A){return Rc("variable",A)}function cQ(A){let j=Rc("selector",A);return j&&(j=j.replace(/^\$/gu,"_")),j}function jB(A){return Rc("directory",A)}function eB(A){let e=Bo(A)||"MyComponent",t=e+Pt,r=OF(e);return{name:t,content:r}}function OF(A){return`// Get Started: https://www.framer.com/developers

import { addPropertyControls, ControlType } from "framer"
import { motion } from "framer-motion"

/**
 * @framerSupportedLayoutWidth auto
 * @framerSupportedLayoutHeight auto
 */
export default function ${A}(props) {
    const { tint } = props

    return (
        <motion.div
            style={{
                margin: 50,
                width: 100,
                height: 100,
                borderRadius: 25,
                backgroundColor: tint,
            }}
            animate={{ scale: 1.5 }}
            whileHover={{ rotate: 90 }}
        />
    )
}

addPropertyControls(${A}, {
    tint: {
        title: "Tint",
        type: ControlType.Color,
        defaultValue: "#09F",
    },
})
`}function wF(A){return`import { forwardRef, type ComponentType } from "react"
import { createStore } from "https://framer.com/m/framer/store.js@^1.0.0"
import { randomColor } from "https://framer.com/m/framer/utils.js@^0.9.0"

// Learn more: https://www.framer.com/developers/overrides/

const useStore = createStore({
    background: "#0099FF",
})

export function withRotate(Component): ComponentType {
    return forwardRef((props, ref) => {
        return (
            <Component
                ref={ref}
                {...props}
                animate={{ rotate: 90 }}
                transition={{ duration: 2 }}
            />
        )
    })
}

export function withHover(Component): ComponentType {
    return forwardRef((props, ref) => {
        return <Component ref={ref} {...props} whileHover={{ scale: 1.05 }} />
    })
}

export function withRandomColor(Component): ComponentType {
    return forwardRef((props, ref) => {
        const [store, setStore] = useStore()

        return (
            <Component
                ref={ref}
                {...props}
                animate={{
                    background: store.background,
                }}
                onClick={() => {
                    setStore({ background: randomColor() })
                }}
            />
        )
    })
}
`}function tB(A){let e=Bo(A)||"MyOverrides",t=e+Pt,r=wF(e);return{name:t,content:r}}function On(A){return A.endsWith(".json")?!0:/\.[tj]sx?$/u.test(A)}var LF=/^(?:[\w-]+\/)*[\w-]+(?:\.[\w-]+)*$/u;function FQ(A){let{path:j}=rB(A);return LF.test(j)}function qF(A,j){if(On(A))return A;let[e,t]=fi(j);return t&&(t=`.${t}`),(!t||!On(t))&&(t=Pt),A+t}function GQ(A){return On(A)||(A+=".tsx"),A}function KF(A){let j=A.lastIndexOf("/");return j<0?"":A.slice(0,j)}function VF(A){let j=A.lastIndexOf("/")+1;return A.slice(j)}function Ic(...A){let j="";return A.forEach(e=>{for(;e.startsWith("/");)e=e.slice(1);for(;e.endsWith("/");)e=e.slice(0,-1);e!==""&&(j!==""&&(j+="/"),j+=e)}),j}function rB(A,j=!0){A=A.trim();let[e,t]=fi(VF(A));t&&(t=`.${t}`);let r=KF(A).split("/").map(a=>jB(a)).filter(a=>!!a).join("/"),o=Bo(e)||"MyComponent";return(!On(t)||t===Pt)&&j&&(o=s7(o)),{path:Ic(r,o+t),dirName:r,name:o,extension:t}}function SQ(A,j="component"){A=A.trim();let{dirName:e,name:t,extension:r}=rB(A);if(On(r)&&r!==Pt){let a=t+r;return{path:Ic(e,a),content:""}}let o=j==="component"?eB(t):tB(t),n=qF(t+r,o.name);return{path:Ic(e,n),content:o.content}}function wn(A,j){if(!A.has(j))return j;let e=1,t,[r,o]=fi(j);o&&(o=`.${o}`);do t=r+"_"+String(e++)+o;while(A.has(t));return t}function Fc(A){let j=Array.isArray(A)?A:Object.values(A);return new Set(j.map(e=>e.path))}function yQ(A){return A==="typescript"||A==="javascript"}function Gc(A){let j={};for(let[e,t]of A)iB(j,e,t);return j}function go(A,j,e){return XA(A,t=>{iB(t,j,e)})}function us(A,j){return A[j]?XA(A,e=>{let t=e[j];if(t){for(let r of t.dependents){let o=e[r];o&&(o.dependencies.delete(j),ks(o)&&delete e[r])}for(let r of t.dependencies){let o=e[r];o&&(o.dependents.delete(j),ks(o)&&delete e[r])}delete e[j]}}):A}function Sr(A,j,e,t,r){let o=new Set,n=[j];for(t=t||new Set,r=r||new Set;n.length>0;){let a=n.pop();if(!a||o.has(a))continue;o.add(a);let i=A[a];if(i){if(t.has(a))r.add(a);else if(!t.size)e.add(a);else{let s=!1;for(let c of i.dependents)if(t.has(c)||r.has(c)){s=!0;break}s?r.add(a):e.add(a)}for(let s of i.dependents)o.has(s)||n.push(s)}}}function nB(A,j){let e=new Set,t=[j];for(;HF(t);){let r=t.shift(),o=A[r];if(o){for(let n of o.dependents)e.has(n)||(e.add(n),t.push(n));if(e.has(j))return!0}}return!1}function JF(A,j){let e=ce(A,j);if(e)return e.startsWith("collection")&&!j.startsWith("collection")&&!j.startsWith("draftCollection")?e.replace("collection","draftCollection"):e}function iB(A,j,e){let t=A[j];if(!t){if(e.length===0)return;t=oB(A,j)}let r=new Set(t.dependencies);for(let o of e){let n=JF(o,j);if(!n)continue;t.dependencies.add(n);let a=A[n];a||(a=oB(A,n)),a.dependents.add(j),t.dependencies.add(n),r.delete(n)}for(let o of r){let n=A[o];n&&(n.dependents.delete(j),ks(n)&&delete A[o])}ks(t)&&delete A[j]}function ks(A){return A.dependents.size===0&&A.dependencies.size===0}function oB(A,j){let e={dependents:new Set,dependencies:new Set};return A[j]=e,e}function HF(A){return A.length>0}var QF=1;function UF(A){return A==="screen"||A==="canvasComponent"}function Sc(A){let j=A.metadata.compatibleCmsVersion;return Z(j)?j:0}function WF(A){let j=bA(A);return A.imports.relative.some(e=>{let t=ce(e,j);return M(t)&&t.startsWith("collection")})}function yc(A){return UF(A.type)&&WF(A)}function xQ(A){return yc(A)&&Sc(A)<QF}var ho,Ln,Ro=class{constructor(j){this.limit=j;xA(this,ho,0);xA(this,Ln,[])}async run(j,e){if(tA(this,ho)===this.limit){let t=new Promise(r=>{tA(this,Ln).push(r)});e&&(t=Promise.race([t,zF(e)])),await t}sB(e),Ns(this,ho)._++;try{return await j()}finally{Ns(this,ho)._--,tA(this,Ln).shift()?.()}}};ho=new WeakMap,Ln=new WeakMap;var aB=new WeakMap;function zF(A){let j=aB.get(A);return j||(sB(A),j=new Promise((e,t)=>{A.addEventListener("abort",()=>{t(A.reason)},{once:!0})}),aB.set(A,j)),j}function sB(A){if(A?.aborted)throw A.reason}function qn(A){let j=new Set;if(!A)return j;if(J(A)&&Y7(A)){let e=lB(A.layoutTemplateIdentifier);e&&j.add(e)}for(let{node:e,skipChildren:t}of A.walkWithSkipChildren()){if(!z(e))continue;if(hA(e)){t();continue}let r=lB(e.codeComponentIdentifier);r&&j.add(r)}return j}function lB(A){let j=jA(A);if(!(!j||!KA(j)))return bA({type:j.type,name:j.localIdName})}var cB;(function(A){A[A.Static=1]="Static",A[A.Dynamic=2]="Dynamic",A[A.ImportMeta=3]="ImportMeta",A[A.StaticSourcePhase=4]="StaticSourcePhase",A[A.DynamicSourcePhase=5]="DynamicSourcePhase"})(cB||(cB={}));var XF=new Uint8Array(new Uint16Array([1]).buffer)[0]===1;function Cc(A,j="@"){if(!NA)return vc.then(()=>Cc(A));let e=A.length+1,t=(NA.__heap_base.value||NA.__heap_base)+4*e-NA.memory.buffer.byteLength;t>0&&NA.memory.grow(Math.ceil(t/65536));let r=NA.sa(e-1);if((XF?ZF:YF)(A,new Uint16Array(NA.memory.buffer,r,e)),!NA.parse())throw Object.assign(new Error(`Parse error ${j}:${A.slice(0,NA.e()).split(`
`).length}:${NA.e()-A.lastIndexOf(`
`,NA.e()-1)}`),{idx:NA.e()});let o=[],n=[];for(;NA.ri();){let i=NA.is(),s=NA.ie(),c=NA.it(),d=NA.ai(),p=NA.id(),k=NA.ss(),$=NA.se(),g;NA.ip()&&(g=a(A.slice(p===-1?i-1:i,p===-1?s+1:s))),o.push({n:g,t:c,s:i,e:s,ss:k,se:$,d:p,a:d})}for(;NA.re();){let i=NA.es(),s=NA.ee(),c=NA.els(),d=NA.ele(),p=A.slice(i,s),k=p[0],$=c<0?void 0:A.slice(c,d),g=$?$[0]:"";n.push({s:i,e:s,ls:c,le:d,n:k==='"'||k==="'"?a(p):p,ln:g==='"'||g==="'"?a($):$})}function a(i){try{return(0,eval)(i)}catch{}}return[o,n,!!NA.f(),!!NA.ms()]}function YF(A,j){let e=A.length,t=0;for(;t<e;){let r=A.charCodeAt(t);j[t++]=(255&r)<<8|r>>>8}}function ZF(A,j){let e=A.length,t=0;for(;t<e;)j[t]=A.charCodeAt(t++)}var NA,vc=WebAssembly.compile((bc="AGFzbQEAAAABKwhgAX8Bf2AEf39/fwBgAAF/YAAAYAF/AGADf39/AX9gAn9/AX9gA39/fwADMTAAAQECAgICAgICAgICAgICAgICAgIAAwMDBAQAAAUAAAAAAAMDAwAGAAAABwAGAgUEBQFwAQEBBQMBAAEGDwJ/AUHA8gALfwBBwPIACwd6FQZtZW1vcnkCAAJzYQAAAWUAAwJpcwAEAmllAAUCc3MABgJzZQAHAml0AAgCYWkACQJpZAAKAmlwAAsCZXMADAJlZQANA2VscwAOA2VsZQAPAnJpABACcmUAEQFmABICbXMAEwVwYXJzZQAUC19faGVhcF9iYXNlAwEKm0EwaAEBf0EAIAA2AoAKQQAoAtwJIgEgAEEBdGoiAEEAOwEAQQAgAEECaiIANgKECkEAIAA2AogKQQBBADYC4AlBAEEANgLwCUEAQQA2AugJQQBBADYC5AlBAEEANgL4CUEAQQA2AuwJIAEL0wEBA39BACgC8AkhBEEAQQAoAogKIgU2AvAJQQAgBDYC9AlBACAFQSRqNgKICiAEQSBqQeAJIAQbIAU2AgBBACgC1AkhBEEAKALQCSEGIAUgATYCACAFIAA2AgggBSACIAJBAmpBACAGIANGIgAbIAQgA0YiBBs2AgwgBSADNgIUIAVBADYCECAFIAI2AgQgBUEANgIgIAVBA0EBQQIgABsgBBs2AhwgBUEAKALQCSADRiICOgAYAkACQCACDQBBACgC1AkgA0cNAQtBAEEBOgCMCgsLXgEBf0EAKAL4CSIEQRBqQeQJIAQbQQAoAogKIgQ2AgBBACAENgL4CUEAIARBFGo2AogKQQBBAToAjAogBEEANgIQIAQgAzYCDCAEIAI2AgggBCABNgIEIAQgADYCAAsIAEEAKAKQCgsVAEEAKALoCSgCAEEAKALcCWtBAXULHgEBf0EAKALoCSgCBCIAQQAoAtwJa0EBdUF/IAAbCxUAQQAoAugJKAIIQQAoAtwJa0EBdQseAQF/QQAoAugJKAIMIgBBACgC3AlrQQF1QX8gABsLCwBBACgC6AkoAhwLHgEBf0EAKALoCSgCECIAQQAoAtwJa0EBdUF/IAAbCzsBAX8CQEEAKALoCSgCFCIAQQAoAtAJRw0AQX8PCwJAIABBACgC1AlHDQBBfg8LIABBACgC3AlrQQF1CwsAQQAoAugJLQAYCxUAQQAoAuwJKAIAQQAoAtwJa0EBdQsVAEEAKALsCSgCBEEAKALcCWtBAXULHgEBf0EAKALsCSgCCCIAQQAoAtwJa0EBdUF/IAAbCx4BAX9BACgC7AkoAgwiAEEAKALcCWtBAXVBfyAAGwslAQF/QQBBACgC6AkiAEEgakHgCSAAGygCACIANgLoCSAAQQBHCyUBAX9BAEEAKALsCSIAQRBqQeQJIAAbKAIAIgA2AuwJIABBAEcLCABBAC0AlAoLCABBAC0AjAoL3Q0BBX8jAEGA0ABrIgAkAEEAQQE6AJQKQQBBACgC2Ak2ApwKQQBBACgC3AlBfmoiATYCsApBACABQQAoAoAKQQF0aiICNgK0CkEAQQA6AIwKQQBBADsBlgpBAEEAOwGYCkEAQQA6AKAKQQBBADYCkApBAEEAOgD8CUEAIABBgBBqNgKkCkEAIAA2AqgKQQBBADoArAoCQAJAAkACQANAQQAgAUECaiIDNgKwCiABIAJPDQECQCADLwEAIgJBd2pBBUkNAAJAAkACQAJAAkAgAkGbf2oOBQEICAgCAAsgAkEgRg0EIAJBL0YNAyACQTtGDQIMBwtBAC8BmAoNASADEBVFDQEgAUEEakGCCEEKEC8NARAWQQAtAJQKDQFBAEEAKAKwCiIBNgKcCgwHCyADEBVFDQAgAUEEakGMCEEKEC8NABAXC0EAQQAoArAKNgKcCgwBCwJAIAEvAQQiA0EqRg0AIANBL0cNBBAYDAELQQEQGQtBACgCtAohAkEAKAKwCiEBDAALC0EAIQIgAyEBQQAtAPwJDQIMAQtBACABNgKwCkEAQQA6AJQKCwNAQQAgAUECaiIDNgKwCgJAAkACQAJAAkACQAJAIAFBACgCtApPDQAgAy8BACICQXdqQQVJDQYCQAJAAkACQAJAAkACQAJAAkACQCACQWBqDgoQDwYPDw8PBQECAAsCQAJAAkACQCACQaB/ag4KCxISAxIBEhISAgALIAJBhX9qDgMFEQYJC0EALwGYCg0QIAMQFUUNECABQQRqQYIIQQoQLw0QEBYMEAsgAxAVRQ0PIAFBBGpBjAhBChAvDQ8QFwwPCyADEBVFDQ4gASkABELsgISDsI7AOVINDiABLwEMIgNBd2oiAUEXSw0MQQEgAXRBn4CABHFFDQwMDQtBAEEALwGYCiIBQQFqOwGYCkEAKAKkCiABQQN0aiIBQQE2AgAgAUEAKAKcCjYCBAwNC0EALwGYCiIDRQ0JQQAgA0F/aiIDOwGYCkEALwGWCiICRQ0MQQAoAqQKIANB//8DcUEDdGooAgBBBUcNDAJAIAJBAnRBACgCqApqQXxqKAIAIgMoAgQNACADQQAoApwKQQJqNgIEC0EAIAJBf2o7AZYKIAMgAUEEajYCDAwMCwJAQQAoApwKIgEvAQBBKUcNAEEAKALwCSIDRQ0AIAMoAgQgAUcNAEEAQQAoAvQJIgM2AvAJAkAgA0UNACADQQA2AiAMAQtBAEEANgLgCQtBAEEALwGYCiIDQQFqOwGYCkEAKAKkCiADQQN0aiIDQQZBAkEALQCsChs2AgAgAyABNgIEQQBBADoArAoMCwtBAC8BmAoiAUUNB0EAIAFBf2oiATsBmApBACgCpAogAUH//wNxQQN0aigCAEEERg0EDAoLQScQGgwJC0EiEBoMCAsgAkEvRw0HAkACQCABLwEEIgFBKkYNACABQS9HDQEQGAwKC0EBEBkMCQsCQAJAAkACQEEAKAKcCiIBLwEAIgMQG0UNAAJAAkAgA0FVag4EAAkBAwkLIAFBfmovAQBBK0YNAwwICyABQX5qLwEAQS1GDQIMBwsgA0EpRw0BQQAoAqQKQQAvAZgKIgJBA3RqKAIEEBxFDQIMBgsgAUF+ai8BAEFQakH//wNxQQpPDQULQQAvAZgKIQILAkACQCACQf//A3EiAkUNACADQeYARw0AQQAoAqQKIAJBf2pBA3RqIgQoAgBBAUcNACABQX5qLwEAQe8ARw0BIAQoAgRBlghBAxAdRQ0BDAULIANB/QBHDQBBACgCpAogAkEDdGoiAigCBBAeDQQgAigCAEEGRg0ECyABEB8NAyADRQ0DIANBL0ZBAC0AoApBAEdxDQMCQEEAKAL4CSICRQ0AIAEgAigCAEkNACABIAIoAgRNDQQLIAFBfmohAUEAKALcCSECAkADQCABQQJqIgQgAk0NAUEAIAE2ApwKIAEvAQAhAyABQX5qIgQhASADECBFDQALIARBAmohBAsCQCADQf//A3EQIUUNACAEQX5qIQECQANAIAFBAmoiAyACTQ0BQQAgATYCnAogAS8BACEDIAFBfmoiBCEBIAMQIQ0ACyAEQQJqIQMLIAMQIg0EC0EAQQE6AKAKDAcLQQAoAqQKQQAvAZgKIgFBA3QiA2pBACgCnAo2AgRBACABQQFqOwGYCkEAKAKkCiADakEDNgIACxAjDAULQQAtAPwJQQAvAZYKQQAvAZgKcnJFIQIMBwsQJEEAQQA6AKAKDAMLECVBACECDAULIANBoAFHDQELQQBBAToArAoLQQBBACgCsAo2ApwKC0EAKAKwCiEBDAALCyAAQYDQAGokACACCxoAAkBBACgC3AkgAEcNAEEBDwsgAEF+ahAmC/4KAQZ/QQBBACgCsAoiAEEMaiIBNgKwCkEAKAL4CSECQQEQKSEDAkACQAJAAkACQAJAAkACQAJAQQAoArAKIgQgAUcNACADEChFDQELAkACQAJAAkACQAJAAkAgA0EqRg0AIANB+wBHDQFBACAEQQJqNgKwCkEBECkhA0EAKAKwCiEEA0ACQAJAIANB//8DcSIDQSJGDQAgA0EnRg0AIAMQLBpBACgCsAohAwwBCyADEBpBAEEAKAKwCkECaiIDNgKwCgtBARApGgJAIAQgAxAtIgNBLEcNAEEAQQAoArAKQQJqNgKwCkEBECkhAwsgA0H9AEYNA0EAKAKwCiIFIARGDQ8gBSEEIAVBACgCtApNDQAMDwsLQQAgBEECajYCsApBARApGkEAKAKwCiIDIAMQLRoMAgtBAEEAOgCUCgJAAkACQAJAAkACQCADQZ9/ag4MAgsEAQsDCwsLCwsFAAsgA0H2AEYNBAwKC0EAIARBDmoiAzYCsAoCQAJAAkBBARApQZ9/ag4GABICEhIBEgtBACgCsAoiBSkAAkLzgOSD4I3AMVINESAFLwEKECFFDRFBACAFQQpqNgKwCkEAECkaC0EAKAKwCiIFQQJqQbIIQQ4QLw0QIAUvARAiAkF3aiIBQRdLDQ1BASABdEGfgIAEcUUNDQwOC0EAKAKwCiIFKQACQuyAhIOwjsA5Ug0PIAUvAQoiAkF3aiIBQRdNDQYMCgtBACAEQQpqNgKwCkEAECkaQQAoArAKIQQLQQAgBEEQajYCsAoCQEEBECkiBEEqRw0AQQBBACgCsApBAmo2ArAKQQEQKSEEC0EAKAKwCiEDIAQQLBogA0EAKAKwCiIEIAMgBBACQQBBACgCsApBfmo2ArAKDwsCQCAEKQACQuyAhIOwjsA5Ug0AIAQvAQoQIEUNAEEAIARBCmo2ArAKQQEQKSEEQQAoArAKIQMgBBAsGiADQQAoArAKIgQgAyAEEAJBAEEAKAKwCkF+ajYCsAoPC0EAIARBBGoiBDYCsAoLQQAgBEEGajYCsApBAEEAOgCUCkEBECkhBEEAKAKwCiEDIAQQLCEEQQAoArAKIQIgBEHf/wNxIgFB2wBHDQNBACACQQJqNgKwCkEBECkhBUEAKAKwCiEDQQAhBAwEC0EAQQE6AIwKQQBBACgCsApBAmo2ArAKC0EBECkhBEEAKAKwCiEDAkAgBEHmAEcNACADQQJqQawIQQYQLw0AQQAgA0EIajYCsAogAEEBEClBABArIAJBEGpB5AkgAhshAwNAIAMoAgAiA0UNBSADQgA3AgggA0EQaiEDDAALC0EAIANBfmo2ArAKDAMLQQEgAXRBn4CABHFFDQMMBAtBASEECwNAAkACQCAEDgIAAQELIAVB//8DcRAsGkEBIQQMAQsCQAJAQQAoArAKIgQgA0YNACADIAQgAyAEEAJBARApIQQCQCABQdsARw0AIARBIHJB/QBGDQQLQQAoArAKIQMCQCAEQSxHDQBBACADQQJqNgKwCkEBECkhBUEAKAKwCiEDIAVBIHJB+wBHDQILQQAgA0F+ajYCsAoLIAFB2wBHDQJBACACQX5qNgKwCg8LQQAhBAwACwsPCyACQaABRg0AIAJB+wBHDQQLQQAgBUEKajYCsApBARApIgVB+wBGDQMMAgsCQCACQVhqDgMBAwEACyACQaABRw0CC0EAIAVBEGo2ArAKAkBBARApIgVBKkcNAEEAQQAoArAKQQJqNgKwCkEBECkhBQsgBUEoRg0BC0EAKAKwCiEBIAUQLBpBACgCsAoiBSABTQ0AIAQgAyABIAUQAkEAQQAoArAKQX5qNgKwCg8LIAQgA0EAQQAQAkEAIARBDGo2ArAKDwsQJQvcCAEGf0EAIQBBAEEAKAKwCiIBQQxqIgI2ArAKQQEQKSEDQQAoArAKIQQCQAJAAkACQAJAAkACQAJAIANBLkcNAEEAIARBAmo2ArAKAkBBARApIgNB8wBGDQAgA0HtAEcNB0EAKAKwCiIDQQJqQZwIQQYQLw0HAkBBACgCnAoiBBAqDQAgBC8BAEEuRg0ICyABIAEgA0EIakEAKALUCRABDwtBACgCsAoiA0ECakGiCEEKEC8NBgJAQQAoApwKIgQQKg0AIAQvAQBBLkYNBwsgA0EMaiEDDAELIANB8wBHDQEgBCACTQ0BQQYhAEEAIQIgBEECakGiCEEKEC8NAiAEQQxqIQMCQCAELwEMIgVBd2oiBEEXSw0AQQEgBHRBn4CABHENAQsgBUGgAUcNAgtBACADNgKwCkEBIQBBARApIQMLAkACQAJAAkAgA0H7AEYNACADQShHDQFBACgCpApBAC8BmAoiA0EDdGoiBEEAKAKwCjYCBEEAIANBAWo7AZgKIARBBTYCAEEAKAKcCi8BAEEuRg0HQQBBACgCsAoiBEECajYCsApBARApIQMgAUEAKAKwCkEAIAQQAQJAAkAgAA0AQQAoAvAJIQQMAQtBACgC8AkiBEEFNgIcC0EAQQAvAZYKIgBBAWo7AZYKQQAoAqgKIABBAnRqIAQ2AgACQCADQSJGDQAgA0EnRg0AQQBBACgCsApBfmo2ArAKDwsgAxAaQQBBACgCsApBAmoiAzYCsAoCQAJAAkBBARApQVdqDgQBAgIAAgtBAEEAKAKwCkECajYCsApBARApGkEAKALwCSIEIAM2AgQgBEEBOgAYIARBACgCsAoiAzYCEEEAIANBfmo2ArAKDwtBACgC8AkiBCADNgIEIARBAToAGEEAQQAvAZgKQX9qOwGYCiAEQQAoArAKQQJqNgIMQQBBAC8BlgpBf2o7AZYKDwtBAEEAKAKwCkF+ajYCsAoPCyAADQJBACgCsAohA0EALwGYCg0BA0ACQAJAAkAgA0EAKAK0Ck8NAEEBECkiA0EiRg0BIANBJ0YNASADQf0ARw0CQQBBACgCsApBAmo2ArAKC0EBECkhBEEAKAKwCiEDAkAgBEHmAEcNACADQQJqQawIQQYQLw0JC0EAIANBCGo2ArAKAkBBARApIgNBIkYNACADQSdHDQkLIAEgA0EAECsPCyADEBoLQQBBACgCsApBAmoiAzYCsAoMAAsLIAANAUEGIQBBACECAkAgA0FZag4EBAMDBAALIANBIkYNAwwCC0EAIANBfmo2ArAKDwtBDCEAQQEhAgtBACgCsAoiAyABIABBAXRqRw0AQQAgA0F+ajYCsAoPC0EALwGYCg0CQQAoArAKIQNBACgCtAohAANAIAMgAE8NAQJAAkAgAy8BACIEQSdGDQAgBEEiRw0BCyABIAQgAhArDwtBACADQQJqIgM2ArAKDAALCxAlCw8LQQBBACgCsApBfmo2ArAKC0cBA39BACgCsApBAmohAEEAKAK0CiEBAkADQCAAIgJBfmogAU8NASACQQJqIQAgAi8BAEF2ag4EAQAAAQALC0EAIAI2ArAKC5gBAQN/QQBBACgCsAoiAUECajYCsAogAUEGaiEBQQAoArQKIQIDQAJAAkACQCABQXxqIAJPDQAgAUF+ai8BACEDAkACQCAADQAgA0EqRg0BIANBdmoOBAIEBAIECyADQSpHDQMLIAEvAQBBL0cNAkEAIAFBfmo2ArAKDAELIAFBfmohAQtBACABNgKwCg8LIAFBAmohAQwACwuIAQEEf0EAKAKwCiEBQQAoArQKIQICQAJAA0AgASIDQQJqIQEgAyACTw0BIAEvAQAiBCAARg0CAkAgBEHcAEYNACAEQXZqDgQCAQECAQsgA0EEaiEBIAMvAQRBDUcNACADQQZqIAEgAy8BBkEKRhshAQwACwtBACABNgKwChAlDwtBACABNgKwCgtsAQF/AkACQCAAQV9qIgFBBUsNAEEBIAF0QTFxDQELIABBRmpB//8DcUEGSQ0AIABBKUcgAEFYakH//wNxQQdJcQ0AAkAgAEGlf2oOBAEAAAEACyAAQf0ARyAAQYV/akH//wNxQQRJcQ8LQQELLgEBf0EBIQECQCAAQaYJQQUQHQ0AIABBlghBAxAdDQAgAEGwCUECEB0hAQsgAQtGAQN/QQAhAwJAIAAgAkEBdCICayIEQQJqIgBBACgC3AkiBUkNACAAIAEgAhAvDQACQCAAIAVHDQBBAQ8LIAQQJiEDCyADC4MBAQJ/QQEhAQJAAkACQAJAAkACQCAALwEAIgJBRWoOBAUEBAEACwJAIAJBm39qDgQDBAQCAAsgAkEpRg0EIAJB+QBHDQMgAEF+akG8CUEGEB0PCyAAQX5qLwEAQT1GDwsgAEF+akG0CUEEEB0PCyAAQX5qQcgJQQMQHQ8LQQAhAQsgAQu0AwECf0EAIQECQAJAAkACQAJAAkACQAJAAkACQCAALwEAQZx/ag4UAAECCQkJCQMJCQQFCQkGCQcJCQgJCwJAAkAgAEF+ai8BAEGXf2oOBAAKCgEKCyAAQXxqQcoIQQIQHQ8LIABBfGpBzghBAxAdDwsCQAJAAkAgAEF+ai8BAEGNf2oOAwABAgoLAkAgAEF8ai8BACICQeEARg0AIAJB7ABHDQogAEF6akHlABAnDwsgAEF6akHjABAnDwsgAEF8akHUCEEEEB0PCyAAQXxqQdwIQQYQHQ8LIABBfmovAQBB7wBHDQYgAEF8ai8BAEHlAEcNBgJAIABBemovAQAiAkHwAEYNACACQeMARw0HIABBeGpB6AhBBhAdDwsgAEF4akH0CEECEB0PCyAAQX5qQfgIQQQQHQ8LQQEhASAAQX5qIgBB6QAQJw0EIABBgAlBBRAdDwsgAEF+akHkABAnDwsgAEF+akGKCUEHEB0PCyAAQX5qQZgJQQQQHQ8LAkAgAEF+ai8BACICQe8ARg0AIAJB5QBHDQEgAEF8akHuABAnDwsgAEF8akGgCUEDEB0hAQsgAQs0AQF/QQEhAQJAIABBd2pB//8DcUEFSQ0AIABBgAFyQaABRg0AIABBLkcgABAocSEBCyABCzABAX8CQAJAIABBd2oiAUEXSw0AQQEgAXRBjYCABHENAQsgAEGgAUYNAEEADwtBAQtOAQJ/QQAhAQJAAkAgAC8BACICQeUARg0AIAJB6wBHDQEgAEF+akH4CEEEEB0PCyAAQX5qLwEAQfUARw0AIABBfGpB3AhBBhAdIQELIAEL3gEBBH9BACgCsAohAEEAKAK0CiEBAkACQAJAA0AgACICQQJqIQAgAiABTw0BAkACQAJAIAAvAQAiA0Gkf2oOBQIDAwMBAAsgA0EkRw0CIAIvAQRB+wBHDQJBACACQQRqIgA2ArAKQQBBAC8BmAoiAkEBajsBmApBACgCpAogAkEDdGoiAkEENgIAIAIgADYCBA8LQQAgADYCsApBAEEALwGYCkF/aiIAOwGYCkEAKAKkCiAAQf//A3FBA3RqKAIAQQNHDQMMBAsgAkEEaiEADAALC0EAIAA2ArAKCxAlCwtwAQJ/AkACQANAQQBBACgCsAoiAEECaiIBNgKwCiAAQQAoArQKTw0BAkACQAJAIAEvAQAiAUGlf2oOAgECAAsCQCABQXZqDgQEAwMEAAsgAUEvRw0CDAQLEC4aDAELQQAgAEEEajYCsAoMAAsLECULCzUBAX9BAEEBOgD8CUEAKAKwCiEAQQBBACgCtApBAmo2ArAKQQAgAEEAKALcCWtBAXU2ApAKC0MBAn9BASEBAkAgAC8BACICQXdqQf//A3FBBUkNACACQYABckGgAUYNAEEAIQEgAhAoRQ0AIAJBLkcgABAqcg8LIAELPQECf0EAIQICQEEAKALcCSIDIABLDQAgAC8BACABRw0AAkAgAyAARw0AQQEPCyAAQX5qLwEAECAhAgsgAgtoAQJ/QQEhAQJAAkAgAEFfaiICQQVLDQBBASACdEExcQ0BCyAAQfj/A3FBKEYNACAAQUZqQf//A3FBBkkNAAJAIABBpX9qIgJBA0sNACACQQFHDQELIABBhX9qQf//A3FBBEkhAQsgAQucAQEDf0EAKAKwCiEBAkADQAJAAkAgAS8BACICQS9HDQACQCABLwECIgFBKkYNACABQS9HDQQQGAwCCyAAEBkMAQsCQAJAIABFDQAgAkF3aiIBQRdLDQFBASABdEGfgIAEcUUNAQwCCyACECFFDQMMAQsgAkGgAUcNAgtBAEEAKAKwCiIDQQJqIgE2ArAKIANBACgCtApJDQALCyACCzEBAX9BACEBAkAgAC8BAEEuRw0AIABBfmovAQBBLkcNACAAQXxqLwEAQS5GIQELIAELnAQBAX8CQCABQSJGDQAgAUEnRg0AECUPC0EAKAKwCiEDIAEQGiAAIANBAmpBACgCsApBACgC0AkQAQJAIAJFDQBBACgC8AlBBDYCHAtBAEEAKAKwCkECajYCsAoCQAJAAkACQEEAECkiAUHhAEYNACABQfcARg0BQQAoArAKIQEMAgtBACgCsAoiAUECakHACEEKEC8NAUEGIQAMAgtBACgCsAoiAS8BAkHpAEcNACABLwEEQfQARw0AQQQhACABLwEGQegARg0BC0EAIAFBfmo2ArAKDwtBACABIABBAXRqNgKwCgJAQQEQKUH7AEYNAEEAIAE2ArAKDwtBACgCsAoiAiEAA0BBACAAQQJqNgKwCgJAAkACQEEBECkiAEEiRg0AIABBJ0cNAUEnEBpBAEEAKAKwCkECajYCsApBARApIQAMAgtBIhAaQQBBACgCsApBAmo2ArAKQQEQKSEADAELIAAQLCEACwJAIABBOkYNAEEAIAE2ArAKDwtBAEEAKAKwCkECajYCsAoCQEEBECkiAEEiRg0AIABBJ0YNAEEAIAE2ArAKDwsgABAaQQBBACgCsApBAmo2ArAKAkACQEEBECkiAEEsRg0AIABB/QBGDQFBACABNgKwCg8LQQBBACgCsApBAmo2ArAKQQEQKUH9AEYNAEEAKAKwCiEADAELC0EAKALwCSIBIAI2AhAgAUEAKAKwCkECajYCDAttAQJ/AkACQANAAkAgAEH//wNxIgFBd2oiAkEXSw0AQQEgAnRBn4CABHENAgsgAUGgAUYNASAAIQIgARAoDQJBACECQQBBACgCsAoiAEECajYCsAogAC8BAiIADQAMAgsLIAAhAgsgAkH//wNxC6sBAQR/AkACQEEAKAKwCiICLwEAIgNB4QBGDQAgASEEIAAhBQwBC0EAIAJBBGo2ArAKQQEQKSECQQAoArAKIQUCQAJAIAJBIkYNACACQSdGDQAgAhAsGkEAKAKwCiEEDAELIAIQGkEAQQAoArAKQQJqIgQ2ArAKC0EBECkhA0EAKAKwCiECCwJAIAIgBUYNACAFIARBACAAIAAgAUYiAhtBACABIAIbEAILIAMLcgEEf0EAKAKwCiEAQQAoArQKIQECQAJAA0AgAEECaiECIAAgAU8NAQJAAkAgAi8BACIDQaR/ag4CAQQACyACIQAgA0F2ag4EAgEBAgELIABBBGohAAwACwtBACACNgKwChAlQQAPC0EAIAI2ArAKQd0AC0kBA39BACEDAkAgAkUNAAJAA0AgAC0AACIEIAEtAAAiBUcNASABQQFqIQEgAEEBaiEAIAJBf2oiAg0ADAILCyAEIAVrIQMLIAMLC+wBAgBBgAgLzgEAAHgAcABvAHIAdABtAHAAbwByAHQAZgBvAHIAZQB0AGEAbwB1AHIAYwBlAHIAbwBtAHUAbgBjAHQAaQBvAG4AcwBzAGUAcgB0AHYAbwB5AGkAZQBkAGUAbABlAGMAbwBuAHQAaQBuAGkAbgBzAHQAYQBuAHQAeQBiAHIAZQBhAHIAZQB0AHUAcgBkAGUAYgB1AGcAZwBlAGEAdwBhAGkAdABoAHIAdwBoAGkAbABlAGkAZgBjAGEAdABjAGYAaQBuAGEAbABsAGUAbABzAABB0AkLEAEAAAACAAAAAAQAAEA5AAA=",typeof Buffer<"u"?Buffer.from(bc,"base64"):Uint8Array.from(atob(bc),A=>A.charCodeAt(0)))).then(WebAssembly.instantiate).then(({exports:A})=>{NA=A}),bc;function Tc(A){return A!==void 0?{ok:!0,value:A}:{ok:!0}}function Pc(A){return{ok:!1,error:A}}function dB(A){return A.then(j=>Tc(j),j=>Pc(j))}var AG=/^\s*(['"](\..*)['"])\s*$/mu,Kn=class extends Error{constructor(e){super();this.persistedMissingRelativeImports=e;this.name="RewriteRelativeImportsError"}};function ms(A){return A instanceof Kn}async function Es(A,j){await vc;let[e]=Cc(A),t=A,r=new Set,o=[...e].reverse();for(let{s:n,e:a,d:i}of o){if(i===-2)continue;if(i===-1){let G=A.substring(n,a);if(!G.startsWith("."))continue;let I=j[G];I===void 0&&(r.add(G),I=kB(G)),t=pB(t,I,n,a);continue}let s=A.substring(n,a),d=s.replace(/\/\*[\s\S]*?\*\/|([^\\:]|^)\/\/.*$/gm,"$1").trim().match(AG);if(!d)continue;let p=d[1],k=d[2];if(p===void 0||k===void 0)continue;let $=j[k];$===void 0&&(r.add(k),$=kB(k));let g=s.replace(new RegExp(Mc(p),"g"),JSON.stringify($));t=pB(t,g,n,a)}return r.size>0?Pc({partiallyProcessedCode:t,unresolvedRelativeImports:r,parsedImports:e}):Tc(t)}function pB(A,j,e,t){return A.slice(0,e)+j+A.slice(t)}function Mc(A){return A.replace(/[.*+\-?^${}()|[\]\\]/gu,"\\$&")}function kB(A){return`!missing/${A}`}var W=mA("modules-storage"),mB=Object.freeze({}),EB=Object.freeze({});function Oc(A){return A&&A.type==="codeFile"?(E(M(A.sourceContent),"code module entry is missing source content"),!0):!1}function _c(A){return A.name===Os&&A.type===Pd}function jG(A){return A.id===fe}function fB(A,j){return!!A&&A.saveId===j.saveId&&A.id===j.moduleId}var fs=class extends Error{constructor(){super("A circular dependency was detected."),this.name="CircularDependencyError"}},Vn="update-modules-storage",eG=0;async function HA(A){let j=performance.now(),e=`acquire-modules-storage-lock-${eG++}`;return pn(e),pl.request(Vn,()=>{let t=performance.now()-j;return ha(`\u{1F513} Acquire ${Vn} lock`,e),Ra(e),W.debug("\u{1F513} Acquired the",Vn,"lock in",t.toFixed(2),"ms"),t>1e3&&W.warn("\u2757 Long wait: it took",t.toFixed(0),"ms to acquire the",Vn,"lock."),A()})}var $s=class{constructor(j,e,t,r){this.storage=j;this.localId=e;this.type=t;this.debugModuleStoreAndComponentLoaderRevisionsMatch=r}get id(){let j=this.storage.getPersistedModuleByLocalId(this.localId);if(j)return j.id;let e=this.storage.getModuleTreeData(this.localId);return E(e,"Module must exist"),e.moduleId}get saveId(){let j=this.storage.getTransientSaveByLocalId(this.localId);if(j)return j.saveId;let e=this.storage.getPersistedModuleByLocalId(this.localId);return E(e,"Module must exist"),e.saveId}get transientSVGIcon(){let j=this.storage.getTransientSaveByLocalId(this.localId);if(j)return j.svgIcon}externalModuleIdentifier(j="default"){let e=this.storage.getTransientSaveByLocalId(this.localId);if(e){let r=Qj(e.name);return Yj(this.id,e.saveId,r.module,j)}let t=this.storage.getPersistedModuleByLocalId(this.localId);return E(t?.files.module,"ModulesStorage: Expected module typed file in persisted module."),Yj(this.id,t.saveId,t.files.module,j)}delete(){return this.storage.delete(this.localId)}publish(j,e,t){return this.storage.publish(this.localId,{namespace:j,name:e,version:t})}sourceRevision(){let j=this.storage.getTransientSaveByLocalId(this.localId);if(j)return j.sourceRevision;let e=this.storage.getPersistedModuleByLocalId(this.localId);if(e)return wc(e)}annotations(j,e){let t=this.storage.getTransientSaveByLocalId(this.localId),r=t?.annotations?eo(t.annotations):this.storage.getModuleTreeData(this.localId)?.annotations;return j&&this.debugModuleStoreAndComponentLoaderRevisionsMatch()&&tG(r,j),e?r?.[e]:r}},Nc=class extends $s{constructor(e,t,r,o,n){super(e,t,r,o);this.name=n}currentSourceEquals(e,t){let r=this.storage.getPersistedModuleByLocalId(this.localId);return!r||r.submodules.length||t.submodules?.size?!1:r.sourceContent===e}updateSource(e,t={}){return this.storage.updateSources([{localId:this.localId,source:e,options:{...t,stableName:!0}}])}persist(e){return this.storage.upsert(this.localId,{...e,type:this.type,name:this.name})}getKitSectionsStructure(){let e=this.storage.getTransientSaveByLocalId(this.localId);return e?e.kitSectionsStructure:this.storage.getKitSectionsStructure(this.name)}};function tG(A,j){if(!A)return;let e=jA(j.identifier);E(KA(e)&&aj(e),"Entity must have an identifier."),j.annotations&&e.exportSpecifier in A&&!gi(A[e.exportSpecifier],eo({default:j.annotations}).default,!0)&&W.reportError("Static annotations are not synchronized with runtime annotations.",{identifier:j.identifier})}function wc(A){let j=A?.metadata.sourceRevision;return Z(j)?j:void 0}var xc=class extends $s{updateSource(j,e){return this.storage.updateSources([{localId:this.localId,source:j,options:e??{}}])}persist(j){return this.storage.update(this.localId,j)}rename(j){return this.storage.rename(this.localId,j)}},Jn=class{constructor(j,e,t=()=>!0){this.storage=j;this.type=e;this.moduleStoreAndComponentLoaderRevisionsMatch=t}async create(j){return this.storage.create({...j,type:this.type})}getByStableName(j){return new Nc(this.storage,_e(this.type,j),this.type,this.moduleStoreAndComponentLoaderRevisionsMatch,j)}getByLocalId(j){return new xc(this.storage,j,this.type,this.moduleStoreAndComponentLoaderRevisionsMatch)}getUniqueName(j){return this.storage.getUniqueNameForType(this.type,j)}},Bs=class{constructor(j,e,t,r,o,n,a,i,s){this.getModulesService=j;this.compile=e;this.process=t;this.processWhenReady=r;this.signalNonUserEvent=o;this.runWhenIdle=n;this.treeStore=a;this.getActiveScope=i;this.makeDocumentReadOnly=s;R(this,"useTreeAsLocalModuleList",!1);R(this,"writeLocalModulesToTree",!1);R(this,"dependenciesModule");R(this,"persistedModules",new Map);R(this,"persistedLocalIdsByTypeSlashNameCache",new WeakMap);R(this,"transientSaves",new Map);R(this,"lastSnapshot",{dependenciesModule:void 0,modules:new Map,depsGraph:{},initialized:!1});R(this,"modulesService");R(this,"lazyServerModulesForTransientSaves",new Map);R(this,"backgroundJob",null);R(this,"backgroundAbortController",null);R(this,"initialized",!1);R(this,"initializationStarted",!1);R(this,"readOnlyTree",!1);R(this,"resolveInitialization",()=>{throw new Error("initializationPromise has not executed yet")});R(this,"rejectInitialization",()=>{throw new Error("initializationPromise has not executed yet")});R(this,"initializationPromise",new Promise((j,e)=>{this.resolveInitialization=j,this.rejectInitialization=e}));R(this,"didSetupModuleEventStream",!1);R(this,"transientInfo",null);R(this,"previousLocalModuleNodes",[]);R(this,"treeNodesToUpdate",new Map);R(this,"treeNodesToDelete",[]);R(this,"goingToStartUsingLocalModulesInTree",!1);R(this,"listeners",new Set);R(this,"transientSaveRetries",new Map);R(this,"transientSaveRelativeImportRetries",new Set);R(this,"downloadQueue",new Ro(1200))}hasPendingServerModules(){return this.lazyServerModulesForTransientSaves.size>0}processOnePendingServerModule(){return this.lazyServerModulesForTransientSaves.size===0?Promise.resolve(!1):HA(async()=>{for(let[,j]of this.lazyServerModulesForTransientSaves)for(let e of j){let t=this.persistedModules.get(e)?.localId;if(!t)continue;let r=this.persistedModules.get(t);if(r?.kind!=="server")continue;W.debug("\u{1F343} Process one server \u2192 local module",e);let o=await this.createLocalModuleFromModule(r),n=XA(this.persistedModules,a=>{a.set(r.localId,o)});return this.setNextInternalState({dependenciesModule:this.dependenciesModule,persistedModules:n,depsGraph:this.lastSnapshot.depsGraph,didRemoteChange:!1,transientSaves:this.transientSaves}),!0}return!1})}async changeScope(j){if(!this.hasPendingServerModules())return;let e=qn(j);!e||e.size===0||(await HA(async()=>{let t=new Set,r=this.lastSnapshot.depsGraph;for(let[i,s]of this.lazyServerModulesForTransientSaves)Sr(r,i,s,e,t);let o=[];for(let i of t){let s=this.getModuleWithTypeSlashName(i);s?.kind==="server"&&o.push(this.createLocalModuleFromModule(s))}if(W.debug("\u{1F343} Prioritizing making visible modules local after changing scope:",j.id,"/ Visible:",e,"/ Visible Dependencies:",t,"/ Server modules:",o.length),o.length===0)return;let n=await Promise.all(o),a=XA(this.persistedModules,i=>{for(let s of n)i.set(s.localId,s)});this.setNextInternalState({dependenciesModule:this.dependenciesModule,persistedModules:a,depsGraph:r,didRemoteChange:!1,transientSaves:this.transientSaves})}),this.makeLazyServerModulesLocalWhenIdle().catch(yA))}async makeVisibleDependentServerModulesLocal(j){if(!zA.isOn("prioritizedModuleEvaluation"))return;let e=this.getActiveScope(),t=new Set,r=qn(e),o=new Set;for(let i of j){let s=this.typeAndNameFromLocalId(i.localId,i.options.stableName),c=bA(s),d=this.lastSnapshot.depsGraph;Sr(d,c,o,r,t),this.lazyServerModulesForTransientSaves.set(c,o),t.delete(c)}let n=[];for(let i of t){let s=this.getModuleWithTypeSlashName(i);s?.kind==="server"&&n.push(this.createLocalModuleFromModule(s))}W.debug("\u{1F343} Prioritizing dependent server modules after updating:",j.map(i=>i.localId),"/ Visible:",t,"/ Lazy:",o,"/ Server modules:",n.length);let a=this.persistedModules;if(n.length>0){let i=await Promise.all(n);a=XA(a,s=>{for(let c of i)s.set(c.localId,c)})}this.persistedModules=a}async makeLazyServerModulesLocalWhenIdle(){this.cancelBackgroundJob(),this.backgroundAbortController=new AbortController;let{signal:j}=this.backgroundAbortController;return this.backgroundJob=(async()=>{try{for(;this.hasPendingServerModules()&&!j.aborted;){let e=new Md;if(this.runWhenIdle(()=>{if(j.aborted){e.resolve(!1);return}this.processOnePendingServerModule().then(e.resolve,e.reject)}),!await e)break}}finally{this.backgroundJob=null,this.backgroundAbortController=null}})(),this.backgroundJob}cancelBackgroundJob(){this.backgroundAbortController&&this.backgroundAbortController.abort()}getTransientSave(j){return this.transientSaves.get(j)}resetModuleStateAndPermissions(j){this.readOnlyTree=j==="readonly",this.useTreeAsLocalModuleList=this.readOnlyTree,!this.readOnlyTree&&this.modulesService&&this.setupModuleEventStreamIfNeeded(),this.treeNodesToUpdate.clear(),this.treeNodesToDelete=[],this.transientSaves.size>0&&(W.reportErrorOncePerMinute(new Error("Discarding transient saves"),{count:this.transientSaves.size}),this.setNextInternalState({dependenciesModule:this.dependenciesModule,persistedModules:this.persistedModules,transientSaves:new Map,depsGraph:this.lastSnapshot.depsGraph,didRemoteChange:!0}))}async waitForModulesToSave(){let j=Array.from(this.transientSaves.keys());for(let t of j)this.transientSaves.has(t)&&await this.update(t,{});let e=this.transientSaves.size;e>0&&W.warn("waitForModulesToSave: transientSaves seems to be growing, ignoring rest:",e)}async initialize(){return this.initializationStarted?this.initializationPromise:(this.initializationStarted=!0,this.initializeInternal().then(this.resolveInitialization,j=>{W.reportError(j,{context:"Failed to initialize ModulesStorage: "}),this.rejectInitialization(j)}),this.initializationPromise)}setupModuleEventStreamIfNeeded(){this.didSetupModuleEventStream||(this.didSetupModuleEventStream=!0,E(this.modulesService,"ModulesStorage.useModuleEventStream: expected modules service to be initialized"),this.modulesService.moduleEventsStream().read(async({events:j})=>{let e=j.filter(nG);this.handleRemoteModuleSaveEvents(e).catch(W.reportError);let t=j.filter(iG);this.handleRemoteModuleDeleteEvents(t).catch(W.reportError)}).catch(j=>{W.reportError(j,{context:"Failed to read ModulesAPI event stream: "})}))}async initializeInternal(){if(this.modulesService=await this.getModulesService(),!this.modulesService)return;let j=this.treeStore.tree.getLocalModuleNodes();this.writeLocalModulesToTree=!!j,this.useTreeAsLocalModuleList||this.setupModuleEventStreamIfNeeded();let e,t=performance.now();if(Ia("modulesStorageStart"),this.useTreeAsLocalModuleList&&j){W.info("init from tree data"),this.previousLocalModuleNodes=j;let i=j.map(s=>({moduleId:s.save.moduleId,saveId:s.save.saveId}));e=await this.modulesService.lookUpModules({queries:i})}else W.info("init from module list"),e=await this.modulesService.list({});Ia("modulesStorageInit"),W.debug("listing modules took:",performance.now()-t,"millis");let r=e.data.find(_c);r&&await this.updateDependenciesModule(r);let o=new Map,n=new Set;await Promise.all(e.data.map(async i=>{if(bA(i)===fe)return;let s=await this.createServerModuleFromData(i);W.trace("init - create module",s.localId,s.id,s.saveId,s.savedAt),o.set(s.localId,s),n.add(s.localId)}));let a=this.createDependencyGraph(o);this.initialized=!0,this.setNextInternalState({dependenciesModule:this.dependenciesModule,persistedModules:o,transientSaves:this.transientSaves,depsGraph:a,didRemoteChange:!0}),Ia("modulesStorageFirstPublish"),this.processTreeUpdates()}createDependencyGraph(j){let e=[];for(let t of j.values()){let r=bA(t),o=t.imports.relative;e.push([r,o])}return Gc(e)}processTreeUpdates(){if(this.initialized){if(this.readOnlyTree)if(this.useTreeAsLocalModuleList){if(!this.treeStore.tree.has(te)){W.info("detected removal of local modules list node, stopping to use tree as local module list"),this.useTreeAsLocalModuleList=!1,this.setupModuleEventStreamIfNeeded();return}}else{if(!this.treeStore.tree.has(te))return;W.info("detected insertion of a local modules list node, starting to use tree as local module list"),this.useTreeAsLocalModuleList=!0}this.syncLocalModules(),this.tryWriteTreeData()}}async syncLocalModules(){if(!this.useTreeAsLocalModuleList)return;let j=this.treeStore.tree.getLocalModulesListNode()?.children;if(!j||this.previousLocalModuleNodes===j)return;let e=[],t=Sd(this.previousLocalModuleNodes,r=>[r.id,r]);this.previousLocalModuleNodes=j;for(let r of j){let o=t.get(r.id);if(t.delete(r.id),o===r)continue;let n=r.save,a=this.persistedModules.get(r.id);fB(a,n)||jG(r)&&fB(this.dependenciesModule,n)||(e.push({moduleId:n.moduleId,saveId:n.saveId}),W.debug("syncLocalModules to update:",r.id))}if(t.size>0&&(W.debug("syncLocalModules removing:",t.keys()),this.handleRemoteModuleDeletes(Array.from(t.values()).map(r=>r.save.moduleId))),e.length>0){W.debug("syncLocalModules updating:",e),E(this.modulesService,"ModulesStorage.refresh: expected modules service to be initialized");let r=performance.now(),o=await this.modulesService.lookUpModules({queries:e});W.debug("lookupModules took:",performance.now()-r,"millis"),await this.handleRemoteModuleSaves(o.data)}}canWriteTree(){return!this.treeStore.tree.isViewOnly}tryWriteTreeData(){this.canWriteTree()&&(this.treeNodesToUpdate.size===0&&this.treeNodesToDelete.length===0||this.processWhenReady(()=>{if(!this.canWriteTree())return;let j=this.treeStore.tree;this.signalNonUserEvent(),j.lineage.setEditReason("localmodules"),this.createLocalModulesListNodeIfNeeded(j);for(let e of this.treeNodesToDelete)this.persistedModules.get(e)||(W.debug("tryWriteTreeData, remove:",e),j.remove(e));this.treeNodesToDelete=[];for(let[e,{treeVersion:t,errors:r,persistedModule:o}]of this.treeNodesToUpdate.entries())this.persistedModules.get(e)?.saveId===o.saveId&&(W.debug("tryWriteTreeData, write:",e,t,o.id,o.saveId,r),this.updateNode(j,e,t,o,r));this.treeNodesToUpdate.clear()}))}updateTreeNodeWithOwnTreeVersion(j,e){!this.writeLocalModulesToTree&&!this.maybeUpgradeDocument()||this.process(()=>{this.signalNonUserEvent(),this.treeStore.tree.lineage.setEditReason("localmodules"),this.createLocalModulesListNodeIfNeeded(this.treeStore.tree);let r=this.treeStore.tree.get(j)?.save.treeVersion??this.treeStore.remoteTreeVersion;W.debug("updateTreeNodeWithCurrentTreeVersion:",j,r,e.id,e.saveId),this.updateNode(this.treeStore.tree,j,r,e)})}updateTreeNode(j,e,t,r,o){return!this.writeLocalModulesToTree&&!this.maybeUpgradeDocument()?!0:this.canWriteTree()?(this.process(()=>{this.signalNonUserEvent(),this.treeStore.tree.lineage.setEditReason("localmodules"),this.createLocalModulesListNodeIfNeeded(this.treeStore.tree),W.debug("updateTreeNode:",j,e,t.id,t.saveId),this.updateNode(this.treeStore.tree,j,e,t,r,o)}),!0):(W.debug("updateTreeNode - readonly, buffering change"),this.treeNodesToUpdate.set(j,{treeVersion:e,persistedModule:t,errors:r,kitSectionsStructure:o}),!0)}removeTreeNode(j){this.writeLocalModulesToTree&&(this.canWriteTree()?this.process(()=>{W.debug("removeTreeNode:",j),this.treeStore.tree.remove(j)}):this.treeNodesToDelete.push(j))}updateNode(j,e,t,r,o,n){E(this.writeLocalModulesToTree,"not using tree for local modules");let a=j.get(e)?.asDraft()??new N6({id:e});E(a instanceof N6);let i=r.metadata.pluginId,s={treeVersion:t,moduleId:r.id,saveId:r.saveId,imports:r.imports?.relative,title:r.title,name:r.name,type:r.type,sourceRevision:r.sourceRevision,annotations:r.annotations?eo(r.annotations):a.save.annotations,pluginId:M(i)?i:a.save.pluginId};a.set({save:s}),a.tree()||j.insertNode(a,te);let c=r.name;if(!j.has(c))return;if(Aj(n)){let k=j.get(c);J(k)&&k.set({kitSectionsStructure:n})}if(!o)return;let d=j.get(pu);if(W.debug("Writing serialization errors from artifacts to tree for",c),d?.children?.forEach(k=>{let $=k.sourceNodeId??k.scopeId,g=oA(k.sourceNodeModuleType)||r.type===k.sourceNodeModuleType;!$||$!==c||!g||!ku(k.type)||j.remove(k.id)}),o.length===0)return;let p=j.ensureErrorListNode();o.forEach(k=>j.insertNode(k,p.id))}getModuleTreeData(j){return this.treeStore.tree.getNodeWithTrait(j,St)?.save}getKitSectionsStructure(j){return this.treeStore.tree.getNodeWithTrait(j,J)?.kitSectionsStructure}createLocalModulesListNodeIfNeeded(j){if(E(this.writeLocalModulesToTree,"not using tree for local modules"),j.has(te)||!this.canWriteTree())return;W.debug("ensureAllModulesExistInTree:",this.persistedModules.size),j.insertNode(new fk);let e=this.treeStore.remoteTreeVersion;this.persistedModules.forEach(t=>{this.updateNode(j,t.localId,e,t)}),this.dependenciesModule&&this.updateNode(j,fe,e,this.dependenciesModule)}usingLocalModulesInTree(){return this.treeStore.tree.has(te)||this.goingToStartUsingLocalModulesInTree}async startUsingLocalModulesInTree(){if(!this.canWriteTree())throw Error("Project is read only.");this.goingToStartUsingLocalModulesInTree=!0,this.process(()=>{if(this.startUsingLocalModulesInTree){if(!this.canWriteTree())throw Error("Project is read only.");this.treeStore.tree.lineage.setEditReason("startUsingLocalModulesInTree"),this.goingToStartUsingLocalModulesInTree=!1,this.writeLocalModulesToTree=!0,this.createLocalModulesListNodeIfNeeded(this.treeStore.tree)}})}stopUsingLocalModulesInTree(){this.goingToStartUsingLocalModulesInTree=!1,this.process(()=>{if(!this.canWriteTree())throw Error("Project is read only.");this.treeStore.tree.lineage.setEditReason("stopUsingLocalModulesInTree"),this.treeStore.tree.remove(te),this.writeLocalModulesToTree=!1,this.setupModuleEventStreamIfNeeded()})}maybeUpgradeDocument(){return this.process(()=>{if(!this.canWriteTree()){W.warn("cannot upgrade document if we cannot write, but should not be saving modules either");return}W.info("upgrading document to use local modules list node"),this.signalNonUserEvent(),this.treeStore.tree.lineage.setEditReason("maybeUpgradeDocument"),this.writeLocalModulesToTree=!0,this.createLocalModulesListNodeIfNeeded(this.treeStore.tree)}),this.writeLocalModulesToTree}getModuleWithTypeSlashName(j){let e=this.findPersistedModuleLocalIdByTypeSlashName(this.persistedModules,j);if(e)return this.persistedModules.get(e)}async updateDependenciesModule(j){E(_c(j),"updateDependenciesModule called with non dependencies module data");let e=await this.getDependenciesFiles(j),t=e?.dependenciesMapContent;if(!t){let r=JSON.parse(e.importMapContent),o=jo(r);t=JSON.stringify(o),this.readOnlyTree?W.reportError(new Error("modules storage is read only"),{context:"modules storage is read only while calling updateDependenciesModule"}):(await this.updateDependenciesLocked(r,o),W.info("The missing dependencies file has now been created."))}this.dependenciesModule={kind:"dependencies",...j,id:j.id,localId:j.localId,type:"config",name:j.name,importMapContent:e.importMapContent,dependenciesMapContent:t}}async createServerModuleFromData(j){let e={kind:"server",...j,id:j.id,localId:j.localId,moduleURL:j.baseURL+j.files.module,update:performance.now()};if((e.type==="codeFile"||e.type==="webPageMetadata")&&(e.sourceContent=await this.fetchSourceContentFromData(j)),yc(e)&&Sc(e)===0){e.sourceContent=await this.fetchSourceContentFromData(j);let t=e.sourceContent.includes("useQueryData")?1:0;e.metadata={...e.metadata,compatibleCmsVersion:t}}return e}async fetchSourceContentFromData(j){let e=j.baseURL+j.files.source;return(await fetch(e)).text()}async refresh(){if(this.initialized&&!this.useTreeAsLocalModuleList)return W.debug("refresh: acquiring lock"),HA(()=>this.refreshLocked())}async refreshLocked(){W.debug("refresh: start"),E(this.modulesService,"ModulesStorage.refresh: expected modules service to be initialized");let{data:j}=await this.modulesService.list({});W.debug("refresh: there's",j.length,"modules to process");let e=new Map,t=new Set;await Promise.all(j.map(async o=>{let n=o.localId;if(_c(o)){this.dependenciesModule?.saveId!==o.saveId&&await this.updateDependenciesModule(o);return}let a=this.persistedModules.get(n);if(a?.saveId===o.saveId)e.set(n,a);else{let i=await this.createServerModuleFromData(o);W.debug("refresh - updating module",i.localId,i.id,i.saveId,i.savedAt),e.set(n,i)}t.add(n)}));let r=this.createDependencyGraph(e);this.setNextInternalState({dependenciesModule:this.dependenciesModule,persistedModules:e,transientSaves:this.transientSaves,depsGraph:r,didRemoteChange:!0}),W.debug("refresh: finish")}whenInitialized(){return this.initializationPromise}async whenIdle(){await Promise.all([this.whenInitialized(),HA(()=>{})])}isProcessing(){return!!(!this.initialized||this.transientSaves.size>0||pl.isLocked(Vn))}hasLocalChanges(){return this.transientSaves.size>0}addListener(j){this.listeners.add(j)}removeListener(j){this.listeners.delete(j)}notifyListeners(j){this.listeners.forEach(e=>{try{e(j)}catch(t){W.reportError(t)}})}subscribe(j){return this.addListener(j),j($B(this.dependenciesModule,void 0,this.persistedModules,this.transientSaves,this.lastSnapshot.depsGraph,new Map,this.initialized,!1,!1)),()=>this.removeListener(j)}getDependentsOfModule(j){return this.lastSnapshot.depsGraph[j]?.dependents}getUniqueNameForType(j,e){let t=new Set;for(let r of this.persistedModules.values())r.type===j&&t.add(r.name);return wn(t,e)}async updateSources(j){return HA(async()=>{let e=!1;for(let{localId:t,source:r,options:o}of j){let n=Date.now();try{await this.updateSourceLocked(t,{...o,source:r}),e=!0}catch(a){a instanceof fs&&TA({type:"add",variant:"error",text:"Instances of your component won't update if they are nested within themselves.",key:"component-circular-dependency",icon:"error",duration:Number.POSITIVE_INFINITY}),W.reportError(a)}finally{let a=Date.now()-n;W.debug("\u23F1 update source",t,"in",a,"ms")}}return await this.makeVisibleDependentServerModulesLocal(j),this.setNextInternalState({dependenciesModule:this.dependenciesModule,persistedModules:this.persistedModules,transientSaves:this.transientSaves,depsGraph:this.lastSnapshot.depsGraph,didRemoteChange:!1}),this.makeLazyServerModulesLocalWhenIdle().catch(yA),e})}async updateDependenciesSource(j,e){return HA(async()=>{E(this.dependenciesModule,"Dependency files must already exist to be updated.");let t=j===To?e:this.dependenciesModule.importMapContent,r=j===Po?e:this.dependenciesModule.dependenciesMapContent;return this.updateDependenciesLocked(JSON.parse(t),JSON.parse(r))})}async compileSubmodules(j,e){let t={};return await Promise.all([...e].map(async([r,o])=>{let n=await this.compile({name:r,source:o,type:j,includeSourceMap:!1,addFramerMetadata:!1});for(let i of n.imports.relative){let s=Fm(i);if(!(s&&e.has(s)))throw new Error("Submodules only support relative imports of other submodules")}let a=Fa(r);t[a]=n.code})),t}typeAndNameFromLocalId(j,e=!1){if(e)return ci(j);for(let t of this.lastSnapshot.modules.values())if(t?.localId===j)return t;throw new Error(`Module entry for local id ${j} missing in internal snapshot`)}async updateSourceLocked(j,{source:e,submodules:t,binaryAssets:r=EB,stableName:o=!1,assets:n,preventCircularImports:a,telemetrySession:i,treeVersion:s,sourceRevision:c,svgIcon:d,kitSectionsStructure:p}){await this.whenInitialized();let k=this.typeAndNameFromLocalId(j,o),$=bA(k),g=await this.compile({localId:j,name:$,source:e,type:k.type,includeSourceMap:Dc(k.type),telemetrySession:i}),G=mB;t&&(G=await this.compileSubmodules(k.type,t));let I=go(this.lastSnapshot.depsGraph,$,g.imports.relative);if(a&&nB(I,$))throw new fs;let S=aG(k.type,g.annotations),T=XA(this.transientSaves,v=>{let P=v.get(j),_,H=S?.framerIntrinsicWidth;H&&(_={..._,intrinsicWidth:Number.parseInt(H,10)});let O=S?.framerIntrinsicHeight;if(O&&(_={..._,intrinsicHeight:Number.parseInt(O,10)}),_={..._,compilerContractVersion:1,treeAnnotations:!0,localModuleImportMapEntries:this.moduleUsesLocalImportMapSpecifiers($)},P)P.saveId=yr(),P.moduleContent=g.code,P.sourceContent=e,P.sourceMapContent=g.sourceMap,P.submoduleContents=G,P.binaryAssetContents=r,P.imports=g.imports,P.exports=g.exportedNames,P.reExportedModules=g.reExportedModules,P.treeVersion=s??this.treeStore.remoteTreeVersion,P.sourceRevision=c??P.sourceRevision,P.annotations=g.annotations,P.svgIcon=d??P.svgIcon,P.kitSectionsStructure=p??P.kitSectionsStructure,P.update=performance.now(),n&&(P.assets=Array.from(n)),_&&(P.metadata={...P.metadata,..._});else{let Q={localId:j,type:k.type,name:k.name,saveId:yr(),moduleContent:g.code,sourceContent:e,sourceMapContent:g.sourceMap,submoduleContents:G,binaryAssetContents:r,imports:g.imports,exports:g.exportedNames,reExportedModules:g.reExportedModules,treeVersion:s,sourceRevision:c,svgIcon:d,kitSectionsStructure:p,annotations:g.annotations,update:performance.now()};n&&(Q.assets=Array.from(n)),_&&(Q.metadata=_),v.set(j,Q)}});this.transientInfo||=new Set,this.transientInfo.add(j),this.transientSaves=T,this.lastSnapshot={...this.lastSnapshot,depsGraph:I}}async create(j){return HA(()=>this.createLocked(j))}async createLocked(j){await this.whenInitialized();let{type:e,name:t,source:r,...o}=j,n=bA({type:e,name:t}),a=await this.compile({name:n,source:r,type:e,includeSourceMap:Dc(e)}),i={localId:void 0,type:e,name:t,saveId:yr(),moduleContent:a.code,sourceContent:r,sourceMapContent:a.sourceMap,submoduleContents:mB,binaryAssetContents:EB,imports:a.imports,exports:a.exportedNames,reExportedModules:a.reExportedModules,treeVersion:j.treeVersion||this.treeStore.remoteTreeVersion,sourceRevision:j.sourceRevision,svgIcon:j.svgIcon,kitSectionsStructure:j.kitSectionsStructure,annotations:a.annotations,update:performance.now()},s=await this.createBatchSaveForUpdatedModule("$new",i,this.persistedModules,new Map,new Map,{type:e,name:t,...o});E(!this.readOnlyTree,"modules storage is read only"),E(this.modulesService);let{data:c}=await this.modulesService.saveBatch({batch:[s]}),{updatedModuleLocalId:d,nextPersistedModules:p}=this.processTransientSaveData({nextPersistedModules:this.persistedModules,transientSave:i,data:c}),k=go(this.lastSnapshot.depsGraph,n,a.imports.relative);return this.setNextInternalState({dependenciesModule:this.dependenciesModule,persistedModules:p,transientSaves:this.transientSaves,depsGraph:k,didRemoteChange:!0}),d}async update(j,e){let t=this.persistedModules.get(j);return E(t,"Trying to update an unknown module with localId:",j),HA(async()=>{let r=Date.now();try{return await this.whenInitialized(),await this.upsertBatchLocked({[j]:{...e,name:t.name,type:t.type}})}finally{let o=Date.now()-r;W.debug("\u23F1 update",j,"in",o,"ms")}})}async rename(j,e){return HA(()=>this.renameLocked(j,e))}async renameLocked(j,e){await this.whenInitialized();let t=this.persistedModules,r=this.lastSnapshot.depsGraph,o=t.get(j);E(o,"Trying to rename an unknown module with localId:",j);let n=this.treeStore.remoteTreeVersion,a=bA(o);E(!this.readOnlyTree,"modules storage is read only"),E(this.modulesService);let i=await this.modulesService.update({moduleId:o.id,name:e});E(i,"invalid update reply");let s=r[a]?.dependents,c=[],d={},p=bA(i);if(a!==p&&(r=us(r,a),r=go(r,p,o.imports.relative)),s){let k=[],$=[];for(let I of t.values()){let S=bA(I);s.has(S)&&(I.kind==="local"?k.push(I):$.push(I))}if($.length>0){let I=await Promise.all($.map(S=>this.createLocalModuleFromModule(S)));t=XA(t,S=>{for(let T of I)S.set(T.localId,T),k.push(T)})}let g=[];for(let I of k){let S=bA(I),T=K6(S,`${o.type}/${e}`);E(T,"Failed to create relative path to",o.type,"/",e);let v=K6(S,a);E(v);let P=I.imports.relative.indexOf(v);if(P===-1){W.warn(I.localId,"doesn't import",v);continue}let _=[...I.imports.relative];_[P]=T;let H={absolute:I.imports.absolute,bare:I.imports.bare,relative:_},O=hB(I.sourceContent,v,T),Q=hB(I.moduleContent,v,T);d[I.localId]={sourceContent:O,moduleContent:Q,imports:H},E(I.files.source);let L={type:I.type,moduleId:I.id,name:I.name,saveId:yr(),patchSaveId:I.saveId,files:[{name:I.files.source,type:"source",content:O}],imports:H};g.push(L)}E(!this.readOnlyTree,"modules storage is read only");let{data:G}=await this.modulesService.saveBatch({batch:g});c=G}t=XA(t,k=>{if(this.updateTreeNode(j,n,i)){o.kind==="server"?k.set(j,{...i,kind:"server",localId:i.localId,id:i.id,moduleURL:i.baseURL+i.files.module,sourceContent:o.sourceContent,update:performance.now()}):k.set(j,{...i,kind:"local",localId:i.localId,id:i.id,moduleURL:i.baseURL+i.files.module,sourceContent:o.sourceContent,moduleContent:o.moduleContent,sourceMapContent:o.sourceMapContent,submoduleContents:o.submoduleContents,binaryAssetContents:o.binaryAssetContents,update:performance.now()});for(let g of c){let G=g.localId,I=k.get(G);E(I?.kind==="local","dependent module must be local:",G);let S=d[G];E(S,"dependent module update must exist:",G),this.updateTreeNode(G,n,g)&&(k.set(G,{...g,kind:"local",localId:G,id:g.id,moduleURL:g.baseURL+g.files.module,moduleContent:S.moduleContent,sourceContent:S.sourceContent,sourceMapContent:I.sourceMapContent,submoduleContents:I.submoduleContents,binaryAssetContents:I.binaryAssetContents,imports:S.imports,exports:g.exports,reExportedModules:g.reExportedModules,submodules:g.submodules,binaryAssets:g.binaryAssets,sourceRevision:I.sourceRevision,update:I.update}),r=go(r,bA(g),S.imports.relative))}}}),this.setNextInternalState({dependenciesModule:this.dependenciesModule,persistedModules:t,transientSaves:this.transientSaves,depsGraph:r,didRemoteChange:!0})}async upsert(j,e){return HA(async()=>{let t=Date.now();try{return await this.whenInitialized(),await this.upsertBatchLocked({[j]:e})}finally{let r=Date.now()-t;W.debug("\u23F1 upsert",j,"in",r,"ms")}})}async upsertBatch(j){return HA(async()=>{let e=Date.now();try{return await this.whenInitialized(),await this.upsertBatchLocked(j)}finally{let t=Date.now()-e;W.debug("\u23F1 upsert batch in",t,"ms")}})}async delete(j){return HA(()=>this.deleteLocked(j))}async deleteLocked(j){let e=Array.isArray(j)?j:[j];if(!e.length)return;await this.whenInitialized();let t=e.map(d=>{let p=this.persistedModules.get(d);return E(p,"Trying to delete an unknown module",d,"It was never persisted."),p}),{modulesService:r}=this;E(r);let o=await Promise.allSettled(t.map(d=>r.delete({moduleId:d.id}))),n=new Set,a=new Set;for(let d of o){if(d.status==="rejected"){W.warn(String(d.reason));continue}n.add(d.value.localId),a.add(d.value.id)}e=e.filter(d=>n.has(d)),t=t.filter(d=>a.has(d.id)),E(e.length>0,"Failed to delete module(s)");let i=this.lastSnapshot.depsGraph;for(let d of t){let p=bA(d);i=us(i,p)}let s=XA(this.persistedModules,d=>{for(let p of e)d.delete(p),this.removeTreeNode(p)}),c=XA(this.transientSaves,d=>{for(let p of e)d.delete(p)});this.setNextInternalState({dependenciesModule:this.dependenciesModule,persistedModules:s,transientSaves:c,depsGraph:i,didRemoteChange:!0})}async publish(j,e){return HA(()=>this.publishLocked(j,e))}async publishLocked(j,{namespace:e,name:t,version:r}){await this.whenInitialized();let o=this.persistedModules.get(j);E(o,"Trying to publish an unknown module",j,"It was never persisted."),E(!this.readOnlyTree,"modules storage is read only"),E(this.modulesService);let n=await this.modulesService.publish({moduleId:o.id,saveId:o.saveId,namespace:e,name:t,version:r}),a=XA(this.persistedModules,i=>{let s=i.get(j);s&&i.set(j,{...s,lastPublish:{namespaceId:n.namespaceId,name:n.name,version:n.version,importURL:n.importURL}})});return this.setNextInternalState({dependenciesModule:this.dependenciesModule,persistedModules:a,transientSaves:this.transientSaves,depsGraph:this.lastSnapshot.depsGraph,didRemoteChange:!0}),n}async addNpmDependencies(j){return HA(async()=>{await this.whenInitialized();let e;this.dependenciesModule?.importMapContent?e=JSON.parse(this.dependenciesModule?.importMapContent):e={imports:{}};let t;this.dependenciesModule?.dependenciesMapContent?t=JSON.parse(this.dependenciesModule?.dependenciesMapContent):t={dependencies:{}};let r=Array.isArray(j)?j:[j];if(r=r.filter(i=>{if(tn.has(i.target)||nn(i.target))return!1;let s=on(i);return!e.imports[s]}),r.length===0)return{dependenciesMap:t};r=r.map(i=>{if(t.dependencies[i.target]){let c=e.imports[i.target]??Object.entries(e?.imports).find(([p])=>p.startsWith(i.target))?.[1];E(c,"The import map should contain a import that is in the dependencies map");let d=_k(c)?.version;return d?{...i,target:`${i.target}@${d}`}:i}let s=rn[i.target];return s?{...i,target:`${i.target}@${s}`}:i});let{importMap:o,resolvedDependencies:n}=await bk(e,r,tn,rn),a=await this.extendCurrentDependenciesMap(n);return n.forEach(({name:i,version:s})=>BA("npm_dependency_add",{name:i,semver:s})),W.debug({newImportMap:o,newDependenciesMap:a}),await this.updateDependenciesLocked(o,a),{dependenciesMap:a}})}async reinstallNpmDependencies(){return HA(async()=>{let{currentImportMap:j,currentDependenciesMap:e}=this.getCurrentDependencies();delete j.scopes;let{importMap:t}=await Ck(j,tn,rn);return await this.updateDependenciesLocked(t,e),t})}async uninstallBlockedNpmDependencies(){return HA(async()=>{let{currentImportMap:j,currentDependenciesMap:e}=this.getCurrentDependencies(),t=q6(e),r=await Tk(j);return await this.updateDependenciesLocked(r,t),r})}async clearNpmDependencies(){return HA(async()=>this.updateDependenciesLocked({imports:{}},{dependencies:{}}))}async removeBlockedNpmDependencies(){return HA(async()=>{let{currentImportMap:j,currentDependenciesMap:e}=this.getCurrentDependencies(),t=q6(e);return await this.updateDependenciesLocked(j,e),t})}async rebuildImportMapFromDependencies(){return HA(async()=>{let j=this.dependenciesModule?.dependenciesMapContent,e=j?JSON.parse(j):{dependencies:{}},t=await Mk(e,tn,rn);return await this.updateDependenciesLocked(t,e),t})}async unsafeUpgradeDependency(j,e,t){return HA(async()=>{let{currentImportMap:r,currentDependenciesMap:o}=this.getCurrentDependencies(),n=await Pk(r,j,e,t),a=jo(n),i=Ao(a,o);return await this.updateDependenciesLocked(n,i),n})}async extendCurrentImportMap(j,e){return HA(async()=>{let{currentImportMap:t,currentDependenciesMap:r}=this.getCurrentDependencies(),o=Zr(t,j),n=Ao(r,e);return this.updateDependenciesLocked(o,n)})}async extendCurrentDependenciesMap(j){let e={};for(let r of j)e[r.name]=r.version;let t=this.dependenciesModule?.dependenciesMapContent?JSON.parse(this.dependenciesModule?.dependenciesMapContent):{dependencies:{}};return t.dependencies=Object.assign(e,t.dependencies),t}getCurrentDependencies(){let j=this.dependenciesModule?.importMapContent?JSON.parse(this.dependenciesModule?.importMapContent):{imports:{}},e=this.dependenciesModule?.dependenciesMapContent?JSON.parse(this.dependenciesModule?.dependenciesMapContent):{dependencies:{}};return{currentImportMap:j,currentDependenciesMap:e}}async updateDependenciesLocked(j,e){let t=JSON.stringify(j,null,4),r=JSON.stringify(e,null,4);if(t===this.dependenciesModule?.importMapContent&&r===this.dependenciesModule?.dependenciesMapContent)return;let o={moduleId:"$upsertName",name:Os,saveId:yr(),type:"config",files:[{name:"importMap.json",type:"importMap",content:t},{name:"dependencies.json",type:"dependencies",content:r}],imports:{absolute:[],relative:[],bare:[]}};E(!this.readOnlyTree,"modules storage is read only"),E(this.modulesService);let{data:[n]}=await this.modulesService.saveBatch({batch:[o]});E(n,"Modules API must return an updated import map after savebatch"),this.updateTreeNodeWithOwnTreeVersion(fe,n);let a={kind:"dependencies",importMapContent:t,dependenciesMapContent:r,...n,id:n.id,localId:n.localId,type:n.type,name:n.name};this.setNextInternalState({dependenciesModule:a,persistedModules:this.persistedModules,transientSaves:this.transientSaves,depsGraph:this.lastSnapshot.depsGraph,didRemoteChange:!0})}getPersistedDependenciesModule(){return this.dependenciesModule}getPersistedModuleByGlobalId(j){for(let e of this.persistedModules.values())if(e.id===j)return e}getPersistedModuleByLocalId(j){return this.persistedModules.get(j)}getTransientSaveByLocalId(j){return this.transientSaves.get(j)}async handleRemoteModuleDeleteEvents(j){if(!this.useTreeAsLocalModuleList)return this.handleRemoteModuleDeletes(j.map(e=>e.id))}async handleRemoteModuleDeletes(j){await HA(async()=>{let e=[],t=[];for(let a of j){let i=this.getPersistedModuleByGlobalId(a);i&&(t.push(bA(i)),e.push(i.localId))}let r=XA(this.persistedModules,a=>{for(let i of e)a.delete(i)}),o=XA(this.transientSaves,a=>{for(let i of e)a.delete(i)}),n=this.lastSnapshot.depsGraph;for(let a of t)n=us(n,a);this.setNextInternalState({dependenciesModule:this.dependenciesModule,persistedModules:r,transientSaves:o,depsGraph:n,didRemoteChange:!0})})}async handleRemoteModuleSaveEvents(j){if(!this.useTreeAsLocalModuleList)return this.handleRemoteModuleSaves(j.map(e=>e.module))}async handleRemoteModuleSaves(j){let e=[],t=[];for(let n of j)bA(n)===fe?e.push(n):t.push(n);let r,o=e.length>0?e[e.length-1]:void 0;if(o){let{importMapContent:n,dependenciesMapContent:a}=await this.getDependenciesFiles(o);E(a,"No dependencies file exists for the remote update!"),r={kind:"dependencies",...o,id:o.id,localId:o.localId,type:"config",name:o.name,importMapContent:n,dependenciesMapContent:a}}await HA(async()=>{r&&(this.dependenciesModule=r);let n=this.persistedModules,a=this.lastSnapshot.depsGraph,i=await Promise.all(t.map(s=>this.createServerModuleFromData(s)));for(let s of i){let c=bA(s),d=s.localId;n=XA(n,p=>{p.set(d,s)}),this.transientSaves.has(d)||(a=go(this.lastSnapshot.depsGraph,c,s.imports.relative))}this.setNextInternalState({dependenciesModule:this.dependenciesModule,persistedModules:n,transientSaves:this.transientSaves,depsGraph:a,didRemoteChange:!0,multiplayerChange:!0})})}getPatchTransientSave(j,e,t){return{saveId:t,type:e.type,name:e.name,localId:j,moduleContent:e.moduleContent,sourceContent:e.sourceContent,sourceMapContent:e.sourceMapContent,submoduleContents:e.submoduleContents,binaryAssetContents:e.binaryAssetContents,imports:e.imports,exports:e.exports,reExportedModules:e.reExportedModules,sourceRevision:e.sourceRevision,update:e.update}}async upsertBatchLocked(j){if(this.readOnlyTree)return;let e=this.persistedModules,t=new Map,r=[],o=new Map;for(let d of e.values()){let p=bA(d);o.set(p,d.localId),r.push([p,d.imports.relative])}let n=new Map;for(let d in j){let p=d,k=j[p];E(k,"No persist params found for",p);let $=this.transientSaves.get(p),g=$??e.get(p);E(g,"No module found for",p);let G=bA(g);n.set(G,$?.saveId??yr()),t.set(G,Qj(k.name)),o.set(G,p),$&&r.push([G,$.imports.relative])}let a=Gc(r),i=new Map,s=XA(this.transientSaves,d=>{for(let p in j)d.delete(p)}),c;try{let{batch:d,nextPersistedModules:p}=await this.createBatch(j,i,e,a,o,n,t);E(!this.readOnlyTree,"modules storage is read only"),E(this.modulesService);let{data:k}=await this.modulesService.saveBatch({batch:d});e=XA(p,$=>{for(let g of k.values()){let G=g.localId,I=i.get(G);if(!I){let H=$.get(G);E(H,G,"is not in persistedModules"),this.updateTreeNodeWithOwnTreeVersion(G,g),H.saveId=g.saveId,H.moduleURL=g.baseURL+g.files.module;continue}let S={kind:"local",...g,id:g.id,localId:g.localId,imports:I.imports,moduleURL:g.baseURL+g.files.module,sourceContent:I.sourceContent,sourceMapContent:I.sourceMapContent,moduleContent:I.moduleContent,submoduleContents:I.submoduleContents,binaryAssetContents:I.binaryAssetContents,sourceRevision:I.sourceRevision,annotations:I.annotations,update:I.update},T=j[G]?.errors,v=I.kitSectionsStructure,P=I.treeVersion??this.treeStore.remoteTreeVersion;if(!this.updateTreeNode(g.localId,P,S,T,v))return;$.set(G,S)}})}catch(d){e=this.persistedModules;let p=Array.from(i.values()).map(G=>G.saveId).join("-"),k=this.transientSaveRetries.get(p)??0,{error:$,dropTransient:g}=this.handlePersistenceError(d,k,()=>{this.transientSaveRetries.set(p,k+1),setTimeout(async()=>{let G=Object.entries(i).every(([I,S])=>{let T=I,v=this.transientSaves.get(T);return v&&v.saveId===S.saveId});ms($)&&(this.transientSaveRelativeImportRetries.add(p),await this.refresh()),G&&(W.debug("retrying saving batchId with id:",p),this.upsertBatchLocked(j))},1e3+k*1e3)});if(!g)return;c=$}if(this.setNextInternalState({dependenciesModule:this.dependenciesModule,persistedModules:e,transientSaves:s,depsGraph:this.lastSnapshot.depsGraph,didRemoteChange:!0}),c)throw c}async createBatch(j,e,t,r,o,n,a){let i=[];for(let p in j){let k=p,$=j[k];E($,"No persist params found for",k);let g=this.transientSaves.get(k);if(!g){let I=t.get(k);E(I,`Trying to persist ${k} but it doesn't have neither a corresponding transient save nor an existing persisted module.`),I.kind==="server"&&(I=await this.createLocalModuleFromModule(I),t=XA(t,T=>{I&&T.set(I.localId,I)}));let S=n.get(k);E(S,"No save id found for",k),g=this.getPatchTransientSave(k,I,S)}e.set(k,g);let G=await this.createBatchSaveForUpdatedModule(this.persistedModules.get(k)?.id??"$upsertName",g,t,n,a,$);i.push(G)}let s=new Map;for(let p in j){let k=p,$=j[k];E($,"No persist params found for",k);let g=bA($),G=new Set;Sr(r,g,G),s.set(k,G)}let c=[];for(let p of s.values())for(let k of p){let $=o.get(k);E($,"Cannot find localId for",k);let g=t.get($);g?.kind==="server"&&c.push(this.createLocalModuleFromModule(g))}if(c.length>0){let p=await Promise.all(c);t=XA(t,k=>{for(let $ of p)k.set($.localId,$)})}for(let p of s.values())for(let k of p)n.has(k)||n.set(k,yr());let d=new Set;for(let[p,k]of s){let[$]=ia(p);for(let g of k){let G=o.get(g);if(E(G,"Cannot find localId for",g),e.has(G)||d.has(g)||t.get(G)?.metadata.localModuleImportMapEntries===!0&&this.moduleUsesLocalImportMapSpecifiers(g)&&($!=="codeFile"||!r[g]?.dependencies.has(p)))continue;d.add(g);let T=await this.createBatchSaveForDependentModule(G,t,n,a);i.push(T)}}return{batch:i,nextPersistedModules:t}}handlePersistenceError(j,e,t){let r=j instanceof Error?j.message:"",o=j instanceof ws?j.code:0,n=j instanceof ws?j.status:0,a=o===1002,i=o===-1e3,s=n>=300&&n!==400&&n!==403,c=i||s||ms(j),d=20,p=2;if(ms(j)&&zA.isOn("retryRelativeImportRewriting"))return!c||e>=p?(W.reportError("Relative imports error, exceeded max retries, making document read only:",{missing:j.persistedMissingRelativeImports}),this.makeDocumentReadOnly(),TA({type:"add",variant:"warning",text:"Framer can\u2019t save your latest changes. Please reload the page to continue working.",key:"client-outdated",duration:Number.POSITIVE_INFINITY,icon:"warning",showCloseButton:"never",action:{title:"Reload",onClick:()=>{W.reportError("ModulesStorage: Reloaded due to relative imports error.",{missing:j.persistedMissingRelativeImports}),window.top.location.reload()}}}),{error:j,dropTransient:!0}):(W.debug("Relative imports error, will retry:",{missing:j.persistedMissingRelativeImports}),t(),{error:j,dropTransient:!1});if(a&&e>0)W.debug("Ignoring duplicated save id.");else{if(a)return W.debug("Duplicate save id error, will drop transient save:",j),{error:j,dropTransient:!0};if(c&&e<d)return W.info("Connection error, will retry:",{message:r,code:o,status:n,retryCount:e}),t(),{dropTransient:!1};if(c)W.error("Error saving: too many retries, will drop transient save:",{message:r,code:o,status:n,retryCount:e});else return W.debug("Error saving, will drop transient save:",j),{error:j,dropTransient:!0}}return{dropTransient:!1}}moduleUsesLocalImportMapSpecifiers(j){let[e,t]=ia(j);if(e==="layoutTemplate")return!0;if(e==="collection")return zA.isOn("collectionLocalModuleImportMapEntries");if(e==="screen"){let r=this.treeStore.tree.get(t);if(Sj(r)||J(r))return!0}return!1}processTransientSaveData({nextPersistedModules:j,transientSave:e,data:t},r,o){let n=e.treeVersion??this.treeStore.remoteTreeVersion,a;return j=XA(j,i=>{let s=t.values(),c=s.next().value;a=c.localId;let d={kind:"local",...c,id:c.id,localId:a,imports:e.imports,moduleURL:c.baseURL+c.files.module,sourceContent:e.sourceContent,sourceMapContent:e.sourceMapContent,moduleContent:e.moduleContent,submoduleContents:e.submoduleContents,binaryAssetContents:e.binaryAssetContents,sourceRevision:e.sourceRevision,annotations:e.annotations,update:e.update};if(this.updateTreeNode(c.localId,n,d,r,o)){i.set(a,d);for(let k of s){let $=i.get(k.localId);E($,k.localId,"is not in persistedModules"),this.updateTreeNodeWithOwnTreeVersion(k.localId,k),$.saveId=k.saveId,$.moduleURL=k.baseURL+k.files.module}}}),E(a,"Updated module",e,"is not found in the response"),{nextPersistedModules:j,updatedModuleLocalId:a}}setNextInternalState({dependenciesModule:j,persistedModules:e,transientSaves:t,depsGraph:r,didRemoteChange:o,multiplayerChange:n=!1}){this.dependenciesModule=j,this.persistedModules=e,this.transientSaves=t;let a=$B(j,this.lastSnapshot.dependenciesModule,e,t,r,this.lastSnapshot.modules,this.initialized,o,n),i=this.lastSnapshot.initialized;this.lastSnapshot={dependenciesModule:a.dependenciesModule,modules:a.modules,depsGraph:a.depsGraph,initialized:a.initialized},!(a.metadata.patches.length===0&&a.initialized===i)&&this.notifyListeners(a)}async createLocalModuleFromModule(j){W.debug("compiling server module:",j.localId);let e=j.sourceContent;e||(e=await this.fetchSourceContentFromData(j));let t={},r={},o=this.downloadQueue,n=new Array;for(let s of j.submodules)n.push(o.run(async()=>{let c=await fetch(j.baseURL+s);t[s]=await c.text()}));for(let s of j.binaryAssets)n.push(o.run(async()=>{let d=await(await fetch(j.baseURL+s)).arrayBuffer();r[s]=new Uint8Array(d)}));await Promise.all(n);let a=bA(j),i=await this.compile({localId:j.localId,name:a,source:e,type:j.type,includeSourceMap:Dc(j.type)});for(let[s,c]of this.lazyServerModulesForTransientSaves)c.delete(a),c.size===0&&this.lazyServerModulesForTransientSaves.delete(s);return{...j,kind:"local",id:j.id,localId:j.localId,sourceContent:e,moduleContent:i.code,sourceMapContent:i.sourceMap,submoduleContents:t,binaryAssetContents:r,imports:i.imports,sourceRevision:wc(j),annotations:i.annotations}}async createBatchSaveForUpdatedModule(j,e,t,r,o,n){let a=bA(e),{localId:i,moduleContent:s,sourceContent:c,sourceMapContent:d,submoduleContents:p={},binaryAssetContents:k={},metadata:$,sourceRevision:g,imports:G,type:I,name:S,annotations:T,update:v,...P}=e;switch(j){case"$new":E(i===void 0,`Attempted to create ${a} but it already has localId: ${i}`);break;case"$upsertName":default:E(i!==void 0,`The transient save for the provided moduleId: ${j} doesn't have localId`)}let{type:_,name:H,metadata:O,files:Q,...L}=n;E(_===I&&H===S,`Mismatched type/name between save and parameters: ${_}/${H} !== ${I}/${S}`);let dA=Qj(H),N=s;G.relative.length>0&&(N=await this.replaceRelativeImportsWithAbsolute(a,s,G.relative,t,r,No(p),o)),d&&(N+=`
//# sourceMappingURL=./${dA.sourceMap}`);let X=(Q??[]).concat([{name:dA.module,type:"module",content:N},{name:dA.source,type:"source",content:c}]);d&&X.push({name:dA.sourceMap,type:"sourceMap",content:d});for(let[nA,aA]of Object.entries(p))X.push({name:nA,type:"submodule",content:aA});for(let[nA,aA]of Object.entries(k))X.push({name:nA,type:"binaryAsset",bytes:aA});let Y={};if($||O)if(i){let nA=t.get(i);E(nA||j==="$upsertName",`Cannot safely update metadata for ${j} (${i})`),Y.metadata={...nA?.metadata,...$,...O,sourceRevision:g}}else Y.metadata={...$,...O,sourceRevision:g};return{...P,moduleId:j,type:_,name:H,files:X,imports:G,...L,...Y}}async createBatchSaveForDependentModule(j,e,t,r){let o=e.get(j);E(o,j,"is not found in persistedModules"),E(o.kind==="local","persisted module is not a local module");let n=bA(o),a=Qj(o.name),i=o.imports,s=o.moduleContent;i.relative.length>0&&(s=await this.replaceRelativeImportsWithAbsolute(n,o.moduleContent,i.relative,e,t,No(o.submoduleContents),r));let c=t.get(n);E(c,"newSaveIds don't contain saveId for",n);let d={},p=this.moduleUsesLocalImportMapSpecifiers(n);return o.metadata.localModuleImportMapEntries!==p&&(d.metadata={...o.metadata,localModuleImportMapEntries:p}),{type:o.type,moduleId:o.id,name:o.name,saveId:c,patchSaveId:o.saveId,files:[{name:a.module,type:"module",content:s}],imports:i,...d}}findPersistedModuleLocalIdByTypeSlashName(j,e){return this.ensurePersistedLocalIdsByTypeSlashNameCacheFor(j).get(e)}ensurePersistedLocalIdsByTypeSlashNameCacheFor(j){let e=this.persistedLocalIdsByTypeSlashNameCache.get(j);if(!e){e=new Map;for(let[t,r]of j.entries())e.set(bA(r),t);this.persistedLocalIdsByTypeSlashNameCache.set(j,e)}return e}async replaceRelativeImportsWithAbsolute(j,e,t,r,o,n,a){let{modulesCDN:i}=Ee(),s={};for(let g of n){let G=Ga(g);s[G]=G}let c=this.moduleUsesLocalImportMapSpecifiers(j),d=new Set;for(let g of t){if(g in s)continue;let G=ce(g,j);if(!G)continue;let I=this.findPersistedModuleLocalIdByTypeSlashName(r,G);if(!I){d.add(G),W.error("Cannot resolve",g,"from",j);continue}let S=r.get(I);E(S);let{id:T,files:v}=S,P=o.get(G)??S.saveId,_=a?.get(G)?.module??v.module;E(M(_),"Must have a module file name to build a local module import map specifier."),s[g]=c?di(I,_):`${i}/${T}/${P}/${_}`}let p=await Es(e,s);if(p.ok)return p.value;if(j.startsWith("codeFile"))return p.error.partiallyProcessedCode;let k=new Set,$=this.treeStore.tree;for(let g of p.error.unresolvedRelativeImports){let G=ce(g,j);if(!G)continue;let[I]=ia(G);if(!(I==="codeFile"||!$.getNodeWithTrait(G,St))){k.add(G);break}}if(k.size===0)return W.reportError("Failed to rewrite relative imports due to unpersisted relative dependencies",{relativeImports:t,unresolved:Array.from(p.error.unresolvedRelativeImports)}),p.error.partiallyProcessedCode;if(W.reportError("Failed to rewrite relative imports",{typeSlashName:j,missing:Array.from(k)}),!zA.isOn("retryRelativeImportRewriting"))return p.error.partiallyProcessedCode;throw new Kn(k)}async getDependenciesFiles({baseURL:j,files:e}){let[t,r]=await Promise.allSettled([fetch(j+e.importMap).then(a=>{if(a.ok!==!0)throw new Error("failed to load importMap file");return a.text()}),fetch(j+e.dependencies).then(a=>{if(a.ok!==!0)throw new Error("failed to load dependencies file");return a.text()})]);E(t.status==="fulfilled","The importMap has to exist on the module");let o=t.value,n;return r.status==="fulfilled"?n=r.value:W.warn("No dependencies file was found!"),{importMapContent:o,dependenciesMapContent:n}}};function rG(A,j){return`${Ee().modulesCDN}/${j.id}/${A.saveId}/${j.files.module}`}function $B(A,j,e,t,r,o,n,a,i){let s=new Set(o.keys()),c=new Set(t.keys()),d=[],[p,k]=ya(o,G=>{for(let I of e.values()){let S=I.localId,T=bA(I),v=t.get(S),P;if(v)P={kind:"local",localId:S,type:v.type,name:v.name,moduleURL:rG(v,I),moduleContent:v.moduleContent,sourceContent:v.sourceContent,sourceMapContent:v.sourceMapContent,submoduleContents:v.submoduleContents,binaryAssetContents:v.binaryAssetContents,relativeImports:v.imports.relative,files:I.files,sourceRevision:v.sourceRevision,kitSectionsStructure:v.kitSectionsStructure,svgIcon:v.svgIcon,update:v.update};else{let _=wc(I);P=I.kind==="local"?{kind:"local",localId:S,type:I.type,name:I.name,moduleURL:I.moduleURL,moduleContent:I.moduleContent,sourceContent:I.sourceContent,sourceMapContent:I.sourceMapContent,submoduleContents:I.submoduleContents,binaryAssetContents:I.binaryAssetContents,relativeImports:I.imports.relative,files:I.files,sourceRevision:_,svgIcon:void 0,kitSectionsStructure:void 0,update:I.update}:{kind:"server",localId:S,type:I.type,name:I.name,moduleURL:I.moduleURL,sourceContent:I.sourceContent,relativeImports:I.imports.relative,files:I.files,sourceRevision:_,update:I.update}}BB(G,T,P),c.delete(S),s.delete(T)}for(let I of c){let S=t.get(I);if(E(S),!S.localId)continue;let T=Qj(S.name),v={kind:"local",localId:S.localId,type:S.type,name:S.name,moduleURL:`./transient/${S.saveId}/${T.module}`,moduleContent:S.moduleContent,sourceContent:S.sourceContent,sourceMapContent:S.sourceMapContent,submoduleContents:S.submoduleContents,binaryAssetContents:S.binaryAssetContents,relativeImports:S.imports.relative,files:T,sourceRevision:S.sourceRevision,svgIcon:S.svgIcon,kitSectionsStructure:S.kitSectionsStructure,update:S.update};BB(G,I,v),s.delete(bA(v))}for(let I of s)G.delete(I),d.push(I)}),$={};for(let G of d){let I=o.get(G);I&&($[G]=I.localId)}let g=XA(j,G=>{if(A){if(!G)return{kind:"dependencies",localId:fe,type:A.type,name:A.name,importMapContent:A.importMapContent,dependenciesMapContent:A.dependenciesMapContent};G.importMapContent=A.importMapContent,G.dependenciesMapContent=A.dependenciesMapContent}});return g&&g!==j&&k.push({op:j?"replace":"add",path:[bA(g)],value:g}),{dependenciesModule:g,modules:p,deletedLocalIdsByTypeSlashNames:$,depsGraph:r,initialized:n,metadata:{patches:k,hasLocalChanges:t.size>0,didRemoteChange:a,multiplayerChange:i}}}function BB(A,j,e){let t=A.get(j);if(!t){A.set(j,e);return}if(t.kind!==e.kind){A.set(j,e);return}if(t.kind==="server"){E(e.kind==="server"),gB(t,e);return}E(e.kind==="local"),oG(t.relativeImports,e.relativeImports)||(t.relativeImports=e.relativeImports),a7(t.files,e.files)||(t.files=e.files);let{relativeImports:r,files:o,...n}=e;gB(t,n)}function gB(A,j){Object.assign(A,j)}function oG(A,j){if(!A&&!j)return!0;if(A&&j){let e=A.length;if(e!==j.length)return!1;for(let t=0;t<e;t++)if(A[t]!==j[t])return!1;return!0}else return!1}function nG(A){return A.type==="save"}function iG(A){return A.type==="delete"}function yr(){return _n()}function Dc(A){return A==="codeFile"||A==="canvasComponent"}function hB(A,j,e){return A.replace(new RegExp(`\\b(from\\s*)(["'])${Mc(j)}\\2`,"g"),`$1${JSON.stringify(e)}`)}function aG(A,j){switch(A){case"canvasComponent":case"layoutTemplate":case"screen":case"prototype":case"collection":case"draftCollection":case"webPageMetadata":case"siteMetadata":case"vector":case"vectorSet":return j.default;case"codeFile":case"css":case"componentPresets":case"config":case"localization":case"design":return Object.values(j)[0];default:cA(A)}}function RB(A,j){if(!A||A.length===0)return j?.placeholder??"";if(A.length===1)return A[0]&&A[0]!==""?A[0]:j?.placeholder??"";let e=[...A],t="";if(j?.max&&j.max<A.length){let r=A.length-j.max;e=e.slice(0,j.max),t=`${r} ${r>1?"others":"other"}`}else t=e.pop()??"";return e.length>1?`${e.join(", ")}, and ${t}`:`${e.join(", ")} and ${t}`}var QU=_e("componentPresets","componentPresets");function IB(A,j){let e=A.getPresetsListNode();return e?e.getComponentPresets().find(t=>t.componentIdentifier===j)??null:null}function FB(A,j){let{treeStore:e}=A.stores;if(e.tree.has(j.id))return;let t=IB(e.tree,j.componentIdentifier),r=kr(e.tree),o=Ku(r.children,a=>Or(a)&&a.componentIdentifier!==j.componentIdentifier);o!==-1&&(o+=1),e.tree.insertNode(j,r.id,o),oo(A)&&A.stores.codeGenerationStore.createModuleFromComponentSource(r).catch(yA),ne(j.componentIdentifier)&&A.stores.modulesStore.addExternalModulesToProject([j.componentIdentifier],{onTreeUpdate(){}});let n=Ho(j.componentIdentifier);t||A.runWithFullyLoadedTree(()=>{let a=e.getLoadedIndexes();for(let i of a.richTextNodes)i.htmlContent&&de(e.tree,i,n)&&i.setComponentPreset(j.componentIdentifier,j.id)},{runInBackground:!0,name:"insertComponentPreset"})}function sG(A,j){if(IB(A.tree,j.componentIdentifier))return;let t=z6.createDefault(j);FB(A,t)}function UU(A,j,e){A.processWhenReady(()=>{let r=kr(A.tree).getComponentPresets(),o=new Set;for(let a of r)a.name&&o.add(a.name);let n=z6.createDefault(j,{name:Pj(j.name,o)});FB(A,n);try{e&&e(n)}catch{}})}function WU(A,j){return A.getPresetsListNode()?.getComponentPresets().filter(t=>t.componentIdentifier===j)??[]}function GB(A,j,e){let t=jA(j);function r(n){let a=jA(n);return a.kind==="externalModuleExport"&&t.kind==="externalModuleExport"&&a.moduleId===t.moduleId&&a.exportSpecifier===t.exportSpecifier}let o=A.getPresetsListNode();if(o){let n=o.getComponentPresets();for(let a of n)r(a.componentIdentifier)&&a.set({componentIdentifier:e})}E(!A.getService("loader"),"Tree should be fully loaded");for(let n of A.root.walk()){if(!qA(n))continue;let a=n.getComponentPresets();for(let[i,s]of a){let c=Ho(i);r(i)&&de(A,n,c)&&(n.setComponentPreset(e,s),n.setComponentPreset(i,void 0))}}}function zU(A,j,e){let t=j.find(r=>r.componentIdentifier===e);t&&sG(A,t)}function Hn(A){let j=jA(A);if(!(!j||!aj(j)||!ne(j)))return`${j.moduleId}:${j.exportSpecifier}`}function SB(A){let j=new Map;for(let e of A){let t=Hn(e);t&&j.set(t,e)}return j}function yB(A,j){let e=A.getRawControlProps();for(let t in e){let r=e[t]?.type,o=e[t]?.value;if(r!=="vectorsetitem"||!M(o)||!aj(o))continue;let n=Hn(o);if(!n||!j.has(n))continue;let a=j.get(n);a&&A.setControlProp(t,{type:"vectorsetitem",value:a})}}function bB(A,j){for(let e of j){yB(e,A);let t=Hn(e.codeComponentIdentifier);if(!t||!A.has(t))continue;let r=A.get(t);r&&e.set({codeComponentIdentifier:r})}}function CB(A,j){let e=j.getContentManagementNode();if(e){E(e.isLoaded(),"CMS Should always be loaded.");for(let{node:t,skipChildren:r}of e.walkWithSkipChildren()){if(ej(t)){if(!t.variables.some(a=>a.type==="vectorsetitem")){r();continue}vB(t,A)}if(!le(t))continue;let o=t.getControlProps();for(let n in o){let a=o[n]?.value;if(o[n]?.type!=="vectorsetitem"||!M(a)||!aj(a))continue;let s=Hn(a);if(!s||!A.has(s))continue;let c=A.get(s);c&&t.setControlProp(n,{...o[n],value:c})}}}}function vB(A,j){let e=!1,t=A.variables.map(r=>{if(r.type!=="vectorsetitem")return r;let{initialValue:o}=r,n=o.identifier;if(!n)return r;let a=Hn(n);if(!a||!j.has(a))return r;let i=j.get(a);return i?(e=!0,{...r,initialValue:{...o,identifier:i}}):r});e&&A.set({variables:t})}function TB(A,j){for(let e of j.root.children){if(J(e)){yB(e,A);continue}(rA(e)||oj(e))&&vB(e,A)}}function PB(A,j){let e=0,t,r=(...n)=>{e=Date.now(),t=void 0,A(...n)};function o(...n){let a=Date.now(),i=j-(a-e);i<=0||i>j?(t&&(window.clearTimeout(t),t=void 0),e=a,A.apply(this,n)):t||(t=window.setTimeout(r,i,...n))}return o.cancel=()=>{t&&(window.clearTimeout(t),t=void 0)},o}var Rj=mA("modules-store"),MB=new Set(["codeFile","canvasComponent","screen","layoutTemplate","vector"]),lG=500;function Lc(A){let{module:j,exportSpecifier:e}=A,{id:t,saveId:r,files:o}=j;return E(o.module,"module file must exist for a saved module"),Yj(t,r,o.module,e)}var Io,Un,Wn,Mt,_B=class extends re{constructor(e,t,r,o,n,a,i){super();this.treeStore=e;this.loadedExternalModulesStore=t;this.chromeStore=r;this.modulesAPIServicePromise=o;this.makeDocumentReadOnly=n;this.insertTemporaryImportMap=a;this.loadAllLocalModules=i;R(this,"dependenciesModule");R(this,"localModules",new Map);R(this,"fastRefreshModules",new Map);R(this,"externalModulesDynamicInfo",new Map);R(this,"revision",0);xA(this,Io,new Map);R(this,"moduleDepsGraph",{});R(this,"modulesStorage");R(this,"moduleUpdatesEmitter",new De);R(this,"fastRefreshModulesEmitter",new De);xA(this,Un);xA(this,Wn,new Map);xA(this,Mt,new Map);R(this,"debugModuleStoreAndComponentLoaderRevisionsMatch",()=>this.revision===V.modulesRevision);R(this,"checkForExternalModuleUpdates",async()=>{if(this.treeStore.tree.isViewOnly)return;let e=this.treeStore.tree.getExternalModulesListNode();if(!e||!e.children?.length)return;let t=[],r=new Map;e.children.forEach(i=>{let s=jA(i.codeComponentIdentifier);if(E(s?.kind==="externalModuleExport","expected ExternalModuleNode identifier to be of kind externalModuleExport"),i.type==="vector"){let c=i.annotation("framerVector");if(!ra(c))return;let d=c.set.moduleId,p=r.get(d)??[];p.push(s),r.set(d,p)}else t.push(s)});for(let[i,s]of r){let c=this.treeStore.tree.get(i);if(!Le(c))continue;let d=c.annotation("framerVectorSet");x6(d)&&(gk(d)||t.push(...s))}let o=t.map(({moduleId:i,saveId:s})=>({moduleId:i,saveId:s}));if(!o.length)return;let n=[],a=[];for(let i=0;i<o.length;i++){let s=o[i];if(E(s,"query is expected to be defined."),n.push(s),n.length<lG&&i<o.length-1)continue;let{modules:c}=await this.lookUpModules(n,{includeStatus:!0});a.push(...c),n=[]}this.treeStore.tree.isViewOnly||this.updateExternalModuleNodes(a.map((i,s)=>{let c=t[s];return E(c,"External module missing a matching identifier"),{module:i,exportSpecifier:c.exportSpecifier}}),{onTreeUpdate(){}}).catch(yA)});R(this,"updatesPollId");R(this,"compileFastRefreshModule",async({localId:e,name:t,source:r,includeSourceMap:o=!0})=>{let{type:n,name:a}=ci(e);if(!MB.has(n))return;let i=n==="codeFile"?Qj(t).source:a,{code:s,imports:c,sourceMap:d}=await C$({localId:e,source:r,name:i,includeSourceMap:o}),p={kind:"fast-refresh",localId:e,type:n,name:i,sourceContent:r,moduleContent:s,relativeImports:c.relative,sourceMapContent:d,binaryAssetContents:void 0,submoduleContents:{},update:0},[k,$]=ya(this.fastRefreshModules,g=>{g.set(t,p)});this.fastRefreshModules=k,this.fastRefreshModulesEmitter.emit({patches:$,dependentModules:[],prioritizedModules:[],revision:++this.revision,initialized:!0})});R(this,"compile",({localId:e,name:t,source:r,includeSourceMap:o=!0,type:n,telemetrySession:a})=>{let i=v$({name:t,source:r,includeSourceMap:o,type:n,telemetrySession:a});return this.fastRefreshEnabled&&e&&this.compileFastRefreshModule({localId:e,name:t,source:r,includeSourceMap:o}).catch(yA),i});this.modulesStorage=new Bs(()=>this.modulesAPIServicePromise.catch(s=>{throw Rj.error(s,{context:"Failed to discover ModulesAPI service:"}),s}),this.compile,this.process,this.processWhenReady,this.signalNonUserEvent,this.runWhenIdle,e,()=>this.getActiveScope(),()=>this.makeDocumentReadOnly()),this.fastRefreshModulesEmitter.onNewStream=s=>(Rj.debug("onNewStream - fast refresh",s),{latest:this.getAllModulesAsUpdateEvent(!0)}),this.moduleUpdatesEmitter.onNewStream=s=>(Rj.debug("onNewStream - module updates",s),{latest:this.getAllModulesAsUpdateEvent(!1)}),this.modulesStorage.subscribe(s=>{let c=s.dependenciesModule?.importMapContent,d=this.dependenciesModule?.importMapContent,p=!1,k=!1,$=!1,g=!1;if(c&&d&&c!==d){let _=JSON.parse(c),H=d?JSON.parse(d):void 0;for(let[O,Q]of Object.entries(_.imports??{})){tA(this,Io).set(O,"success");let L=H?.imports?.[O];if(!L){p=!0;continue}L!==Q&&(k=!0)}$=!k&&!p,g=s.metadata.multiplayerChange||k||$}g&&s.metadata.multiplayerChange,this.dependenciesModule=s.dependenciesModule,this.localModules=s.modules;let G=this.moduleDepsGraph;this.moduleDepsGraph=s.depsGraph;let I=new Set,S=[],T=[],v=!1;for(let _ of s.metadata.patches){let H=_.path[0];if(E(typeof H=="string"),H===fe){v=!0;for(let O of s.modules.keys())I.add(O);break}_.op==="remove"&&_.path.length===1?T.push(H):S.push(H)}let P=new Set;if(!v){let _=this.getActiveScope(),H=qn(_);Rj.debug("Calculated visible code component module typeSlashNames",H);for(let O of S)Sr(s.depsGraph,O,I,H,P);for(let O of T)Sr(G,O,I,H,P);S.forEach(O=>{I.delete(O)}),T.forEach(O=>{I.delete(O),P.delete(O)})}Rj.debug("prioritized evaluation sending to sandbox",{dependentModules:I,visibleDependentModules:P},"highprio size",P.size,"dep size",I.size),this.moduleUpdatesEmitter.emit({patches:s.metadata.patches,dependentModules:Array.from(I),prioritizedModules:Array.from(P),revision:++this.revision,initialized:s.initialized})})}getActiveScope(){if(this.chromeStore.mainView===5)return;let e=this.treeStore.tree.getNode(tA(this,Un));if(e)return E(e?.loaded,"Active scope node should be loaded"),e.loaded}setActiveScope(e){FA(this,Un,e)}initialize(){return this.initialized?this.modulesStorage.refresh():(this.setupPollingExternalModulesUpdates(),this.modulesStorage.initialize())}get initialized(){return this.modulesStorage.initialized}whenInitialized(){return this.modulesStorage.whenInitialized()}whenIdle(){return this.modulesStorage.whenIdle()}refresh(){return this.modulesStorage.refresh()}deleteModules(e){return this.modulesStorage.delete(e)}upsertBatch(e){return this.modulesStorage.upsertBatch(e)}forType(e){return new Jn(this.modulesStorage,e,this.debugModuleStoreAndComponentLoaderRevisionsMatch)}getNpmDependencyInstallStatus(e){return tA(this,Io).get(on(e))??"unknown"}async addNpmDependencies(e){let r=typeof this.dependenciesModule>"u"&&!I$(),o=await dB(this.modulesStorage.addNpmDependencies(e)),n=Array.isArray(e)?e:[e],a=n.filter(({target:c})=>!nn(c));for(let c of a)tA(this,Io).set(on(c),o.ok?"success":"failure");if(!o.ok)throw o.error;r&&F$();let i=Object.keys(o.value.dependenciesMap.dependencies),s=n.map(({target:c})=>c).filter(c=>!i.includes(c)&&nn(c));if(s.length>0){let c=RB(s,{max:5,placeholder:"package"});TA({type:"add",variant:"warning",text:`${c} ${s.length===1?"is":"are"} incompatible with Framer`,duration:5e3})}return o.value}changeScope(e){this.setActiveScope(e.id),this.modulesStorage.changeScope(e)}async reinstallNpmDependencies(){return{importMap:await this.modulesStorage.reinstallNpmDependencies()}}async uninstallBlockedNpmDependencies(){return{importMap:await this.modulesStorage.uninstallBlockedNpmDependencies()}}async unsafeUpgradeDependency(e,t,r){return{importMap:await this.modulesStorage.unsafeUpgradeDependency(e,t,r)}}async clearNpmDependencies(){return this.modulesStorage.clearNpmDependencies()}async removeBlockedNpmDependencies(){return{dependenciesMap:await this.modulesStorage.removeBlockedNpmDependencies()}}async rebuildImportMapFromDependencies(){return{importMap:await this.modulesStorage.rebuildImportMapFromDependencies()}}async updateSources(e){return this.modulesStorage.updateSources(e)}async updateDependenciesSource(e,t){await this.modulesStorage.updateDependenciesSource(e,t)}getDependentsOfModule(e){return this.modulesStorage.getDependentsOfModule(e)}async getFileStorageOnLoad(){return await fr.updated,this.getFileStorage()}getFileStorage(){let e=this,{modulesStorage:t}=this,r=new Jn(t,"codeFile",this.debugModuleStoreAndComponentLoaderRevisionsMatch);return{get initialized(){return t.initialized},whenInitialized(){return t.whenInitialized()},hasLocalChanges(){return t.hasLocalChanges()},async addFile({path:o,content:n,pluginId:a}){let i=Qn(e.dependenciesModule,e.localModules),s=wn(Fc(i),o),c=await r.create({name:s,source:n,metadata:{pluginId:a}}),d=e.getModuleEntryByLocalId(c);return E(d,"Module entry for file not found",c),d},async deleteFile(o){return t.delete(o)},async updateFile(o,n){await t.updateSources([{localId:o,source:n,options:{}}]);let a=e.getModuleEntryByLocalId(o);return E(a,"Module entry for file not found",o),await t.update(o,{}),a},async renameFile(o,{newPath:n}){let a=Qn(e.dependenciesModule,e.localModules);n=wn(Fc(a),n),await t.rename(o,n);let i=e.getModuleEntryByLocalId(o);return E(i,"Module entry for file not found",o),i},getFileById(o){return Qn(e.dependenciesModule,e.localModules)[o]},getFileByName(o){let n=Qn(e.dependenciesModule,e.localModules);return Object.values(n).find(a=>a?.path===o)},subscribe(o){return t.subscribe(n=>{let a={hasLocalChanges:n.metadata.hasLocalChanges,didRemoteChange:n.metadata.didRemoteChange,changes(){return cG(n.metadata.patches,n.dependenciesModule,n.modules,n.deletedLocalIdsByTypeSlashNames)}};o({files:Qn(n.dependenciesModule,n.modules),metadata:a})})}}}async getModuleDependencies(e){let t=await this.modulesAPIServicePromise;return E(t,"Modules API service not initialized correctly"),await t.getModuleDependencies(e)}getModuleEntryByLocalId(e){for(let t of this.localModules.values())if(t.localId===e)return t}getPersistedDependenciesModule(){return this.modulesStorage.getPersistedDependenciesModule()}getPersistedModuleByGlobalId(e){return this.modulesStorage.getPersistedModuleByGlobalId(e)}getPersistedModuleByLocalId(e){return this.modulesStorage.getPersistedModuleByLocalId(e)}getPersistedModuleByLocalIdentifier(e){let t=jA(e);if(KA(t))return this.getPersistedModuleByLocalId(t.localId)}tryConvertExternalCodeComponentIdentifierToLocal(e){let t=jA(e);if(t?.kind!=="externalModuleExport")return;let r=this.getPersistedModuleByGlobalId(t.moduleId);if(r)return li(r.localId,t.exportSpecifier).value}async listNamespaces(){let e=await this.modulesAPIServicePromise;return E(e,"Modules API service not initialized correctly"),await e.listNamespaces()}async lookUpModule(e,t){let{modules:r,dependencies:o}=await this.lookUpModules([e],t),n=r[0];E(n,"Module does not exist, looking up:",e);let a={module:n};return o&&(a.dependencies=o[n.ownerType]?.[n.ownerId]),a}async lookUpModules(e,t){let r=await this.modulesAPIServicePromise;if(!r)return Rj.error("Modules API service not initialized correctly"),{modules:[],dependencies:{}};let{data:o,dependencies:n}=await r.lookUpModules({queries:e,...t}),a=new Map(this.externalModulesDynamicInfo);for(let s of o){let c=s.id,{localId:d,title:p,description:k,lastPublish:$,status:g}=s;a.set(c,{localId:d,title:p,description:k,lastPublish:$,status:g??a.get(c)?.status})}this.externalModulesDynamicInfo=a;let i={modules:o};return n&&(i.dependencies=n),i}trackExternalComponentInsert(e,t){let r=Et();for(let o of e)Vm({insertId:r,insertType:t,codeComponentId:o})}async installExternalModulesDependencies(e){let t=[],r=[];for(let o of e){let n=tA(this,Wn).get(o);n?r.push(n):t.push(o)}if(t.length>0){let o=this.installDependenciesForModuleURLs(t);for(let n of t)tA(this,Wn).set(n,o);r.push(o)}return Promise.allSettled(r).then(o=>{for(let n of o)n.status!=="fulfilled"&&Rj.error("Failed to install external module",n.reason)})}isProcessingModules(){return this.modulesStorage.isProcessing()}resetModuleStateAndPermissions(e){this.modulesStorage.resetModuleStateAndPermissions(e)}getTransientSave(e){return this.modulesStorage.getTransientSave(e)}startUsingLocalModulesInTree(){return this.modulesStorage.startUsingLocalModulesInTree()}stopUsingLocalModulesInTree(){return this.modulesStorage.stopUsingLocalModulesInTree()}usingLocalModulesInTree(){return this.modulesStorage.usingLocalModulesInTree()}createFastRefreshModuleFromModule(e){if(MB.has(e.type)){if(e.kind==="server"){let t=this.getPersistedModuleByLocalId(e.localId);E(t?.kind==="server","Only server modules should have no sourceContent"),this.modulesStorage.createLocalModuleFromModule(t).catch(yA);return}this.compileFastRefreshModule({name:bA(e),localId:e.localId,source:e.sourceContent}).catch(yA)}}getModuleWithTypeSlashName(e){return this.modulesStorage.getModuleWithTypeSlashName(e)}waitForModulesToSave(){return this.modulesStorage.waitForModulesToSave()}installDependenciesForModuleURLs(e){return Rj.info(`\u{1F986} Installing external modules:
	`,e.join(`
	`)),this.lookUpModules(e.map(t=>({url:t})),{includeDependencies:!0}).then(async({dependencies:t={}})=>{let r=Object.values(t).flatMap(a=>Object.values(a)),o,n;for(let{dependencies:a,importMap:i}of r)if(i){o=Zr(o??{imports:{}},i);let s=a??jo(i);n=Ao(n??{dependencies:{}},s)}o&&n&&await this.modulesStorage.extendCurrentImportMap(o,n)})}async addOrUpdateExternalVectors(e){await this.modulesStorage.whenInitialized();let{modules:t}=await this.lookUpModules(e.filter(n=>{let a=this.treeStore.tree.getNodeWithTrait(n.moduleId,Le);return a?jA(a.codeComponentIdentifier).saveId!==n.saveId:!0}),{includeDependencies:!1,includeStatus:!0}),r=new Map,o="default";for(let n of t){let a=Lc({module:n,exportSpecifier:o}),i=this.treeStore.tree.getNodeWithTrait(n.id,Le);aj(i?.codeComponentIdentifier)&&jA(i.codeComponentIdentifier).saveId===n.saveId||r.set(a.value,{module:n,exportSpecifier:o})}await Promise.all(Array.from(r.keys(),n=>{let a=jA(n);return E(a,"Identifier must be a valid module identifier"),this.loadedExternalModulesStore.ensureModuleEvaluatedInSandbox(a).catch(i=>{Rj.error(`Failed to evaluate external module "${n}"`,i)})})),await new Promise((n,a)=>{this.runWithFullyLoadedTree(()=>{this.updateExternalModuleNodes(Array.from(r.values()),{onTreeUpdate:()=>{let i=SB(r.keys());bB(i,this.treeStore.getLoadedIndexes().codeComponents),CB(i,this.treeStore.tree),TB(i,this.treeStore.tree)},updateSave:!0}).then(n).catch(a)},{name:"update_external_module_version",runInBackground:!0})})}async addOrUpdateVectorSetAndVectors(e){await this.addOrUpdateExternalVectors([e]);let r=this.treeStore.tree.getNodeWithTrait(e.moduleId,Le)?.annotation("framerVectorSet");x6(r)&&await this.addOrUpdateExternalVectors(r.items.map(o=>({moduleId:o.moduleId,saveId:o.saveId??""})))}async addExternalModulesToProject(e,t){let r=e.map(n=>typeof n=="string"?jA(n):n),o=await this.preloadExternalModules(r);return this.updateExternalModuleNodes(o,t)}async preloadExternalModules(e){await this.modulesStorage.whenInitialized();let t=new Map;for(let s of e)t.set(s.bareValue,s);let r=[],o=[],n=[];for(let[s,c]of t){let{moduleId:d,saveId:p}=c;if(!!this.modulesStorage.getPersistedModuleByGlobalId(d)){Rj.reportError("Attempted to treat local module as external module",{identifier:c});continue}let $=this.treeStore.tree.getNode(d);if($&&jA($.codeComponentIdentifier).saveId===p&&!this.loadedExternalModulesStore.hasModuleForIdentifier(c)){o.push(c);continue}let g=tA(this,Mt).get(s);if(g){n.push({identifier:c,preloadPromise:g});continue}tA(this,Mt).set(s,Vt()),r.push(c)}let a=new Map;for(let{identifier:s,preloadPromise:c}of n)try{let d=await c;a.set(s.value,d)}catch{tA(this,Mt).set(s.bareValue,Vt()),r.push(s)}if(r.length)try{let s=Array.from(r.values(),({moduleId:k,saveId:$})=>({moduleId:k,saveId:$})),{modules:c,dependencies:d}=await this.lookUpModules(s,{includeDependencies:!0,includeStatus:!0}),p=0;for(let k of r){let $=c[p++];E($,"Module must be defined"),a.set(k.value,{module:$,dependencies:d?.[$.ownerType]?.[$.ownerId],exportSpecifier:k.exportSpecifier}),o.push(k)}}catch(s){Rj.reportError(s);for(let c of r)tA(this,Mt).get(c.bareValue)?.reject(s);throw Error(`Failed to preload modules: ${s}`)}let i;for(let s of o){let c=a.get(s.value);if(!c)continue;let{dependencies:d}=c;d?.importMap&&(i=Zr(i??{imports:{}},d.importMap))}i&&await this.insertTemporaryImportMap(i),await Promise.all(Array.from(o.values(),s=>this.loadedExternalModulesStore.ensureModuleEvaluatedInSandbox(s).catch(c=>{Rj.error(`Failed to evaluate external module "${s.value}"`,c)})));for(let s of r){let c=a.get(s.value);E(c,"Expected to have module information for:",s.value);let d=tA(this,Mt).get(s.bareValue);E(d,"Expected to find a preload promise for:",s.bareValue),d.resolve(c)}return[...a.values()]}async updateExternalModuleNodes(e,{onTreeUpdate:t,updateSave:r=!1}){let o,n;for(let{dependencies:a}of e)if(a?.importMap){o=Zr(o??{imports:{}},a.importMap);let i=a.dependencies??jo(a?.importMap);n=Ao(n??{dependencies:{}},i)}return o&&!vk(o)&&n&&await this.modulesStorage.extendCurrentImportMap(o,n),await Promise.all(e.map(a=>this.loadedExternalModulesStore.ensureModuleEvaluatedInSandbox(Lc(a)))),this.processWhenReadyAsync(()=>{if(this.treeStore.tree.isViewOnly)throw Error("unable to edit");for(let a of e){let{id:i,type:s,metadata:c,ownerId:d,ownerType:p}=a.module,k=Lc(a),{title:$,status:g}=this.externalModulesDynamicInfo.get(k.moduleId)??a.module,G=this.treeStore.tree.getExternalModulesListNode();G||(G=new mu,this.treeStore.tree.insertNode(G,this.treeStore.tree.root.id)),E(S7(G));let I=c.pluginId,S={codeComponentIdentifier:k.value,type:s,scopeNodeId:Nk(a.module),intrinsicWidth:Ve(c.intrinsicWidth)??200,intrinsicHeight:Ve(c.intrinsicHeight)??200,ownerId:d,ownerType:p,group:g?.group,updateSaveId:g?.updateSaveId,namespaceId:a.module.lastPublish?.namespaceId,pluginId:M(I)?I:void 0},T=V.componentForIdentifier(k.value);E(T,"Component not found in the component loader",k.value);let v=T.annotations??void 0;S.annotations=Eu(s)?eo({default:v}).default:v;let P=T.name??$;S.title=P;let _=this.treeStore.tree.getNode(i);if(_)if(r)_.set(S);else{let{group:H,updateSaveId:O}=S;_.set({group:H,updateSaveId:O})}else _=new fu({id:i,...S}),this.treeStore.tree.insertNode(_,G.id)}return t()})}setupPollingExternalModulesUpdates(){let e=PB(()=>{this.checkForExternalModuleUpdates().catch(Rj.reportError)},1e4),t=()=>{e(),this.updatesPollId===void 0&&(this.updatesPollId=window.setInterval(this.checkForExternalModuleUpdates,6e4))},r=()=>{window.clearInterval(this.updatesPollId),this.updatesPollId=void 0};function o(){return!document.hidden&&navigator.onLine}o()&&t();function n(){setTimeout(()=>{o()?t():r()},500)}document.addEventListener("visibilitychange",n),window.addEventListener("offline",n),window.addEventListener("online",n)}getCodeComponentNodesForExternalModuleExport(e){return this.treeStore.getLoadedIndexes().codeComponents.filter(t=>{if(!z(t)||hA(t)&&!t.isVectorInstance)return!1;let r=jA(t.codeComponentIdentifier);return r?.kind!=="externalModuleExport"?!1:r.moduleId===e.moduleId&&r.exportSpecifier===e.exportSpecifier})}get fastRefreshEnabled(){return this.chromeStore.codeEditorPreviewVisible}async updateExternalModuleComponentInstances(e){let t=jA(e);E(t?.kind==="externalModuleExport","parsed 'ExternalModuleNodes.id' should be of kind externalModuleExport");let{moduleId:r,exportSpecifier:o}=t,n=this.externalModulesDynamicInfo.get(r)?.status?.updateSaveId;if(!n){Rj.warn("Could not update module",r,"latest status missing");return}let{module:a,dependencies:i}=await this.lookUpModule({moduleId:r,saveId:n},{includeDependencies:!0,includeStatus:!0});E(a.files.module,"Module file must be defined");let s=Yj(r,n,a.files.module,o);try{await this.loadedExternalModulesStore.ensureModuleEvaluatedInSandbox(s).catch(Rj.reportError),await new Promise((c,d)=>{this.runWithFullyLoadedTree(()=>{this.updateExternalModuleNodes([{module:a,dependencies:i,exportSpecifier:o}],{onTreeUpdate:()=>{this.getCodeComponentNodesForExternalModuleExport(t).forEach(k=>k.set({codeComponentIdentifier:s.value})),If(this.treeStore.tree,t.value,s.value),GB(this.treeStore.tree,t.value,s.value)},updateSave:!0}).then(c).catch(d)},{name:"update_external_module_version",modalTitle:"Updating the module version"})}),this.trackExternalComponentInsert([s.value],"update")}catch(c){Rj.reportError(c)}}async replaceRelativeImportsWithImportMapSpecifiers(e,t,r){let o={};for(let a of r){let i=ce(a,e);if(!i)continue;let s;if(s=this.fastRefreshModules.get(i),s||(s=this.modulesStorage.getModuleWithTypeSlashName(i)),!s){Rj.error("Cannot resolve",a,"from",e);continue}let c,{name:d,localId:p}=s;if(s.kind==="fast-refresh")c=Qj(d).module;else{let{files:k}=s;E(M(k.module),"Must have a module file name to build a local module import map specifier."),c=k.module}o[a]=di(p,c)}let n=await Es(t,o);return E(n.ok),n.value}getModules(e=!1){let t={};for(let[r,o]of this.localModules)t[r]=o;if(e)for(let[r,o]of this.fastRefreshModules)t[r]=o;return{dependenciesModule:this.dependenciesModule,modules:t,revision:this.revision,initialized:this.modulesStorage.initialized}}getAllModulesAsUpdateEvent(e=!1){let{dependenciesModule:t,modules:r,initialized:o,revision:n}=this.getModules(e),a=[];t&&a.push({op:"add",path:[`${t.type}/${t.name}`],value:t});for(let i of Object.values(r))a.push({op:"add",path:[`${i.type}/${i.name}`],value:i});return{patches:a,dependentModules:[],prioritizedModules:[],initialized:o,revision:n}}getModulesUpdatesService(e=!1){return{moduleUpdatesStream:()=>e?this.fastRefreshModulesEmitter.newStream({replay:"latest"}):this.moduleUpdatesEmitter.newStream({replay:"latest"})}}hasScreenModuleLoaded(e){let t=Kt("screen",e,"default").value;return V.componentForIdentifier(t)!==null}postProcess(){this.modulesStorage.processTreeUpdates()}};Io=new WeakMap,Un=new WeakMap,Wn=new WeakMap,Mt=new WeakMap;function Qn(A,j){let e={};if(Jj.isOn("showImportMap")&&A){let{importMap:t,dependenciesMap:r}=DB(A);e[t.id]=t,e[r.id]=r}for(let t of j.values())Oc(t)&&(e[t.localId]={id:t.localId,path:t.name,content:t.sourceContent});return e}function cG(A,j,e,t){let r=[];for(let o of A){let n=o.path[0];switch(E(typeof n=="string","The first element of patch.path is expected to be module's typeSlashName"),o.op){case"add":case"replace":{if(n===fe){if(!Jj.isOn("showImportMap"))break;E(j,"dependenciesModule is expected to be defined");let{importMap:s,dependenciesMap:c}=DB(j);r.push({type:o.op==="add"?"added":"changed",file:s},{type:o.op==="add"?"added":"changed",file:c});break}let a=e.get(n);if(E(a,n,"is expected to be in newModules"),!Oc(a))break;let i=a.sourceContent;r.push({type:o.op==="add"?"added":"changed",file:{id:a.localId,path:n,content:i}});break}case"remove":{let a=t[n];E(a,n,"is expected to be in deletedLocalIdsByTypeSlashNames"),r.push({type:"deleted",file:{id:a,path:n}});break}default:cA(o.op)}}return r}function DB(A){return{importMap:{id:To,path:To,content:A.importMapContent},dependenciesMap:{id:Po,path:Po,content:A.dependenciesMapContent}}}var pG={defaultComponent:{insert:"insert-default",drag:"insert-default-drag"},libraryModule:{insert:"insert-library",drag:"insert-library-drag"},externalModuleComponent:{insert:"insert",drag:"insert-drag"}},qc="default_component_",gs="external_",Kc="local_",NB="legacy_design_component",xB="legacy_code_component",OB=`${Kc}${xB}`,kG=`${gs}${xB}`,wB=`${Kc}${NB}`,LB=`${gs}${NB}`;var uG=new Set(["form","frame","image-frame","stack","repeater"]),mG=A=>A.startsWith(qc),qB=A=>A===wB||A===LB,EG=A=>uG.has(A);function KB({canvasNode:A,source:j,isDrag:e,engine:t}){let r=fG(A,t);switch(BA("component_instance",{componentType:r.type,source:j}),j){case"insert_menu":{let o=$G(r);BA("insert_menu_add",{type_added:o});break}}if(r.type==="local_module_canvasComponent_component"&&BA("component_canvas_instance",{componentId:A.id}),qB(r.type)&&BA("component_design_instance",{}),z(A)&&ne(A.codeComponentIdentifier)){let o=r.type.startsWith(qc)?"defaultComponent":j==="team_library"?"libraryModule":"externalModuleComponent",n=pG[o][e?"drag":"insert"];t.stores.modulesStore.trackExternalComponentInsert([A.codeComponentIdentifier],n)}}function fG(A,j){if(z(A)){let r=A.codeComponentIdentifier,o=jA(r);if(!o)return{type:A.codeComponentIdentifier.startsWith(".")?OB:kG,codeComponentIdentifier:r};if(KA(o))return{type:`${Kc}module_${o.type}_component`,codeComponentIdentifier:r};if(ne(o)){let n=j.tree.getNode(o.moduleId);return Sa(j,r)?{type:`${qc}${n?.title}`,codeComponentIdentifier:r}:{type:`${gs}module_${n?.type??"unknown"}_component`,codeComponentIdentifier:r}}}let t=A.replicaInfo?.master&&j.tree.getNode(A.replicaInfo.master)||A;return vj(t)?_o(t)?{type:LB}:{type:wB}:yi(A)?{type:"repeater"}:Jr(A)?{type:"form"}:LA(A)?{type:"stack"}:fA(A)?A.fillType==="image"?{type:"image-frame"}:{type:"frame"}:{type:"unknown"}}function $G({type:A}){return A.startsWith("local_module_")||A===OB?"code_component":qB(A)?"design_component":A.startsWith(gs)?"package":mG(A)||EG(A)?A:"unknown"}function Vc(A,j){let e=A.children;return ie(A)?!e||e.length===0?[]:j.getChildrenRects(A.id)??[]:null}function ZW(A,j,e){if(!A||!vA(A))return;let t=[];for(let r=0,o=A.children.length+1;r<o;r++){let n=A.children[r];if(!Ge(n,A))continue;let a=Vc(A,e);if(!a||a.length===0)return;let i=a.splice(r,j.length),s=w.merge(...i);t.push(s)}return t}function VB(A,j,e){if(A>=j&&A<=e||A<=j&&A>=e)return 0;let t=Math.abs(j-A),r=Math.abs(e-A);return Math.min(t,r)}function BG(A,j,e){let t=A?"y":"x",r=A?"height":"width",o=j[t],n=0,a=1/0;return e.forEach((i,s)=>{if(a===0)return;let c=i[t],d=c+i[r],p=VB(o,c,d);p<a&&(n=s,a=p)}),n}function gG(A,j,e,t){let r=Math.max(A,e),o=Math.min(j,t);return r<o}function hG(A,j,e){let t=A?"y":"x",r=A?"height":"width",o=e[j];E(o,"Out of bound access to childRects:",j,e);let n=o[t],a=n+o[r],i=new Set([j]);return e.forEach((s,c)=>{if(c===j)return;let d=s[t],p=d+s[r];gG(n,a,d,p)&&i.add(c)}),{startIndex:Math.min(...i),endIndex:Math.max(...i)}}function RG(A,j,e,t,r,o){if(r)return t.startIndex;if(o)return t.endIndex;let n=j?"x":"y",a=j?"width":"height",i=A[n],s=1/0,c=t.startIndex;for(let d=t.startIndex;d<=t.endIndex;d++){let p=e[d];E(p,"Ouf of bound access to childRects:",d,t,e);let k=p[n],$=k+p[a],g=VB(i,k,$);g<s&&(s=g,c=d)}return c}function IG(A,j){let e=[];for(let t=j.startIndex;t<=j.endIndex;t++){let r=A[t];E(r,"Ouf of bound access to childRects:",t,j,A),e.push(r)}return w.merge(...e)}function FG(A,j,e,t){let r=Oe(A)||A.resolveValue("stackDirection")==="horizontal",o=w.merge(...j),n=r?"x":"y",a=r?"y":"x",i=r?"width":"height",s=r?"height":"width",c=e[n],d=e[a],p=o[a],k=p+o[s],$=d<p,g=!$&&d>k,G=BG(r,e,j),I=hG(r,G,j),S=RG(e,r,j,I,$,g),T=j[S];E(T,"Closest rect is not defined:",S);let v=T[n]+T[i]/2,P=$||g?$:c<v,_=P?S:S+1;$&&(_=0),g&&(_=j.length);let H=T[n],O=H+T[i],Q=P?H:O,L=null,dA=P?S-1:S+1;if(dA>=I.startIndex&&dA<=I.endIndex){let cj=j[dA];if(cj){let xj=cj[n],ke=xj+cj[i];L=P?ke:xj}}let N=Q;Z(L)&&(N=Math.round((N+L)/2));let X=IG(j,I),Y=Math.round(X[a]+X[s]/2),nA={[n]:N,[a]:Y},aA={...nA},PA={...nA},YA=t[s],Ij=Math.round(YA/2);return r?(aA.y-=Ij,PA.y+=Ij):(aA.x-=Ij,PA.x+=Ij),{index:_,line:{a:aA,b:PA}}}function JB(A,j,e,t,r){if(E(j.length,"childInsertion only works correctly if there are more than 0 child rects"),Oe(A)||A.stackWrapEnabled)return FG(A,j,t,r);let o=1/0,n=null,a=A.stackDirection==="vertical";j.forEach((d,p)=>{let k=Math.abs(a?t.y-d.y:t.x-d.x);k>o||(o=k,n=p)});let i=0;if(n!==null){let d=j[n];E(d,"Closest child rect is not defined:",n);let p=w.center(d);(a?t.y>p.y:t.x>p.x)&&n++,i=Math.min(Math.max(0,n),j.length)}let s=SG(A),c=yG(A.resolveValue("stackDirection"),A.resolveValue("stackAlignment"),s,e,j,i,r);return{index:GG(A,i),line:c}}function GG(A,j){E(vA(A),"A node must support children to consider an insertion index.");let e=j;for(let t=0;t<A.children.length&&t!==j;t++){let r=A.children[t];r&&(Ge(r)||e++)}return e}function SG(A){let j=A.resolveValue("stackDirection"),e=A.resolveValue("stackAlignment");if(e==="center")return 0;let t=Yr(A);if(!t.perSide)return t.top;let r=e==="start";return j==="vertical"?r?t.left:t.right:r?t.top:t.bottom}function yG(A,j,e,t,r,o,n){let a=r[o-1],i=r[o],s=A==="vertical",c={x:t.width/2,y:t.height/2};if(!(!a&&!i)){if(r.length===1){let d=a||i;E(d,"Child rect must be defined"),o===0?s?c.y=d.y-10:c.x=d.x-10:s?c.y=d.y+d.height+10:c.x=d.x+d.width+10}else if(a&&i){let d=Math.abs(s?a.y+a.height-i.y:a.x+a.width-i.x);s?c.y=i.y-d/2:c.x=i.x-d/2}else if(a){let d=r[o-2];E(d,"Child rect must be defined");let p=Math.abs(s?d.y+d.height-a.y:d.x+d.width-a.x);s?c.y=a.y+a.height+p/2:c.x=a.x+a.width+p/2}else if(i){let d=r[o+1];E(d,"Child rect must be defined");let p=Math.abs(s?i.y+i.height-d.y:i.x+i.width-d.x);s?c.y=i.y-p/2:c.x=i.x-p/2}}return c.x=Math.min(Math.max(4,c.x),t.width-4),c.y=Math.min(Math.max(4,c.y),t.height-4),bG(A,j,e,c,t,n)}function bG(A,j,e,t,r,o){let n=A==="vertical",a,i,s=e??0;switch(j){case"center":a={x:n?t.x-o.width/2:t.x,y:n?t.y:t.y-o.height/2},i={x:n?t.x+o.width/2:t.x,y:n?t.y:t.y+o.height/2};break;case"start":a={x:n?s:t.x,y:n?t.y:s},i={x:n?o.width+s:t.x,y:n?t.y:o.height+s};break;case"end":default:a={x:n?r.width-o.width-s:t.x,y:n?t.y:r.height-o.height-s},i={x:n?r.width-s:t.x,y:n?t.y:r.height-s};break}return{a,b:i}}var HB=6;function CG(A,j){for(let e of A)if(j.includes(e))return!0;return!1}function vG(A,j,e,t,r){if(r.length===0||A.stackWrapEnabled||CA(A)||hA(A))return null;let{tree:o,zoom:n}=j,a=o.getParent(A.id);if(a&&LA(a)&&(a.stackDirection!==A.stackDirection||a.stackWrapEnabled))return null;let i=o.convertPointToNode(A,e),s=o.getRect(A),c=A.stackDirection==="vertical",d=c?"x":"y",p=c?"y":"x",k=c?"width":"height",$=c?"height":"width",g=s[k],G=s[$],I=g*n,S=g*n;if(I<40||S<40)return null;let T=i[d],v=10/n,P=w.merge(...r),_=P[d],H=_+P[k],O=Math.max(v,_/2),Q=Math.max(v,(g-H)/2),L=T<=O,dA=T>=g-Q;if(!L&&!dA)return null;let N=L?0:1,X=t[$],Y=4/n,nA=L?Y:g-Y,aA=G/2,PA=X/2,YA=G/3,Ij=i[p],uj="end";X>G?uj="center":Ij<YA?uj="start":Ij<2*YA&&(uj="center");let cj,xj;switch(uj){case"start":{cj=0,xj=X;break}case"end":{xj=G,cj=xj-X;break}case"center":default:{cj=aA-PA,xj=aA+PA;break}}let ke={[d]:nA,[p]:cj},wt={[d]:nA,[p]:xj},ni=o.convertPointToCanvas(A,ke),ii=o.convertPointToCanvas(A,wt);return{insertionIndex:N,insertionLine:{a:ni,b:ii},wrap:{wrapAlignment:uj}}}function Jc(A,j,e,t,{allowWrapping:r=!0}={}){if(!vA(A))return{insertionIndex:null,insertionLine:null};let o=Vc(A,j.stores.layoutCache);if(!o)return{insertionIndex:null,insertionLine:null};if(LA(A)&&r){let p=vG(A,j,e,t,o);if(p)return p}let n=j.tree,a=n.getRect(A),i=n.convertPointToNode(A,e);if(o.length===0)return{insertionIndex:0,insertionLine:null};let{index:s,line:c}=JB(A,o,a,i,t),d={a:n.convertPointToCanvas(A,c.a),b:n.convertPointToCanvas(A,c.b)};return{insertionIndex:s,insertionLine:d}}var TG={width:10,height:10};function QB(A,j,e,t,r,o=!1){E(e.length,"getStackOrGridInRange(): expects at least a single selected node");let n=A.stores.scopeStore.active;if(e.some($j))return null;let i=A.tree.getNodesAtPoint(n,j).filter(d=>!(cr(d)&&d.locked||!vA(d)||cE(d)||hp(A.tree,A.overlayStore.activeOverlays,d))).reverse();if(t){let d=t.id,p=i.find(k=>k.id===d);if(p)return p}let s=null,c=e.map(d=>d.id);for(let d of i){if(!K7(d)||o&&!GA(d))continue;let p=A.tree.getAncestors(d.id);if(p.push(d.id),CG(p,c)||(s||(s=d),!se(d)))continue;let{insertionLine:$}=Jc(d,A,j,TG);if(!$)continue;if($.a.x===$.b.x){if(Math.abs(j.x-$.a.x)*A.zoom>HB)continue}else if($.a.y===$.b.y){if(Math.abs(j.y-$.a.y)*A.zoom>HB)continue}else continue;if(e.every(G=>ht(A.tree,d,G,n.id,r)))return d}if(se(s)){let d=s;if(e.every(k=>ht(A.tree,d,k,n.id,r)))return s}return null}function UB(A,j,{wrapAlignment:e}){let t=kc.addStack(A,[j]);if(!t)return null;let r=A.tree.getNode(t);return!r||!LA(r)?null:(r.set({stackDirection:j.stackDirection==="horizontal"?"vertical":"horizontal",stackAlignment:e}),r)}function Hc(A,j){let{width:e,height:t}=A.tree.getRect(j);return $A(j)&&WA(j)&&(j.widthType===2&&j.width>0&&(e=j.width),j.heightType===2&&j.height>0&&(t=j.height)),{width:e,height:t}}function PG(A,j,e){let t=Hc(A,j);return{...t,x:e.x-t.width/2,y:e.y-t.height/2}}function MG(A,j){let e=Hc(A,j),t=A.stores.scopeStore.active,r=A.tree.getCommonGroundNode(A.selection.nodes),o,n;if(r){let i=A.tree.convertFrameToCanvas(r);o=w.center(i).x-e.width/2,n=i.y}else if(J(t)||rA(t)){let i=t.getPrimaryVariant(),s=A.tree.convertFrameToCanvas(i);o=w.center(s).x-e.width/2,n=s.y}else{let i=A.canvasStore.getCanvasCenter();o=i.x-e.width/2,n=i.y-e.height/2}let a={x:o,y:n};for(;;){let i={...e,...a},s=A.tree.getNodesInRect(t,i,!0);if(s.length===0)return i;let c=A.tree.getBoundingFrameForNodes(s);a.x=c.x-e.width-100}}function _G(A,j,e,t=!1){let{tree:r}=A,o=r.getPotentialParents(A.stores.scopeStore.active,A.overlayStore.activeOverlays,w.cornerPoints({...e,width:1,height:1}),e,V,j);return t&&(o=o.filter(GA)),o=r.sortVisually(o).reverse(),o.length>0&&o[0]?o[0]:null}var WB={width:1,widthType:1,heightType:2,left:0,right:null};function zB({engine:A,component:j,canvasPoint:e,source:t,type:r,shouldBecomeFullWidthForVariants:o=new Set,isLayoutSection:n=!1,notDraggedOntoCanvas:a=!1,insertAsGroundNode:i=!1,insertAsOverlayType:s,imageToUpload:c}){KB({canvasNode:j,source:r==="libraryModule"?"team_library":t,isDrag:!0,engine:A});let d=i?MG(A,j):PG(A,j,e);s===1&&ft(j)&&j.set({floatingPositionEnabled:!0,floatingPlacement:Vi,floatingAlignment:Ji,floatingOffsetX:0,floatingOffsetY:10});let p=os(A,j),k=QB(A,e,[p],null,V,n);if(a&&n&&!k){let Q=A.canvasStore.getCanvasVisibleRectTakingOverlaysIntoAccount(),L=A.selection.ids.length===1&&A.selection.ids[0]?A.tree.getNode(A.selection.ids[0]):null,dA=L?A.tree.getGroundNodeFor(L):null;se(dA)&&w.intersects(A.tree.convertFrameToCanvas(dA),Q)&&(k=dA)}let $=k??_G(A,j,e,n),g=A.selection.ids.length===0,G=A.stores.scopeStore.active,I=Kr(G)?G.getPrimaryVariant():null;if(a&&n&&I&&g&&($=I),s===1&&$&&ft(p)&&!GA($)){E($,"Parent should exist");let Q=$.originalid??$.id,L=za(A.stores,"framer/useShowRelativeOverlay",Q,p.draftOrCurrent());if(!L)return;A.tree.move(L.id,Q);return}else ft(p)&&p.set(fp);if(i&&($=null,k=null,!w.containsRect(A.canvasStore.getCanvasVisibleRectTakingOverlaysIntoAccount(),d))){let Q=w.center(d),L=A.canvasStore.zoom,dA=Math.min(L,1);A.canvasStore.scrollToCenter(Q,{animate:!0,zoom:dA})}let S=-1,T=null;if($){NE(A,$,j,d),xE(A,$,j);let Q=$.draftOrCurrent();LA(Q)&&(k=Q)}if(k){let Q=Hc(A,j),{insertionIndex:L,wrap:dA}=Jc(k,A,e,Q);if(dA&&(T=dA),Z(L)&&(S=L),a&&n){if(S=k.children.length,A.selection.ids.length===1){let Go=A.selection.ids[0],ai=Go&&A.tree.getNode(Go);if(ai){let _s=new Set([ai.id]);for(let si of ai.ancestors())_s.add(si.id);let Ds=k.children.findIndex(si=>_s.has(si.id));Ds>=0&&(S=Ds+1)}}let N,X=k.children[S-1];X?(N=A.tree.convertFrameToCanvas(X),N.y+=N.height):N=A.tree.convertFrameToCanvas(k),N.height=Q.height;let Y=A.tree.convertFrameToCanvas(k),nA=Math.min(N.x,Y.x),aA=Math.max(w.maxX(N),w.maxX(Y));N.x=nA,N.width=aA-nA;let{zoom:PA}=A.canvasStore,YA=A.canvasStore.getCanvasVisibleRectTakingOverlaysIntoAccount(),Ij=YA.width*PA,uj=YA.height*PA,cj=40,xj=Math.max(Ij-cj*2,100),ke=Math.max(uj-cj*2,100),wt=xj/(N.width||1),ni=ke/(N.height||1),ii=Math.min(wt,ni,.5),Ms=w.center(N);A.canvasStore.scrollToCenter(Ms,{animate:!0,zoom:ii})}OE(A,k,j,d)}let v;if($){let{width:Q,height:L}=d;v={...A.tree.convertCanvasFrameToNode($,d),width:Q,height:L}}else v=d;let P=p.updateForRect({rect:v,parentSizeInfo:null,constraintsLocked:!1,shouldGuessPinToBottom:$?jt(A.tree,p,$):!0,shouldGuessPinToRight:$?Vj(A.tree,p,$):!0});$&&LA($)&&WA(p)&&$A(p)&&(P=NG(p,P)),M$(p,P),p.set(P,A.tree);let _=p.id,H=!1,O=null;if($){if(O=$,ij($)&&(O=A.tree.getNode($.originalid),H=!0,E(O,"Fail to insert node into variants: the original parent should exist")),T&&!hA(O)&&LA(O)){let dA=UB(A,O,T);if(!dA)return;O=dA}A.moveNode(p.id,O.id,S),H&&(E(hA($),"Fail to insert node into variants: the new parent should be a replica node"),_=fn(A,p,$,O));let Q=A.tree.getGroundNodeFor(O),L=!!(Q.name&&o.has(Q.name.toLowerCase()));if(fA(p)&&L&&p.set({left:0,width:1,widthType:1},A.tree),z(p)&&nj(Q)&&GA(Q)){let N={width:p.width,widthType:p.widthType,left:p.left,right:p.right};L&&p.set(WB);let X=Dl(p);if(X){let Y=A.tree.getScopeNodeFor(Q);J(Y)&&Y.getTopLevelReplicaVariants().forEach(aA=>{if(!aA.name)return;let PA=Nl(aA.name,X);if(!PA||PA===X.defaultVariant)return;let YA={...aA.replicaInfo.overrides},Ij={...aA.replicaInfo,overrides:YA},uj={...YA[p.id]},cj=DG(L,o,aA.name,N);cj&&Object.assign(uj,cj),uj[VA(X.key)]={type:"enum",value:PA},YA[p.id]=uj,aA.set({replicaInfo:Ij})})}}Oe($)&&Yt(p)&&(L||p.set({gridItemFillCellWidth:!0}),p.set({gridItemFillCellHeight:!0}))}c&&fA(j)&&Rm(c,j,A).catch(yA),A.selection.set(_,{switchToLayers:!0})}function DG(A,j,e,t){let r=j.has(e.toLowerCase());if(A!==r)return r?WB:t}function NG(A,j){let e={...j};return(A.widthType===3||A.widthType===1)&&Z(j.width)&&j.widthType!==A.widthType&&(delete e.width,delete e.widthType),(A.heightType===3||A.heightType===1)&&Z(j.height)&&j.heightType!==A.heightType&&(delete e.height,delete e.heightType),e}function hs({engine:A,module:j,identifier:e,position:t,centerInParent:r,insertAsGroundNode:o,update:n}){let a={width:Ve(j.metadata.intrinsicWidth)??200,height:Ve(j.metadata.intrinsicHeight)??200},i=new pr({codeComponentIdentifier:e,slotsAreChildNodes:zA.isOn("componentSlotsAreChildNodes"),...a});n&&n(i);let s=t;if(r&&!o){let c=AB(i,A),d=c?w.center(A.tree.convertFrameToCanvas(c)):null,p=A.canvasStore.getCanvasVisibleRectTakingOverlaysIntoAccount();d&&w.containsPoint(p,d)&&(s=d)}return zB({engine:A,component:i,canvasPoint:s,source:"context_menu",insertAsGroundNode:o}),i}var zn=mA("unlinking");async function xG(A,j,e){A.codeEditorStore.closeEditor();let[t]=A.selection.nodes;if(A.selection.nodes.length===1&&z(t)&&t.codeComponentIdentifier===j)return!0;let r=await A.runWithFullyLoadedTreeAsync(()=>{for(let o of A.stores.treeStore.treeIndex.codeComponentNodeIds){let n=A.tree.getNodeWithTrait(o,z);if(n?.codeComponentIdentifier===j)return n}},{runInBackground:!0,name:`findCodeComponentInstance: ${j}`});return r?(_$(A,r),!0):(TA({type:"add",variant:"info",key:"add-component-instance-to-edit-in-plugin",text:`Add this Component to Canvas to edit in ${e.name}`}),!1)}async function XB(A,j,e){return await xG(A,j,e)?(A.pluginStore.openPlugin(e,A,{mode:"canvas"}),!0):!1}function YB(A,j){let e=A.componentForIdentifier(j);if(e)return e;let t=jA(j);return!KA(t)||!aj(t)?null:A.componentForIdentifier(vd(t))}function OG(A,j,e){let t=KA(e)?e.localId:e?.moduleId,r=A.get(t);if(Le(r))return r.pluginId;if(!St(r))return;if(!oA(r.save.pluginId))return r.save.pluginId;let o=j.getPersistedModuleByLocalId(r.id);if(!o)return;let n=o.metadata.pluginId;if(M(n))return n}function ZB(A,j){let e=OG(A.tree,A.stores.modulesStore,j);if(!oA(e))return A.pluginStore.manifestById.get(e)}function hz(A){return`Edit in ${A.name}`}var wG=0;async function Rs(A,j,e=wG){if(e===0){let r=jA(j),o=ZB(A,r);if(o&&await XB(A,j,o))return}let t=YB(V,j);t&&A.codeEditorStore.editFile(t.file)}async function A0(A,{identifier:j,info:e,instance:t,enterIsolation:r,codeComponentIsolationMode:o}){let n=e.module.baseURL+e.module.files.source,i=await(await fetch(n)).text(),[s,c]=await Promise.all([T$(i),A.stores.modulesStore.getModuleDependencies(j)]);if(s.ok){let g=new Map;for(let I of s.value.relative){let S=ce(I.specifier,`${e.module.type}/`);if(!S){zn.warn("Failed to normalize relative import",I.specifier);continue}let T=g.get(S)??[];T.push(I),g.set(S,T)}let G;for(let I of c.imports){if(I.type!=="local")continue;let S=`${I.moduleType}/${I.moduleName}`,T=g.get(S);if(!T){zn.warn("Unable to get source location of import",S,"when unlinking");continue}for(let v of T){G||(G=i.split(`
`));let P=v.specifierLine;G[P]=G[P].replace(JSON.stringify(v.specifier),JSON.stringify(I.importURL))}}G&&(i=G.join(`
`))}let d=A.stores.modulesStore.forType("codeFile"),p=d.getUniqueName(e.module.name),k=await d.create({name:p,source:i,metadata:{pluginId:e.module.metadata.pluginId}}),$=Tr(j,k).value;return t&&A.processWhenReady(()=>{let g=A.tree.get(t.originalid??t.id);g&&g.set({codeComponentIdentifier:$})}),r&&(A.stores.chromeStore.contentPanelTab="Assets",Rs(A,$,o)),$}var j0={canvasComponent:X$,codeFile:A0};function LG(A){return M(A)?A in j0:!1}async function Uc(A,{identifier:j,moduleType:e,instance:t,enterIsolation:r=!0,codeComponentIsolationMode:o,renamedIds:n=new Map,isAutoDetach:a=!1}){if(!LG(e))throw Error(`Cannot import external module of type ${e}`);let[i]=await A.stores.modulesStore.preloadExternalModules([j]);E(i,"external module must exist on preload");let s={identifier:j,info:i,instance:t,enterIsolation:r,codeComponentIsolationMode:o,renamedIds:n,isAutoDetach:a},c=j0[e],d=await c(A,s);if(!oA(d))return!M(d)&&rA(d)?{...i,codeComponentIdentifier:d.instanceIdentifier,node:d}:{...i,codeComponentIdentifier:d,node:void 0}}var Qc=new Set;async function qG(A,j){let{instance:e,withUnlinkModal:t,...r}=j,o=Sa(A,j.identifier),n=A.stores.insertSidebarStore.getEditBehavior(j.identifier.moduleId);if(t&&n!=="autoUnlink"&&(!o||Jj.isOn("openPrimaryForBuiltInModules"))){A.stores.modalStore.set({type:"UnlinkComponent",source:"edit_action",...r,nodeId:e?.id});return}if(!Qc.has(j.identifier)){Qc.add(j.identifier),A.process(()=>{A.beginUndoGroup()});try{return(await Uc(A,{instance:e,enterIsolation:n!=="autoDetach",...r}))?.codeComponentIdentifier}catch(a){zn.reportError(a),TA({type:"add",variant:"error",text:"Failed to unlink component",key:"external-component-unlink-error",icon:"error"})}finally{A.processWhenReady(()=>{A.endUndoGroup()}),Qc.delete(j.identifier)}}}async function tX(A,j){let{instance:e,moduleType:t,enterIsolation:r,codeComponentIsolationMode:o}=j;if(!z(e))return;let n=await qG(A,{...j,enterIsolation:!1});if(!n)return;await ds(V,[n],A.stores.modulesStore);let a=V.componentForIdentifier(n);if(!a)return;let i=qf(a);i&&A.processWhenReady(()=>{if(A.tree.getNodes(Array.from(A.stores.treeStore.treeIndex.codeComponentNodeIds)).forEach(c=>{if(!i||i.id===c.id||!z(c)||c.codeComponentIdentifier!==e.codeComponentIdentifier||hA(c)||!ns(c,{allowLockedNodes:!0}))return;let d=A.cloneNode(i,!1,!1);Lf(A,c,d).catch(yA)}),!!r)if(t==="canvasComponent"){let c=Yi(n);c&&A.stores.scopeStore.select(c,{keepHistory:!1})}else t==="codeFile"&&Rs(A,n,o)})}var KG=mA("clipboard:modules");async function EX(A,j,e){if(!j||!Dk(j))return!1;let t="insert-external-component";try{await JG({engine:A,moduleURL:j,position:e,centerInParent:!0,toastKey:t}),TA({type:"remove",key:t})}catch(r){console.error("Failed to insert external component",r),TA({type:"add",variant:"error",key:t,text:"Failed to insert external component",icon:"error"})}return!0}async function VG(A,j){let e=new URL(j),t=e.hash.substring(1).split(","),r=t[0]||"default",o=t.some((d,p)=>p>0&&d==="unlink"),{module:n}=await A.stores.modulesStore.lookUpModule({url:e.href}),a=n.id,i=A.stores.modulesStore.getPersistedModuleByGlobalId(a);E(n.files.module,"Module file must be defined");let s=Yj(a,n.saveId,n.files.module,r),c=i?li(i.localId,r):s;return{module:n,moduleIdentifier:c,externalIdentifier:s,insertUnlinked:o}}async function JG({engine:A,moduleURL:j,position:e,centerInParent:t,insertAsGroundNode:r,toastKey:o,update:n}){let{module:a,moduleIdentifier:i,externalIdentifier:s,insertUnlinked:c}=await VG(A,j);if(a.type==="screen")if(KA(i)){let d=Yi(i.value);if(!d)return;let p=A.tree.getNode(d);if(!J(p))return;await A.loadScopesThenProcess([p],([k])=>{k&&Z$(A,k,k.getPrimaryVariant())})}else o&&TA({type:"add",variant:"progress",key:o,text:"Inserting Web Page",icon:"reconnecting",duration:1/0,showCloseButton:"never"}),await Y$(A,s);else if(c){o&&TA({type:"add",variant:"progress",key:o,text:"Inserting external component",icon:"reconnecting",duration:1/0,showCloseButton:"never"});let d=await Uc(A,{identifier:s,moduleType:a.type,enterIsolation:!1});await A.processWhenReadyAsync(()=>{d&&hs({engine:A,module:a,identifier:d.codeComponentIdentifier,position:e,centerInParent:t,insertAsGroundNode:r,update:n})})}else{if(o&&TA({type:"add",variant:"progress",key:o,text:"Inserting external component",icon:"reconnecting",duration:1/0,showCloseButton:"never"}),!ne(i)){await A.processWhenReadyAsync(()=>{hs({engine:A,module:a,identifier:i.value,position:e,centerInParent:t,insertAsGroundNode:r,update:n})});return}await A.stores.modulesStore.addExternalModulesToProject([i],{onTreeUpdate:()=>{if(hs({engine:A,module:a,identifier:i.value,position:e,centerInParent:t,insertAsGroundNode:r,update:n}),a.type!=="vector")return;let d=A.tree.getNodeWithTrait(a.id,Le)?.annotation("framerVector");ra(d)&&A.stores.modulesStore.addOrUpdateVectorSetAndVectors({moduleId:d.set.moduleId,saveId:""}).catch(yA)}}).catch(KG.reportError),A.stores.modulesStore.trackExternalComponentInsert([i.value],"paste-url")}return a}function e0(A,j){if(A.stores.projectStore.projectLicenseType===lm())return A.stores.modalStore.set({type:"UpsellEnterprise",source:"upsell",description:"Sign up for an Enterprise plan to increase your file upload limit to 150MB and unlock other powerful features that help scale your site.",upsell:"file-limit-enterprise-upsell",upsellFeatures:["Advanced Permissions","Custom Limits","Custom Hosting","Custom Proxy Support","Enterprise Security","Dedicated Support"]});let e=A.stores.projectStore.resourceLimits?.fileUploadLimitInMB;E(typeof e=="number","fileUploadLimitInMB is not a number");let t=e.toLocaleString()+"MB",r=(j/Gm).toLocaleString(void 0,{minimumFractionDigits:0,maximumFractionDigits:1})+"MB";return A.stores.modalStore.set({source:"upsell",type:"UpsellFeature",upsellFeature:"fileUploadLimitInMB",title:"File Upload Limit",description:`Your current plan limits file uploads to ${t}, and you\u2019re trying to upload a file that\u2019s ${r}. Upgrade your site to increase the limit and upload your file.`})}var t0=class{constructor(j,{concurrency:e=5,silent:t=!1}={}){this.engine=j;R(this,"uploads",new Map);R(this,"completed",0);R(this,"failed",0);R(this,"generating",!1);R(this,"resolveStatusUpdate");R(this,"limiter");R(this,"silent");this.limiter=new Ro(e),this.silent=t}add(j){return this.createTask(j,e=>e)()}createTask(j,e){let t=this.uploads.get(j);t||(t={task:async()=>{try{return typeof j=="string"?j.startsWith("data:")?await this.uploadFile(await hm(j,"imported")):await kn.uploadAssetByURL(j,{silent:this.silent,refreshAssetService:!1}):await this.uploadFile(j)}catch(n){throw this.failed++,n}finally{this.completed++,this.resolveStatusUpdate?.()}}},this.uploads.set(j,t));let r=t;return async()=>(r.resultPromise||(r.resultPromise=this.limiter.run(r.task),this.resolveStatusUpdate?.()),e(await r.resultPromise))}async uploadFile(j){let e=this.engine.stores.projectStore.resourceLimits?.fileUploadLimitInMB??void 0,t={silent:this.silent,maxFileSize:e,onExceedsCustomMaxSize:o=>e0(this.engine,o),refreshAssetService:!1},r;if(j.type.startsWith("image/")?r=await kn.uploadImage(j,t):j.type.startsWith("video/")?r=await kn.uploadVideo(j,t):r=await kn.uploadFile(j,t),!r)throw Error("Failed to upload file");return r}get active(){return[...this.uploads.values()].map(({resultPromise:j})=>j).filter(Zj)}get status(){let{active:j,completed:e,failed:t}=this;return{started:j.length,completed:e,failed:t}}async*statusUpdates(){if(this.generating)throw Error("`statusUpdates` is in use by another call");for(this.generating=!0,yield this.status;this.completed<this.active.length;)await new Promise(j=>{this.resolveStatusUpdate=()=>{j(),this.resolveStatusUpdate=void 0}}),yield this.status;await this.engine.stores.assetStore.assetService?.refresh().catch(yA),this.generating=!1}async results(){let j=await Promise.allSettled(this.active).then(e=>e.filter(Yd).map(t=>t.value));return await this.engine.stores.assetStore.assetService?.refresh().catch(yA),j}};var DX=({naturalWidth:A,naturalHeight:j})=>({nonZeroNaturalWidth:A===0?300:A,nonZeroNaturalHeight:j===0?150:j});var UG={cm:96/2.54,mm:96/2.54/10,Q:96/2.54/40,in:96,pc:96/6,pt:96/72,px:1,em:16,ex:8,ch:8,rem:16};function Is(A){if(!A)return null;let j=/(-?[\d.]+)([a-z%]*)/u.exec(A);if(!j)return null;let[e,t,r]=j;if(t===void 0||r?.startsWith("%"))return null;let o=Math.round(parseFloat(t)*(r&&UG[r]||1));return o<=0?0:o}function wX(A){let j=WG(A);if(!j)throw Error("Invalid SVG");let e=Is(j.getAttribute("width")),t=Is(j.getAttribute("height"));if(e!==null&&t!==null)return{width:e,height:t};let r=j.getAttribute("viewBox");if(r){let o=r.split(" "),n=Is(o[2]),a=Is(o[3]);if(n!==null&&a!==null){let i=a!==0?n/a:2;return e!==null&&t===null?{width:e,height:e/i}:t!==null&&e===null?{width:t*i,height:t}:{width:n,height:a}}}return{width:e??300,height:t??150}}function WG(A){let j=Ut(A,"image/svg+xml"),e=j.rootElement||j.childNodes[0];if(!(!e||e.nodeName.toUpperCase()!=="SVG"))return e}var zG=mA("wantsNativeTextActions");function r0(A=document.activeElement){if(!(A instanceof HTMLElement))return!1;if(A.classList.contains("wantsNativeTextAction")||A instanceof HTMLIFrameElement)return!0;if(A instanceof HTMLInputElement)switch(A.type){case"date":case"datetime-local":case"email":case"month":case"number":case"password":case"search":case"tel":case"text":case"time":case"url":case"week":return!0;case"checkbox":case"color":case"file":case"image":case"radio":case"range":case"reset":case"submit":return!1;default:return zG.reportErrorOncePerMinute("Unhandled input type: "+A.type),!1}return A instanceof HTMLTextAreaElement||zA.isOn("rightClickOnLinks")&&(A instanceof HTMLAnchorElement||A.closest("a"))?!0:A.isContentEditable}var _t=Fj(ui());var d0=Fj(Mr());function Wc(A){return A.wantsActions?A.wantsActions():!0}function zc(A,j,e){return A.wantsAction?A.wantsAction(j,e):!0}function n0(A,j){return A.optionsForAction?A.optionsForAction(j):void 0}var i0;(t=>{function A(r){return new e(r)}t.chain=A;function j(r,o){return r&&r instanceof e?r.actionToTargetMap[o]:r}t.functionTarget=j;class e{constructor(o){R(this,"actionToTargetMap",{});R(this,"wantedActions",[]);this.then(o)}then(o){this.wantedActions=this.wantedActions.concat(o.wantedActions);let n=this.actionToTargetMap,a=o.wantedActions;for(let i of a)n[i]=n[i]||o;return this}wantsAction(o,n){let a=this.actionToTargetMap[o];return!a||!Wc(a)?!1:zc(a,o,n)}optionsForAction(o){let n=this.actionToTargetMap[o];if(n)return n0(n,o)}}})(i0||={});var br=class extends Event{constructor(){super(...arguments);R(this,"actionIdentifier");R(this,"actionArgument")}};R(br,"eventType","vekter-action-dispatch-event");var Cr=class extends Event{constructor(){super(...arguments);R(this,"invalidatedActions");R(this,"validatedActionStates");R(this,"validatedActionOptions")}};R(Cr,"eventType","vekter-action-validation-event");function UX({target:A,engine:j,children:e,style:t,global:r}){let o=(0,_t.useRef)(null),n=(0,_t.useCallback)(s=>{let c=s.actionIdentifier;if(!c)return;let d=i0.functionTarget(A,c);if(!d||!d.wantedActions.includes(c)||!Wc(d))return;let p=d[c];if(!Xd(p))return;let k=zc(d,c,s);if(!k||(s.preventDefault(),s.stopPropagation(),k!==!0))return;j.setEditReason(c);let $=p.bind(d);j.wrapHandler($)(s.actionArgument)},[j,A]),a=(0,_t.useCallback)(s=>{let{invalidatedActions:c,validatedActionStates:d,validatedActionOptions:p}=s;if(!(!c||!d||!p)&&A){for(let k of A.wantedActions)if(c.has(k)){c.delete(k);let $=Wc(A)?zc(A,k,s):!1;if(d[k]=$,$===!0||$===!1){let g=n0(A,k);g&&(p[k]=g)}}c.size===0&&(s.preventDefault(),s.stopPropagation())}},[A]);(0,_t.useEffect)(()=>{if(!o.current)return;let s=(r?document.documentElement:null)||o.current;return s.addEventListener(br.eventType,n),s.addEventListener(Cr.eventType,a),()=>{s.removeEventListener(br.eventType,n),s.removeEventListener(Cr.eventType,a)}},[r,n,a]);let i=(0,_t.useCallback)(s=>{!r0(s.target)&&!Ej.isDebugBuild&&s.preventDefault()},[]);return(0,d0.jsx)("div",{ref:o,onContextMenu:i,style:t,children:e})}function a0(A,j){let e=document.activeElement;if(!e)throw Error("No active element for action dispatch");let t=new br(br.eventType,{bubbles:!0});return t.actionIdentifier=A,t.actionArgument=j,e.dispatchEvent(t)}function XG(A){let j=document.activeElement;if(!j)throw Error("No active element for action validation");let e=new Set;for(let n of A)e.add(n);let t={},r={},o=new Cr(Cr.eventType,{bubbles:!0});return o.invalidatedActions=e,o.validatedActionStates=t,o.validatedActionOptions=r,j.dispatchEvent(o),{states:t,options:r}}var s0=[],l0=[];function WX(A){s0.push(A)}function zX(A){l0.push(A)}function c0(A){let j=A==="*"?Object.keys(Fs):[A];s0.forEach(r=>r());let{states:e,options:t}=XG(j);Object.assign(Fs,e),Object.assign(o0,t);for(let r of j)Fs[r]=e[r]||(r==="undo"||r==="redo"||r==="delete"?"native":!1);return l0.forEach(r=>r()),{states:Fs,options:o0}}var Fs={},o0={};function p0(A,j){let e=A.itemVariables.length===1&&A.itemVariables[0]?.type==="image"?A.itemVariables[0]:void 0,t=B`item`,r={[$r]:B`typeof ${t}?.[${$r}] === "string" ? ${t}[${$r}] : undefined`};for(let n of A.itemVariables){let a=Wi(n.name);a?r[n.id]=B`${t}?.[${a}] ?? ${t}?.[${n.id}]`:r[n.id]=B`${t}?.[${n.id}]`}let o=j.bindings.create("arrayFromHumanReadable"+A.id);return j.declarations.file.create(B.joinLines(B`const ${o} = (value) => {${B.joinLines(B`if (!Array.isArray(value)) return`,B`return value.map(${t} => {${B.joinLines(e?B`if (typeof ${t} === "string") return { [${e.id}]: ${t} }`:void 0,B`return ${r}`)}})`)}}`)),o}function YG(A){return[A[1],A[0]]}var ZG=new Map(Object.entries(_A).map(YG));function k0(A,j){let e=j.addImport("framer",{exportSpecifier:"ControlType"}),t=ZG.get(A),r=new q(t);return B`${e}.${r}`}var AS={boolean:"boolean",number:"number",string:"string",richtext:"string",fusednumber:"any",enum:"string",segmentedenum:"string",color:"string",image:"string",responsiveimage:"{src: string; srcSet?: string; alt?: string}",file:"string",componentinstance:"any",slot:"any",array:"any[]",eventhandler:"any",transition:"Record<string, any>",link:"string",linkrelvalues:"string[] | undefined",pagescope:"string",date:"string",object:"Record<string, any>",font:"Record<string, any> | undefined",scrollsectionref:"React.MutableRefObject<HTMLElement>",customcursor:"string",border:"Record<string, any>",cursor:"string",boxshadow:"string",gap:"string",padding:"string",borderradius:"string",collectionreference:"string | undefined",multicollectionreference:"string[] | undefined",trackingid:"string | undefined",vectorsetitem:"React.ComponentType<any> | undefined"};function jS(A){return A?new q(AS[A]):B`any`}var u0="variant";function eS(A){return!oA(A?.defaultValue)}function tS(A,j){if(!rA(A))return{};E(A.isLoaded(),"Node must be loaded to generate controls");let e=A.getTopLevelVariants();if(e?.length<2)return{};let t=[],r=[];for(let o of e){let n=o.name??At(o);t.push(o.id),r.push(n)}return{[u0]:{type:k0("enum",j),title:"Variant",options:t,optionTitles:r}}}function rS(A,j,e,t,r){if(A.type==="responsiveimage"&&Zs(A)&&Ys(A.__vekterDefault)){let{assetReference:o,alt:n}=A.__vekterDefault,a=W6(r?.width,r?.height),i=e.assets.resolveResponsiveImage(o,a,A.__vekterDefault);return i&&M(n)&&(i.alt=n),i}else if(Xs(A))switch(A.type){case"responsiveimage":{let o=W6(r?.width,r?.height),n=e.assets.resolveResponsiveImage(A.__defaultAssetReference,o);return n||void 0}case"file":{let o=e.assets.resolve(A.__defaultAssetReference);return o?o.src:void 0}}else{if(j?.type==="array")return j.initialValue?j.initialValue.map(o=>{let n={};if(!o||o.type!=="object"||!_j(o.value))return n;for(let a in o.value){let i=o.value[a];if(!i||i.type!=="image"||!M(i.value))continue;let s=e.assets.resolveResponsiveImage(i.value,void 0,i);s&&(s.alt=i.alt??"",n[a]=s)}return n}):[];if(eS(A)){let o=A.defaultValue;if(A.type==="vectorsetitem")return E(Pp(o),"Vector set item must be a module export identifier"),e.imports.addModuleImport(o.identifier);if(A.type==="richtext"&&M(o))return Sm(o,{collectors:e,useFramerMotion:t==="SmartComponent"});if(A.type==="boxshadow"&&Jk(o))return Hk(o,"emptyStringWhenEmpty",n=>qe(n)?a6(n):Bi.toFormatString(n));if(Ze(o))return qe(o)?a6(o):o}}}function Gs(A,j){return B`${A}?: ${j};`}var m0=["id","width","height"],oS=Object.fromEntries(m0.map(A=>{let j=new q(A);return[j,j]}));function nS(A,j){let e=new yj(A);return yj.addSpreadAtEnd(e,j),e}var E0=[{name:DA.style,type:B`Record<string, unknown>`},{name:DA.className,type:B`string`},{name:DA.layoutId,type:B`string | number`}];function iS(A,{declarations:j}){if(!rA(A)&&!J(A)&&!oj(A)&&!Ae(A))return[];E(A.isLoaded(),"Node must be loaded to generate default values and types");let e=E0.map(({name:a,type:i})=>({key:OA(a),type:Gs(a,i)})),t=Xt(A)?A.getTopLevelVariants():[],r=OA(DA.variant);if(t.length<2)return e.concat({key:r});E(Xt(A),"A scope with more than 1 variants must have replica variants.");let o=new yj;for(let a of t)o[a.name??At(a)]=a.id;let n=j.file.dedupe("humanReadableVariantMap",o);return e.concat([{key:r,type:Gs(DA.variant,B`keyof typeof ${n}`),value:B`${n}[props.${DA.variant}] ?? props.${DA.variant} ?? ${A.baseVariantId}`}])}function Xc(A,j,e){let t=B`props.${new q(A)}`;return j&&(t=B`${j} ?? ${t}`),e&&(t=B`${t} ?? ${e}`),t}function aS(A,{treeStore:j}){if(!J(A)||!ye(j.tree,A))return;let t=jA(A.dataIdentifier);if(!aj(t))return;let r=A.getVariableDefinitions(j.tree,V,V.activeBundleHash);if(!r||r.length===0)return;let o=new Map;for(let n of r){let a=pa(n.id,A.id,!0);o.set(OA(a),n)}return o}var sS=[...xk,u0,...m0,...E0.map(({name:A})=>A.toString()),"name"];function lS(A,j,e,t,r,o){let n=new Set(sS),a=B`props`,i=Object.entries(A).map(([S,{control:T,variable:v}])=>{if(!T)return{key:S};let P=Ok(Wi(T.title)??S,n),_=new q(P),H=rS(T,v,t,r,o),O=Gs(_,jS(T.type)),Q;if(T.type==="enum"&&T.options&&T.optionTitles&&_){let L=new yj;T.options.forEach((N,X)=>{if(!M(N)||!T.optionTitles)return;let Y=T.optionTitles[X];M(Y)&&(L[Y]=N)});let dA=t.declarations.file.dedupe("humanReadableEnumMap",L);O=Gs(_,B`keyof typeof ${dA}`),Q=Xc(S,_,H),Q=B`${dA}[${_}] ?? ${Q}`}else if(v?.type==="array"){let L=p0(v,t),dA=q.fn(L,_);Q=Xc(S,dA,H)}else Q=Xc(S,_,H);return{key:S,name:P,type:O,value:Q}}),s="",c=[],d=new yj,p=aS(j,e),k={},$={...oS};for(let{key:S,type:T,value:v,name:P}of[...iS(j,t),...i]){let _=p?.get(S),H=new q(S);if(_){let O=B`${H} = ${DA.getFromCurrentRouteData}(${_.id})`;if(L7(_.type)){let Q=gt(_.type);Ze(Q)&&(O=B`${O} ?? ${Q}`)}c.push(O)}else c.push(H);T&&(s+=T),v&&(d[S]=v),P&&(k[S]=P,$[P]=new q(P))}r==="DesignPage"&&c.push(DA.style),yj.addSpreadAtStart(d,a);let g=t.declarations.file.dedupe("getProps",B`(${nS($,a)}) => { return ${d} }`),G=c.join(", "),I=G.length>0?new q(`{ ${G}, ...${DA.restProps} }`):DA.restProps;return{variableMap:me(k)?void 0:k,types:new q(s),props:B`const ${I} = ${q.fn(g,a)}`}}function cS(A,j,e=!1){let t=[],r=f0(A),o=new q.Set(j.variables);for(let n of r){if(n.type==="divider")continue;let a=new q(n.id);!e&&!j.variables.has(a)||(t.push({id:n.id,definition:n}),o.delete(a))}for(let n of o)t.push({id:String(n)});return t}function dS(A,j){let{hidden:e,...t}=A;if(!j)return t;let{description:r,...o}=t;return o}function pS(A,j,{modulesStore:e,treeStore:t},{imports:r,variables:o},n,a){let{id:i,type:s}=A;switch(s){case"controlReference":{let c=jA(_p(t.tree,A.entityIdentifier));if(!c||!A.entityIdentifier||!aj(c))return;let d=r.addModuleImport(c,{composeWithImports:[r.addImport("framer",{exportSpecifier:"getPropertyControls"})]});if(!d)return;let p=new yj({hidden:B`undefined`,description:B`undefined`});return yj.addSpreadAtStart(p,B`${d}[${A.controlKey}]`),M(j.title)&&(p.title=j.title),M(j.description)&&(p.description=j.description),j.type==="responsiveimage"&&Zs(j)&&Ys(j.__vekterDefault)&&(p[A7]=q.fromValue(j.__vekterDefault)),Xs(j)?p[Zd]=q.fromValue(j.__defaultAssetReference):oA(A.initialValue)||(p.defaultValue=q.fromValue(A.initialValue)),B`${d}?.[${A.controlKey}] && ${p}`}case"nodePropertyControlReference":case"array":case"vectorsetitem":case"boolean":case"color":case"date":case"enum":case"eventhandler":case"file":case"image":case"link":case"linkrelvalues":case"number":case"richtext":case"scrollsectionref":case"customcursor":case"cursor":case"transition":case"boxshadow":case"string":case"border":case"borderradius":case"gap":case"padding":case"collectionreference":case"multicollectionreference":case"trackingid":case"slug":{let c={...dS(j,n),type:k0(j.type,r)};if(a==="vector"&&o){let d=new q(i);c.hidden=!o.variables.has(d)}return c}default:cA(s)}}function f0(A){return Ue(A)?A.variables:[]}function kS(A,j,e,t,r=f0(A)){let o=tS(A,e.imports),n=xi(A),a=[...r];if(ej(A)){let i=Wp(A);a.push(i);let s=zp(A);a.push(s)}for(let i of a){if(i.type==="divider")continue;let s=g6(j.treeStore.tree,i);if(Sj(s))continue;E(s.type!=="image","Image variables should become responsive images");let c=pS(i,s,j,e,n,t);oA(c)||(o[i.id]=c)}if(!me(o))return new yj(o,1)}function _Y(A,j,e,t,r,o){let n={},a=[];for(let{id:i,definition:s}of uS(A,e.variables)){let c=s?g6(j.treeStore.tree,s):void 0;n[i]={control:c,variable:s},s&&a.push(s)}return{propertyControls:kS(A,j,e,r,a),...lS(n,A,j,e,t,o)}}function uS(A,j){return cS(A,j,Ae(A))}var Yn=Fj(t6());function $0(){return document.body.dataset.framerTheme==="dark"}var B0=Uj()?["Control","Option","Shift","CommandOrControl","Command"]:["CommandOrControl","Command","Control","Alt","Shift"];function Yc(A){return A?A.split("+").sort((j,e)=>{let t=B0.indexOf(j),r=B0.indexOf(e);return t!==-1&&r!==-1?t-r:t!==-1?-1:r!==-1?1:0}).map(j=>{switch(j){case"Backspace":case"Delete":return Uj()?"\u232B":"Del";case"Command":return"\u2318";case"CommandOrControl":return Uj()?"\u2318":"Ctrl";case"Control":return Uj()?"\u2303":"Ctrl";case"Down":return"\u2193";case"Enter":case"Return":return Uj()?"\u21A9":"Enter";case"Left":return"\u2190";case"-":return"\u2013";case"Option":return Uj()?"\u2325":"Alt";case"Plus":return Uj()?"+":"=";case"Right":return"\u2192";case"Shift":return Uj()?"\u21E7":"Shift";case"Up":return"\u2191";case"Escape":return"ESC"}return j}):[]}function Zc(A,j){let e=[];return A.forEach(t=>{let{accelerator:r,acceleratorWindows:o,checked:n,mixed:a,enabled:i,ellipsis:s,role:c,type:d="normal",visible:p,requiresUserInteraction:k,acceleratorLabel:$,acceleratorLabelWindows:g,badge:G,icon:I}=t;if(d==="separator")e.push({type:"separator",visible:p});else if(d==="normal"){let S;i!==void 0&&(S=!i);let T=!Uj()&&o!==void 0?o:r,v=!Uj()&&g!==void 0?g:$,P=v?Yc(v):T?Yc(T):void 0,_=t.label;_&&s&&(_+="\u2026");let H={accelerator:T,acceleratorLabelTokens:P,tokenDelimiter:Uj()?void 0:"+",checked:n||a,disabled:S,label:_||"",description:t.description,action:c,type:d,visible:p,requiresUserInteraction:k,badge:G,icon:I};H.submenu=t.submenu&&Zc(t.submenu,j),j&&j(H),H.visible===void 0&&(H.visible=!0),e.push(H)}else throw Error(`Unhandled type: ${d}`)}),e}var Ss={importFigma:"CommandOrControl+Shift+I",newProject:"Option+CommandOrControl+N",publishSite:"CommandOrControl+Shift+P",openPublishedSite:"CommandOrControl+Shift+O",uploadImage:"Option+CommandOrControl+I",quickActions:"CommandOrControl+K",toggleLocalization:"CommandOrControl+Shift+L",toggleContentManagement:"Option+C",toggleVersionHistory:"Shift+CommandOrControl+H",generateWebPage:"W",undo:"CommandOrControl+Z",redo:"CommandOrControl+Shift+Z",goBack:"CommandOrControl+[",goForward:"CommandOrControl+]",cut:"CommandOrControl+X",copy:"CommandOrControl+C",copyFill:"CommandOrControl+Shift+C",paste:"CommandOrControl+V",delete:"Delete",selectMostRecentPage:"Option+Escape",selectAll:"CommandOrControl+A",selectGroundNode:"CommandOrControl+Escape",selectParent:"Escape",copyStyle:"CommandOrControl+Option+C",pasteStyle:"CommandOrControl+Option+V",pasteInPlace:"CommandOrControl+Shift+V",duplicate:"CommandOrControl+D",toggleLayerLock:"CommandOrControl+L",toggleLayerVisible:"CommandOrControl+;",rename:"CommandOrControl+R",selectSiblings:"CommandOrControl+Shift+A",cycleSelection:"Tab",decycleSelection:"Shift+Tab",fakeSelectChildren:"Enter",zoomIn:"CommandOrControl+Plus",zoomOut:"CommandOrControl+-",resetZoom:"CommandOrControl+0",zoomToFitAll:"CommandOrControl+1",zoomToFitSelection:"CommandOrControl+2",openPanelSearch:"CommandOrControl+F",toggleInterface:"CommandOrControl+.",toggleRulers:"Control+R",toggleGrids:"Control+G",toggleAppearance:"Control+Command+N",showPages:"Option+1",showLayers:"Option+2",showAssets:"Option+3",collapseLayers:"Option+L",startLinkTool:"L",sampleColor:"Control+C",toggleInsert:"I",toggleLibraryModal:"CommandOrControl+/",toolCreateStack:"S",toolCreateFrame:"F",toolCreateRounded:"U",toolCreateImage:"Shift+I",toolCreateVideo:"Shift+V",toolCreateText:"T",toolComment:"C",toolChat:"/",toolZoom:"Z",toolPath:"P",toolScale:"K",toolCreateRectangleShape:"R",toolCreateOvalShape:"O",toolCreateRows:"Shift+R",toolCreateColumns:"Shift+C",toolCreateGrid:"Shift+G",addEnclosingFrame:"CommandOrControl+Return",addEnclosingStack:"CommandOrControl+Option+Return",autoSizeLayout:"Shift+A",removeFramePreservingChildren:"CommandOrControl+Delete",sizeToFitContent:"Control+Option+R",moveForward:"CommandOrControl+Option+Up",moveBackward:"CommandOrControl+Option+Down",moveToFront:"]",moveToBack:"[",alignLeft:"Option+A",alignCenter:"Option+H",alignRight:"Option+D",alignTop:"Option+W",alignMiddle:"Option+V",alignBottom:"Option+S",distributeHorizontal:"Control+Option+H",distributeVertical:"Control+Option+V",unite:"Option+Shift+U",subtract:"Option+Shift+S",intersect:"Option+Shift+I",exclude:"Option+Shift+E",join:"Option+Shift+J",saveCodeFile:"CommandOrControl+S",makeBold:"CommandOrControl+B",makeItalic:"CommandOrControl+I",makeUnderlined:"CommandOrControl+U",chooseFontFamily:"CommandOrControl+T",group:"CommandOrControl+G",ungroup:"CommandOrControl+Shift+G",makeComponent:"CommandOrControl+Option+K",makeCodeComponent:"CommandOrControl+Shift+K",showPreview:"CommandOrControl+P",openFullScreen:"CommandOrControl+Shift+F",toggleHighlightsInLivePreview:"CommandOrControl+Shift+H",reload:"CommandOrControl+R",toggleConsole:"CommandOrControl+I",handleResponsive:"Z",togglePreviewInterface:"CommandOrControl+Shift+F",previewNextBreakpoint:"CommandOrControl+.",previewPreviousBreakpoint:"CommandOrControl+,",runRecentPlugin:"CommandOrControl+Option+P",openDevelopmentPlugin:"CommandOrControl+Option+L",openSiteSettings:"Shift+,",previousCollectionItem:"CommandOrControl+Up",nextCollectionItem:"CommandOrControl+Down",newCollectionItem:"N",pasteCollection:"CommandOrControl+V"},Ad={sampleColor:"",selectGroundNode:"",openFullScreen:"Control+Alt+F",resetZoom:"Shift+0",zoomToFitAll:"Shift+1",zoomToFitSelection:"Shift+2",toggleInterface:"Alt+.",toggleRulers:"Control+Shift+R",toggleGrids:"Alt+G",toggleAppearance:"Alt+N",distributeHorizontal:"Alt+Shift+H",distributeVertical:"Alt+Shift+V"},VY=A=>na?Ss[A]:Ad[A]??Ss[A];var mS=(0,Yn.List)();async function ES(A){return{indexPath:(await new Promise(e=>{let{location:t={x:0,y:0},within:r,className:o}=A,n=Zc(A.items,a=>{if("action"in a&&a.action){let{states:i,options:s}=c0(a.action),c=i[a.action],{label:d,checked:p,visible:k}=s[a.action]??{};if(M(d)&&(a.label=d),a.checked===void 0&&st(p)&&(a.checked=p),a.visible===void 0&&st(k)&&(a.visible=k),a.submenu)return;a.disabled===void 0&&st(c)&&(a.disabled=!c)}});ym.show(n,{location:t,within:r,className:o,isDarkMode:$0(),maxItemsPerMenu:24,expandRight:A.expandRight,onSelection:a=>{let i=fS(n,a.path);i?.type==="normal"&&i.requiresUserInteraction&&e(a)},enableTranslate:!0}).then(e)}))?.path??[]}}function fS(A,j){let e;for(let t of j){if(!A||(e=A[t],!e))return;A=e.type==="normal"&&e.submenu||[]}return e}var Xn=class Xn extends j7("Menu"){constructor(){super();R(this,"_items");R(this,"handlePopupResponse",Lu((e,t)=>{if(!e||e.length===0){t&&t();return}let r=this._items,o,n;for(let a of e){if(o=r.get(a),!o)throw Error("Could not find expected menu item");o.editReason!==void 0&&(n=o.editReason),r=o.submenu?._items??mS}n?jl()?.setEditReason(n):n!==!1&&jl()?.setEditReason(o?.role??Cp(o?.label)),o!==void 0&&o.click!==void 0?o.click():o?.role!==void 0&&a0(o.role,{fromContextMenu:!0})}));this._items=(0,Yn.List)()}static buildFromTemplate(e){let t=new Xn;for(let r of e)t.append(new ed(Xn.getItemTemplateWithShortcut(r)));return t}get items(){return this._items.toArray()}append(e){this._items=this._items.push(e)}insert(e,t){this._items=this._items.insert(e,t)}popup(e,t){return new Promise(r=>{let o=JSON.parse(JSON.stringify(this._items.toJS()));ES({items:o,location:e,within:t?.within,className:t?.className,expandRight:t?.expandRight}).then(n=>this.handlePopupResponse(n.indexPath,t?.onCancel)).catch(yA).finally(r)})}};R(Xn,"getItemTemplateWithShortcut",e=>{let{role:t}=e;if(!t)return e;let r={...e};return!na&&!e.acceleratorWindows&&(r.acceleratorWindows=Ad[t]),e.accelerator||(r.accelerator=Ss[t]),r});var jd=Xn,$S={enabled:void 0,visible:void 0,label:void 0,description:void 0,click:void 0,type:"normal",accelerator:void 0,acceleratorWindows:void 0,acceleratorLabel:void 0,acceleratorLabelWindows:void 0,submenu:void 0,checked:void 0,mixed:void 0,role:void 0,requiresUserInteraction:void 0,alternate:void 0,badge:void 0,icon:void 0,editReason:void 0},ed=class extends(0,Yn.Record)($S){constructor(e){e.label&&e.ellipsis&&(e.label=`${e.label}\u2026`),e.submenu!==void 0&&!("__class"in e.submenu&&e.submenu.__class==="Menu")&&(e.submenu=jd.buildFromTemplate(e.submenu));super(e);R(this,"enabled");R(this,"visible");R(this,"label");R(this,"ellipsis");R(this,"checked");R(this,"mixed");R(this,"click");R(this,"role");R(this,"requiresUserInteraction");R(this,"alternate");R(this,"editReason");R(this,"submenu")}toJS(){let e=super.toJS();return e.submenu!==void 0&&(e.submenu=e.submenu._items.toJS()),e}};function tZ(A){return{...A,enabled:A.enabled(),click:()=>{A.enabled()&&A.click()}}}function rZ(A){return Array.isArray(A)}var BS=512,Dt,td,rd,Zn=class{constructor(j){this.assetMap=j;xA(this,Dt);R(this,"keys",new Set)}addAsset(j){this.keys.add(j)}resolve(j){if(!vo(this,Dt,td).call(this,j))return;let e=vo(this,Dt,rd).call(this,j);if(e!==null)return e&&(j=e.identifier),{src:Kd(j)}}resolveResponsiveImage(j,e,t){if(!vo(this,Dt,td).call(this,j))return;let r=vo(this,Dt,rd).call(this,j);if(r===null)return;let o;r&&(j=r.identifier,o=r.preferredSize);let n=this.assetMap.assetForKey(j),a=n?.properties?.image,i=Jd(a?.width,a?.height),c={src:n?Hd(n,o,e,i).url:qd(j),positionX:void 0,positionY:void 0,srcSet:this.generateSrcSet(n,i,o),pixelWidth:n?.properties?.image?.width,pixelHeight:n?.properties?.image?.height};return t&&M(t.positionX)&&M(t.positionY)&&(c.positionX=t.positionX,c.positionY=t.positionY),c}generateSrcSet(j,e,t){if(!j)return;let r;if((!t||t==="auto"||t==="lossless")&&e?.length&&j.properties?.image){r="";for(let{maxSideSize:n,width:a}of e)a<BS||(r+=`${Hs(j,n,t)} ${a}w,`);r+=`${Hs(j,void 0,t)} ${j.properties.image.width}w`}return r}};Dt=new WeakSet,td=function(j){return!(xe(j)||j.startsWith("https:"))},rd=function(j){let e=Vd(j);return e&&(j=e.identifier),j===""?null:(this.addAsset(j),e)};function od(A,j){let e=[],t=i7(A,o=>{let n=j.create(o);return e.push(o),"${"+n+"}"});return{templatedUrl:new q("`"+t+"`"),usedVariables:e}}function ys(A,j,e,t=void 0){if(UA(A.value))return Jt(!m7(A.value),"Computed values should not be possible in fetch fallback"),j.create(A.value);switch(A.type){case"color":return A.value?B`${A.value}`:B`undefined`;case"string":return B`${A.value}`;case"boolean":return new q(A.value);case"number":return new q(A.value);case"image":{if(A.value===void 0)return B`undefined`;let r=e.resolveResponsiveImage(A.value,void 0,void 0);return r?B`${r.src}`:B`undefined`}case"link":{if(!A.value||!t)return B`undefined`;let r=t.create(A.value);return r?new q(OA(r)):B`undefined`}default:mi(A)}}function bs(A,j,e,t=void 0){let{templatedUrl:r}=od(A,j),o=Ii(A);return new yj({url:r,resultKeyPath:A.resultKeyPath,fallbackValue:ys(o.controlProp,j,e,t),errorFallbackValue:o.errorControlProp?ys(o.errorControlProp,j,e,t):void 0,resultOutputType:o.controlProp.type,cacheDuration:A.cacheDuration,credentials:A.credentials})}var Ai=class{constructor(j,e,t,r,o){this.bindings=j;this.variables=e;this.preload=t;this.assets=r;this.links=o;R(this,"fetchesByNode",new Map);R(this,"resultBindingsByNode",new Map)}createFetchBinding(j,e){let t=Ii(e);if(!n7(t))return ys(t.controlProp,this.variables,this.assets,this.links);let r=j.originalid??j.id,o=this.resultBindingsByNode.get(r)??this.bindings.create("fetchResult");this.resultBindingsByNode.set(r,o),this.preload.addFetch(j,t);let n=this.fetchesByNode.get(j.id)??[];return n.push(bs(t,this.variables,this.assets,this.links)),this.fetchesByNode.set(j.id,n),B`${o}[${n.length-1}]`}getResultBinding(j){return this.resultBindingsByNode.get(j.originalid??j.id)}getFetchesForNode(j){return this.fetchesByNode.get(j.id)}};var nd=class{constructor(j,e,t,r){this.moduleType=j;this.modulesStore=e;this.submoduleName=t;this.sourceCode=r;R(this,"submoduleFilename");R(this,"submoduleImport");R(this,"bindings",new ar);R(this,"imports");R(this,"declarations",new dr(this.bindings));this.submoduleFilename=Fa(this.submoduleName),this.submoduleImport=Ga(this.submoduleFilename),this.imports=new sr(this.moduleType,this.modulesStore,this.bindings)}get estimatedSize(){return this.declarations.declarationsByteSize}serialize(){let j=gj.linesFrom(this.imports.statements),e=this.declarations.list();return gj.sections(j,this.sourceCode,...e)}},Cs=class{constructor(j,e,t){this.moduleType=j;this.modulesStore=e;this.componentSourceNodeId=t;R(this,"submodules",new Set)}create(j){let e=Im(this.componentSourceNodeId,this.submodules.size),t=new nd(this.moduleType,this.modulesStore,e,j);return this.submodules.add(t),t}delete(j){this.submodules.delete(j)}serialize(){let j=new Map;for(let e of this.submodules){let t=e.serialize();j.set(e.submoduleName,t)}return j}};function g0(A){return`${A}ToDisplayName`}var h0="enumToDisplayNameFunctions";function R0(A){if(A?.type!=="enum"||!A.optionTitles)return B`(value) => value`;let j=A.optionTitles;return new q(gj.lines(B`(value, _locale) => {`,B`switch (value) {`,...A.options.map((e,t)=>{let r=j[t];return B`case ${e}: return ${oA(r)?B`undefined`:r};`}),B`default: return "";`,B`}`,B`}`))}function I0(A){let{locale:j,grouping:e,notation:t,compactDisplay:r,style:o,currency:n,currencyDisplay:a,unit:i,unitDisplay:s,minimumFractionDigits:c,maximumFractionDigits:d,minimumIntegerDigits:p}=A,k={locale:j,notation:t,style:o};switch(st(e)&&(k.useGrouping=e),Z(c)&&(k.minimumFractionDigits=c),Z(d)&&(k.maximumFractionDigits=d),Z(p)&&(k.minimumIntegerDigits=p),t==="compact"&&(k.compactDisplay=r),o){case"currency":k.currency=n,k.currencyDisplay=a;break;case"unit":k.unit=i,k.unitDisplay=s;break}return new yj(k)}var F0=B`(value, options = {}, activeLocale) => {
    const fallbackLocale = "en-US";
    const locale = options.locale || activeLocale || fallbackLocale;
    const {
        useGrouping,
        notation,
        compactDisplay,
        style,
        currency,
        currencyDisplay,
        unit,
        unitDisplay,
        minimumFractionDigits,
        maximumFractionDigits,
        minimumIntegerDigits,
    } = options;
    const formatOptions = {useGrouping, notation, compactDisplay, style, currency, currencyDisplay, unit, unitDisplay, minimumFractionDigits, maximumFractionDigits, minimumIntegerDigits};
    const number = Number(value);
    try {
        return number.toLocaleString(locale, formatOptions);
    } catch {
        try {
            return number.toLocaleString(fallbackLocale, formatOptions);
        } catch {
            return number.toLocaleString();
        }
    }
};
`;function G0(A,j){if(j.length===0)return null;E(A);let e=new Set;for(let r of j){let o=A.create(r);e.add(OA(o))}let t=`{${Array.from(e).join(", ")}}`;return new q(t)}function S0(A,j,e,t){let r=A.name;switch(r){case"contains":case"endsWith":case"equals":case"startsWith":case"greaterThan":case"lessThan":case"isBefore":case"isAfter":case"isIncludedIn":return pA(A.value)?(E(e),[e.create(A.value)]):[oA(A.value)?B`undefined`:A.value];case"prefix":case"suffix":{if(pA(A.value))return E(e),[e.create(A.value)];let n=oA(A.value)?B`undefined`:A.value;return A.valueLocalized?(E(t,"LocalizedValueCollector is required"),[t.add(n,A.valueLocalized,a=>A.valueLocalized?.[a]?.value)]):[n]}case"toDateString":return[j.getActiveLocaleCode()];case"extractDateSegment":return[A.segment];case"numberToString":return[I0(A),j.getActiveLocaleCode()];case"offsetAndLimitArray":return[A.startOffset,Z(A.limit)?A.limit:B`undefined`];case"isBetweenDates":{let n=[];return pA(A.start)?(E(e),n.push(e.create(A.start))):n.push(oA(A.start)?B`undefined`:A.start),pA(A.end)?(E(e),n.push(e.create(A.end))):n.push(oA(A.end)?B`undefined`:A.end),n}case"convertFromEnum":case"convertFromString":{let a=function(c){Nj(c)&&Ke(c,d=>a(d)),pA(c)&&n.push(c)};var o=a;let n=[];a(A.default);for(let c of A.cases)a(c.to);let i=G0(e,n),s=e?.getLocale()??B`undefined`;return i?[s,i]:[s]}case"convertFromBoolean":{let a=function(d){Nj(d)&&Ke(d,p=>a(p)),pA(d)&&n.push(d)};var o=a;let n=[];a(A.truthy),a(A.falsy);let i=e?.getLocale()??B`undefined`,s=G0(e,n);return s?[i,s]:[i]}case"enumToDisplayName":return j.variables?[j.variables.getLocale()]:[];case"toString":case"toBoolean":case"toNumber":case"isSet":case"negate":case"reverseArray":case"toResponsiveImage":case"toImageSrc":case"jsonStringify":case"htmlEscape":case"htmlUnescape":case"addImageAlt":case"toZIndex":case"toAxisOverflow":case"numberToPixelString":case"radiusForCorner":case"arrayToArray":case"arrayLength":case"isEven":case"isOdd":case"getGridColumnCSSValue":case"getGridRowCSSValue":case"getNumericColumnGap":return[];default:cA(r,"All value transforms should define their arguments")}}var y0=B`(image, alt) => {
    if (!image || typeof image !== "object") {
        return;
    };
    return { ...image, alt };
};
`;var b0=B`(value) => {
    return Array.isArray(value) ? value.length : 0
}
`;function C0(A){let j=B`item`,e={[$r]:B`${j}?.[${$r}]`};for(let t in A.mapping){let r=A.mapping[t];if(E(Zj(r)),c7(r.value)){e[t]=B`${j}?.[${r.value.id}]`;continue}r.value}return B`(value) => {
      if (!Array.isArray(value)) return
      return value.map((${j}) => (${e}))
    }`}var v0=B`(a, b) => {
    if (typeof a === "string" && typeof b === "string") {
        return a.toLowerCase().includes(b.toLowerCase());
    }

    if (Array.isArray(a) && typeof b === "string") {
        return a.includes(b);
    }

    return false;
};
`;function gS(A){let j=gt(A.outputType);return OA(B`return ${Ze(j)?j:B`undefined`};`)}function T0(A,j,e,t,r,o,n){if(e==="link")return!n||!Nj(A)&&!pA(A)?void 0:n.create(A);if(!Nj(A))return pA(A)?r.create(A):Jp(e,A,t)?o&&j&&e==="string"?o.add(A,j,a=>j?.[a]?.value):A:Hp(e,t)}function hS(A,j,e,t,r){if(!Vp(A.outputType))return gS(A);let o=T0(A.truthy,A.truthyLocalized,A.outputType,j,e,t,r),n=T0(A.falsy,A.falsyLocalized,A.outputType,j,e,t,r);return gj.lines(B`if (value) {`,B`return ${o===void 0?B`undefined`:o};`,B`} else {`,B`return ${n===void 0?B`undefined`:n};`,B`}`)}function P0(A,j,e,t,r){E(e),E(t),E(r);let o=new Set;function n(i){if(Nj(i)&&Ke(i,s=>n(s)),pA(i)){E(e);let s=e.create(i);o.add(OA(s))}}n(A.truthy),n(A.falsy);let a=[B`value`,DA.activeLocale];if(o.size>0){let i=`{${Array.from(o).join(", ")}}`;a.push(new q(i))}return new q(gj.lines(B`(${new q(a.map(OA).join(", "))}) => {`,new q(hS(A,j,e,t,r)),B`}`))}function Fo(A,j,e,t,r,o,n){if(e==="link")return!n||!Nj(A)&&!pA(A)?void 0:n.create(A);if(!Nj(A))return pA(A)?r.create(A):qp(e,A,t)?o&&e==="string"&&M(A)&&j?o.add(A,j,a=>j?.[a]?.value):A:Kp(e,t)}function M0(A){let j=gt(A.outputType);return OA(B`return ${Ze(j)?j:B`undefined`};`)}function RS(A,j,e,t,r,o){if(j?.type!=="enum"||!wp(A.outputType))return M0(A);let n=new Set,a=Fo(A.default,A.defaultLocalized,A.outputType,e,t,r,o);return gj.lines(B`switch (value) {`,...A.cases.filter(i=>n.has(i.from)||!j.options.includes(i.from)?!1:(n.add(i.from),!0)).map(i=>{let s=Fo(i.to,i.toLocalized,A.outputType,e,t,r,o);return B`case ${i.from}: return ${s===void 0?B`undefined`:s};`}),B`default: return ${a===void 0?B`undefined`:a};`,B`}`)}function _0(A,j,e,t,r,o){E(t),E(r),E(o);let n=new Set;function a(s){if(Nj(s)&&Ke(s,c=>a(c)),pA(s)){E(t);let c=t.create(s);n.add(OA(c))}}A.cases.forEach(s=>{a(s.to)}),a(A.default);let i=[B`value`,DA.activeLocale];if(n.size>0){let s=`{${Array.from(n).join(", ")}}`;i.push(new q(s))}return new q(gj.lines(B`(${new q(i.map(OA).join(", "))}) => {`,new q(RS(A,j,e,t,r,o)),B`}`))}function IS(A){let j=gt(A.outputType);return OA(B`return ${Ze(j)?j:B`undefined`};`)}function FS(A,j,e,t,r){if(!Lp(A.outputType))return IS(A);let o=new Set,n=Fo(A.default,A.defaultLocalized,A.outputType,j,e,t,r);return gj.lines(B`switch (typeof value === "string" ? value.toLowerCase() : value) {`,...A.cases.filter(a=>{let i=a.from.toLowerCase();return o.has(i)?!1:(o.add(i),!0)}).map(a=>{let i=Fo(a.to,a.toLocalized,A.outputType,j,e,t,r);return B`case ${a.from.toLowerCase()}: return ${i===void 0?B`undefined`:i};`}),B`default: return ${n===void 0?B`undefined`:n};`,B`}`)}function D0(A,j,e,t,r){E(e),E(t),E(r);let o=new Set;function n(i){if(Nj(i)&&Ke(i,s=>n(s)),pA(i)){E(e);let s=e.create(i);o.add(OA(s))}}A.cases.forEach(i=>{n(i.to)}),n(A.default);let a=[B`value`,DA.activeLocale];if(o.size>0){let i=`{${Array.from(o).join(", ")}}`;a.push(new q(i))}return new q(gj.lines(B`(${new q(a.map(OA).join(", "))}) => {`,new q(FS(A,j,e,t,r)),B`}`))}var N0=B`(a, b) => {
    return typeof a === "string" && typeof b === "string" && a.toLowerCase().endsWith(b.toLowerCase());
};
`;var x0=B`(a, b) => {
    return (typeof a === "string" && typeof b === "string") ? a.toLowerCase() === b.toLowerCase() : a === b;
};
`;var O0=B`(value, segment = "year") => {
    if (typeof value !== "string") return;
    const date = new Date(value);
    if (isNaN(date.getTime())) return;
    if (segment === "year") return date.getUTCFullYear();
    if (segment === "month") return date.getUTCMonth() + 1;
    if (segment === "day") return date.getUTCDate();
    if (segment === "hour24") return date.getUTCHours();
    if (segment === "hour12") {
        const hour = date.getUTCHours();
        return hour === 0 ? 12 : hour > 12 ? hour - 12 : hour;
    }
    if (segment === "minute") return date.getUTCMinutes();
};
`;var id=B`spanCount`,vs=B`optionalColumnCount`,w0=B`(columnSpan, ${vs}) => {
    if (columnSpan === "all") return "-1 / 1";
    const ${id} = Number.isFinite(columnSpan) && columnSpan > 0 ? columnSpan : 1;
    if (Number.isFinite(${vs}) && ${id} > ${vs}) {
        return ${nr`span ${vs}`};
    }
    return ${nr`span ${id}`};
};
`;var L0=B`spanCount`,q0=B`(rowSpan) => {
    const ${L0} = Number.isFinite(rowSpan) && rowSpan > 0 ? rowSpan : 1;
    return ${nr`span ${L0}`}
};
`;var K0=B`(gap) => {
    if (Number.isFinite(gap) && gap >= 0) return gap;
    if (typeof gap !== "string") return 0;
    const firstSegment = gap.split(" ")[0];
    const parsedGap = parseFloat(firstSegment);
    return Number.isFinite(parsedGap) && parsedGap >= 0 ? parsedGap : 0;
};
`;var V0=B`(a, b) => {
    return (typeof a === "number" && typeof b === "number") ? a > b : false;
};
`;var J0=B`(value) => {
    if (typeof value !== "string") return "";
    return value.replaceAll("&", "&amp;").replaceAll("<", "&lt;").replaceAll(">", "&gt;").replaceAll('"', "&quot;").replaceAll("'", "&#39;");
};
`;var H0=B`(value) => {
    if (typeof value !== "string") return "";
    const entities = /&(?:[gl]t|quot|#39|amp|#6[02]|#34|apos|#38);/gu;
    const replacers = { "&lt;": "<", "&gt;": ">", "&quot;": '"', "&#39;": "'", "&amp;": "&", "&#60;": "<", "&#62;": ">", "&#34;": '"', "&apos;": "'", "&#38;": "&" };
    return value.replace(entities, match => replacers[match]);
};
`;var Q0=B`(dateString, minDateString) => {
    if (typeof dateString !== "string" || typeof minDateString !== "string") return false;

    const date = new Date(dateString);
    if (isNaN(date.getTime())) return false;

    const minDate = new Date(minDateString);
    if (isNaN(minDate.getTime())) return false;

    return date >= minDate;
};
`;var U0=B`(dateString, maxDateString) => {
    if (typeof dateString !== "string" || typeof maxDateString !== "string") return false;

    const date = new Date(dateString);
    if (isNaN(date.getTime())) return false;

    const maxDate = new Date(maxDateString);
    if (isNaN(maxDate.getTime())) return false;

    return date <= maxDate;
};
`;var W0=B`(value, start, end) => {
    if (typeof value !== "string" || typeof start !== "string" || typeof end !== "string") return false;

    const date = new Date(value);
    if (isNaN(date.getTime())) return false;

    const startDate = new Date(start);
    if (isNaN(startDate.getTime())) return false;

    const endDate = new Date(end);
    if (isNaN(endDate.getTime())) return false;

    return date >= startDate && date <= endDate;
};
`;var z0=B`(value) => {
    return typeof value === "number" && value % 2 === 0;
};
`;var X0=B`(a, b) => {
    return b.includes(a);
};
`;var Y0=B`(value) => {
    return typeof value === "number" && value % 2 === 1;
};
`;var Z0=B`(value) => {
    if (Array.isArray(value)) return value.length > 0;
    return value !== undefined && value !== null && value !== "";
};
`;var Ag=B`(value) => {
    const result = JSON.stringify(value)
    if (typeof result === 'string') return result.replace(/<\\/(script|style)/gi, '<\\\\/$1')
    return result
};
`;var jg=B`(a, b) => {
    return (typeof a === "number" && typeof b === "number") ? a < b : false;
};
`;var eg=B`(value) => {
    return !value;
};
`;var tg=B`(value) => {
    if (typeof value !== "number") return value;
    if (!Number.isFinite(value)) return undefined;
    return Math.max(0, value) + "px";
};
`;var rg=B`(value, offset, limit) => {
    if (!Array.isArray(value)) return []
    const end = typeof limit === "number" ? offset + limit : undefined
    return value.slice(offset, end);
};
`;var og=B`(value, prefix) => {
    if (typeof value === "string" && typeof prefix === "string") {
        return prefix + value;
    } else if (typeof value === "string") {
        return value;
    } else if (typeof prefix === "string") {
        return prefix;
    }
    return "";
};
`;var ng=B`(value, cornerIndex) => {
    if (typeof value === "number" && Number.isFinite(value)) return Math.max(0, value) + "px";
    if (typeof value !== "string" || typeof cornerIndex !== "number") return undefined;
    const segments = value.split(" ");
    return segments[cornerIndex] || segments[cornerIndex - 2] || segments[0];
};
`;var ig=B`(value) => {
    return Array.isArray(value) ? Array.from(value).reverse() : [];
}
`;var ag=B`(a, b) => {
    return typeof a === "string" && typeof b === "string" && a.toLowerCase().startsWith(b.toLowerCase());
};
`;var sg=B`(value, suffix) => {
    if (typeof value === "string" && typeof suffix === "string") {
        return value + suffix;
    } else if (typeof value === "string") {
        return value;
    } else if (typeof suffix === "string") {
        return suffix;
    }
    return "";
};
`;var lg=B`(value, overflow) => {${B.joinLines(B`if (overflow === "visible" || value === "visible") return undefined`,B`return value`)}};`;var cg=B`(value) => {
    return Boolean(value);
};
`;var dg=B`value`,pg=B`activeLocale`;function kg(A,j){let e=j.dedupe("sharedDateFormatter",new q(gj.lines(B`(value, formatOptions, locale) => {`,B`  if (typeof value !== "string") return "";`,B`  const date = new Date(value);`,B`  if (isNaN(date.getTime())) return "";`,B`  const fallbackLocale = "en-US";`,B`  try {`,B`      return date.toLocaleString(locale || fallbackLocale, formatOptions);`,B`  } catch {`,B`      return date.toLocaleString(fallbackLocale, formatOptions);`,B`  }`,B`};`))),t=Up(A.display,A.format,A.dateStyle),r={...Qp[t].options,timeZone:"UTC"},o=j.dedupe("dateOptions",new q(OA(r)));return new q(gj.lines(B`(${dg}, ${pg}) => {`,B`return ${q.fn(e,dg,o,A.locale||pg)};`,B`};`))}var ug=B`(value) => {
    if (typeof value === "object" && value !== null && typeof value.src === "string") {
        return value.src;
    };
    return typeof value === "string" ? value : undefined;
};
`;var mg=B`(value) => {
    if (typeof value === "number" && Number.isFinite(value)) return value;
    if (typeof value !== "string") return 0;
    const parsedNumber = parseFloat(value);
    return (typeof parsedNumber === "number" && Number.isFinite(parsedNumber)) ? parsedNumber : 0;
};
`;var Eg=B`(value) => {
    if (typeof value === "object" && value !== null && typeof value.src === "string") {
        return value;
    };
    return typeof value === "string" ? {src: value} : undefined;
};
`;var fg=B`(value) => {
    return typeof value === "string" ? value : String(value);
};
`;var $g=B`(value) => {${B.joinLines(B`if (value < -1) return -1`,B`if (value > 11) return 11`,B`return value`)}};`;function Bg(A){switch(A){case"isAfter":return Q0;case"isBefore":return U0;case"isBetweenDates":return W0;case"contains":return v0;case"endsWith":return N0;case"equals":return x0;case"isSet":return Z0;case"greaterThan":return V0;case"lessThan":return jg;case"negate":return eg;case"numberToString":return F0;case"startsWith":return ag;case"toString":return fg;case"toNumber":return mg;case"toBoolean":return cg;case"extractDateSegment":return O0;case"reverseArray":return ig;case"offsetAndLimitArray":return rg;case"arrayLength":return b0;case"prefix":return og;case"suffix":return sg;case"toResponsiveImage":return Eg;case"toImageSrc":return ug;case"jsonStringify":return Ag;case"htmlEscape":return J0;case"htmlUnescape":return H0;case"addImageAlt":return y0;case"toZIndex":return $g;case"toAxisOverflow":return lg;case"numberToPixelString":return tg;case"radiusForCorner":return ng;case"isIncludedIn":return X0;case"isEven":return z0;case"isOdd":return Y0;case"getGridColumnCSSValue":return w0;case"getGridRowCSSValue":return q0;case"getNumericColumnGap":return K0;default:cA(A,"All constant transform names should be implemented")}}function gg(A,j,e,t,r,o,n){switch(A.name){case"enumToDisplayName":return R0(j);case"convertFromEnum":return _0(A,j,e,t,r,o);case"convertFromString":return D0(A,e,t,r,o);case"convertFromBoolean":return P0(A,e,t,r,o);case"arrayToArray":return C0(A);case"toDateString":return kg(A,n);default:cA(A,"All dynamic transform names should be implemented")}}var zj=yd(),SS={name:"toString"},yS={name:"toNumber"},bS={name:"toBoolean"},CS={name:"toResponsiveImage"},vS={name:"toImageSrc"},TS={name:"toZIndex"},PS={name:"numberToPixelString"},MS={name:"radiusForCorner"},_S={name:"toAxisOverflow"},DS={name:"jsonStringify"},NS={name:"htmlEscape"},xS={name:"htmlUnescape"},OS={name:"addImageAlt"},wS={name:"getGridColumnCSSValue"},LS={name:"getGridRowCSSValue"},qS={name:"getNumericColumnGap"};function KS(A){return p7(A.name)}var Nt=class{constructor(j,e,t,r,o,n,a,i,s){this.fileDeclarations=j;this.componentDeclarations=e;this.imports=t;this.variables=r;this.localizedValues=o;this.links=n;this.fetches=a;this.modulesStore=i;this.type=s}wrapInTransformFunction(j,e,t,r,o){if(d7(e.name)){let n=this.fileDeclarations.dedupe(e.name,Bg(e.name));return q.fn(n,j,...t)}if(KS(e)){if(e.name==="enumToDisplayName"&&r&&r.type==="enum"){let a=this.getImportedEnumToDisplayNameIfPossible(j,r);if(a)return a}let n=gg(e,r,o,this.variables,this.localizedValues,this.links,this.fileDeclarations);return q.fn(new q(this.fileDeclarations.dedupe(e.name,n)),j,...t)}cA(e.name,"All value transforms should be handled in wrapInTransformFunction")}getImportedEnumToDisplayNameIfPossible(j,e){let t=this.imports,r=this.modulesStore;if(!t||!r)return;let o=Ip(e);if(!o)return;let{dataIdentifier:n,enumFieldKey:a}=o;if(n===Fp)return this.variables?.getLocaleName()??B`undefined`;let i=V.dataForIdentifier(n);if(!i||!i.annotations)return;let s="framerEnumToDisplayNameUtils",c=i.annotations?.[s];if(!M(c))return;let d=Number.parseInt(c,10);if(!Z(d))return;let p=jA(n);if(!aj(p))return;let{importSpecifier:k}=wk(p,this.type,r);if(!k)return;let $=this.variables?.getLocale()??B`undefined`;switch(d){case 1:{let g=g0(a),G=t.addImport(k,{exportSpecifier:g});return q.optionalFn(G,j,$)}case 2:{let g=h0,G=t.addImport(k,{exportSpecifier:g});return q.optionalFn(B`${G}[${a}]`,j,$)}default:throw new Error(`Enum to display name utils, unsupported version: ${d}`)}}wrapInValueTransform(j,e,t,r){return this.wrapInTransformFunction(j,e,S0(e,this,this.variables,this.localizedValues),t,r)}makeTypeSafe(j,e){switch(e){case"string":case"color":return this.wrapInTransformFunction(j,SS,zj);case"number":return this.wrapInTransformFunction(j,yS,zj);case"boolean":return this.wrapInTransformFunction(j,bS,zj);case"array":case"enum":case"link":case"gap":case"padding":case"borderradius":case"image":return j;default:return j}}getActiveLocaleCode(){if(!this.componentDeclarations||!this.imports)return B`undefined`;let j=this.imports.addImport("framer",{exportSpecifier:"useLocaleCode"});return this.componentDeclarations.dedupe("activeLocaleCode",q.fn(j))}createComputedValue(j,e,t){E(this.variables);let r=A6(j)?e.cache.getVariableControlByReference(j.startValue):void 0,o=A6(j)?this.variables.create(j.startValue):this.fetches.createFetchBinding(e,j.startValue),n;j.transforms.forEach(i=>{k7(i.name)&&(o=this.wrapInValueTransform(o,i,r,t),n=i)});let a=n?u7(n.name):null;return!a||a.length>1||a[0]!==j.outputType?this.makeTypeSafe(o,j.outputType):o}wrapInToResponsiveImage(j){return this.wrapInTransformFunction(j,CS,zj)}wrapInToImageSrc(j){return this.wrapInTransformFunction(j,vS,zj)}wrapInToZIndex(j){return this.wrapInTransformFunction(j,TS,zj)}wrapInNumberToPixelString(j){return this.wrapInTransformFunction(j,PS,zj)}wrapInRadiusForCorner(j,e){return this.wrapInTransformFunction(j,MS,[e])}wrapInToAxisOverflow(j,e){return this.wrapInTransformFunction(j,_S,[e])}wrapInAddImageAlt(j,e){return this.wrapInTransformFunction(j,OS,[e])}wrapInClampRGB(j){return E(this.imports,"ValueTransformCollector: Must have imports to wrap in clampColor."),q.fn(this.imports.addImport("framer",{exportSpecifier:"clampRGB"}),j)}wrapInGetGridColumnCSSValue(j,e){return this.wrapInTransformFunction(j,wS,e?[e]:zj)}wrapInGetGridRowCSSValue(j){return this.wrapInTransformFunction(j,LS,zj)}wrapInGetNumericColumnGap(j){return this.wrapInTransformFunction(j,qS,zj)}wrapInTemplateFilters(j,e){return this.makeTypeSafe(yu(j,e,{json:t=>this.wrapInTransformFunction(t,DS,zj),escape:t=>this.wrapInTransformFunction(t,NS,zj),raw:t=>this.wrapInTransformFunction(t,xS,zj)}),"string")}};function VS(A){return J(A)||ej(A)||rA(A)||Dr(A)||oj(A)}function Rg(A,j){return B`(key, locale){${B.joinLines(B`while (locale) {${B.joinLines(B`const values = ${A}[locale.id]`,B`if (values) {${B.joinLines(B`const value = ${j?B`values.read()[key]`:B`values[key]`}`,B`if (value) return value`)}}`,B`locale = locale.fallback`)}}`)}}`}var ei,Ts=class{constructor(j,e,t){this.entryNode=j;this.variables=e;this.treeStore=t;R(this,"cache",{});R(this,"valueCounter",0);xA(this,ei,!1)}freeze(){FA(this,ei,!0)}add(j,e,t){E(!tA(this,ei),"Cannot add values to a frozen LocalizedValuesCollector.");let r={};if(!e||!VS(this.entryNode))return j;let o;this.variables&&(o=new sn(this.entryNode));let n=this.treeStore.tree.root.locales??[];for(let d of n){if(!(d.id in e))continue;let p=this.createLocalizedValue(d.id,o,t);xe(p)||(r[d.id]=p)}if(me(r))return j;this.variables&&o&&this.variables.merge(o);let a=OA({defaultValue:j,localizedValues:r}),i=this.cache[a];if(i)return i;let s=`v${this.valueCounter++}`,c=q.fn(this.getLocalizedValueBinding,s,DA.activeLocale);if(o&&o.variables.size>0){let d=B.listFrom(o.variables);for(let p in r){let k=r[p];E(!xe(k),"Localized should not be null or undefined"),r[p]=B`({ ${d} }) => ${k}`}c=B`${c}?.({ ${d} })`}for(let d in r){let p=r[d];E(!xe(p),"Localized should not be null or undefined"),this.recordLocalizedValue(d,s,p)}return oA(j)||(c=B`${c} ?? ${j}`),this.cache[a]=c}};ei=new WeakMap;var xt,hg=class extends Ts{constructor(e,t,r,o,n,a,i,s){super(e,t,r);this.imports=o;this.declarations=n;this.fetches=a;this.modulesStore=i;this.moduleType=s;R(this,"submoduleByLocaleId",new Map);R(this,"identifier",`../${_e("localization",this.entryNode.id)}`);R(this,"submodules");R(this,"bindings",new ar);xA(this,xt);this.submodules=new Cs(this.moduleType,this.modulesStore,this.entryNode.id)}get getLocalizedValueBinding(){return this.imports.addImport(this.identifier,{exportSpecifier:"default",importBinding:"getLocalizedValue"})}canPreloadWithSuspense(){return!rA(this.entryNode)}preloadWithSuspense(){tA(this,xt)||(FA(this,xt,this.bindings.create("usePreloadLocalizedValues")),this.declarations.component.create(q.fn(this.imports.addImport(this.identifier,{exportSpecifier:OA(tA(this,xt))}),DA.activeLocale)))}createLocalizedValue(e,t,r){let o=this.submoduleByLocaleId.get(e)??this.submodules.create(),n=new to(this.entryNode,o.imports,o.bindings,t,this.treeStore,this.modulesStore),a=r(e,{links:n,variables:t,imports:o.imports,declarations:o.declarations,valueTransforms:new Nt(o.declarations,void 0,o.imports,t,this,n,this.fetches,this.modulesStore,this.moduleType)});if(xe(a)){o&&!this.submoduleByLocaleId.has(e)&&this.submodules.delete(o);return}return this.submoduleByLocaleId.set(e,o),this.canPreloadWithSuspense()&&this.preloadWithSuspense(),a}recordLocalizedValue(e,t,r){let o=this.submoduleByLocaleId.get(e);E(o,"Localization submodule must exist"),o.declarations.create(B`export const ${new q(t)} = ${r}`)}maybeGetUsePreloadDeclarations(e){if(!this.canPreloadWithSuspense()||!tA(this,xt))return[];let t=this.bindings.create("preload"),r=tA(this,xt);return[B`function ${t}(locale) {${B.joinLines(B`const promises = []`,B`while (locale) {${B.joinLines(B`const values = ${e}[locale.id]`,B`if (values) {${B.joinLines(B`const promise = values.preload()`,B`if (promise) promises.push(promise)`)}}`,B`locale = locale.fallback`)}}`,B`if (promises.length > 0) return Promise.all(promises)`)}}`,B`export function ${r}(locale) {${B.joinLines(B`const preloadPromise = ${t}(locale)`,B`if (preloadPromise) throw preloadPromise`)}}`]}values(e){let t={};for(let[r,o]of this.submoduleByLocaleId)if(this.canPreloadWithSuspense()){let n=e.addImport("framer",{exportSpecifier:"LazyValue"});t[r]=q.fn(B`new ${n}`,B`() => import(${o.submoduleImport})`)}else t[r]=e.addImport(o.submoduleImport,{exportSpecifier:"*",importBinding:"localizedValues"});return t}module(e){if(this.freeze(),(this.treeStore.tree.root.locales??[]).length===0||this.submoduleByLocaleId.size===0)return;let r=new sr(this.moduleType,this.modulesStore,this.bindings),o=new dr(this.bindings),n=o.dedupe("valuesByLocaleId",this.values(r));return{type:"localization",revision:e,source:B.joinSections(B.joinLines(...r.statements),...o.list(),B`export default function getLocalizedValue${Rg(n,this.canPreloadWithSuspense())}`,...this.maybeGetUsePreloadDeclarations(n)),artifacts:{submodules:this.submodules.serialize()}}}};xt=new WeakMap;var ti,ji=class extends Ts{constructor(e,t,r,o,n,a,i,s,c){super(e,t,r);this.imports=o;this.bindings=n;this.declarations=a;this.fetches=i;this.modulesStore=s;this.moduleType=c;R(this,"valuesByLocaleId",{});xA(this,ti)}get getLocalizedValueBinding(){return tA(this,ti)||FA(this,ti,this.bindings.create("getLocalizedValue")),tA(this,ti)}recordLocalizedValue(e,t,r){let o=this.valuesByLocaleId[e]??{};o[t]=r,this.valuesByLocaleId[e]=o}createLocalizedValue(e,t,r){let o=new to(this.entryNode,this.imports,this.bindings,t,this.treeStore,this.modulesStore);return r(e,{links:o,variables:t,imports:this.imports,declarations:this.declarations,valueTransforms:new Nt(this.declarations,void 0,this.imports,t,this,o,this.fetches,this.modulesStore,this.moduleType)})}list(){if(this.freeze(),(this.treeStore.tree.root.locales??[]).length===0)return[];let t=this.bindings.create("valuesByLocaleId");return[B`const ${t} = ${this.valuesByLocaleId}`,B`function ${this.getLocalizedValueBinding} ${Rg(t,!1)}`]}};ti=new WeakMap;var oi,ri=class{constructor(j,e,t,r,o,n,a){this.entryNode=j;this.treeStore=e;this.variables=t;this.declarations=r;this.bindings=o;this.imports=n;this.assets=a;xA(this,oi,new Map);R(this,"preloadDependencyTree",new Map)}command(j){let e=tA(this,oi).get(j);if(e)return e;let t=this.bindings.create("pre"+j);return tA(this,oi).set(j,t),t}addQuery(j,e,t){if(!rA(this.entryNode))return;let{destructured:r,dependencies:o}=this.getVariableDependencies(t),n=B`(${Fg(this.command("query"),r)}) => ${q.fn(this.command("query"),e)}`;this.addStatement("query",j,o,q.fn(this.declarations.dedupe("query",n),this.command("query"),r))}addFetch(j,e){if(!rA(this.entryNode))return;let{usedVariables:t}=od(e,this.variables);pA(e.controlProp.value)&&t.push(e.controlProp.value);let{destructured:r,dependencies:o}=this.getVariableDependencies(t),n=B`(${Fg(this.command("fetch"),r)}) => ${q.fn(this.command("fetch"),bs(e,this.variables,this.assets,void 0))}`;this.addStatement("fetch",j,o,q.fn(this.declarations.dedupe("query",n),this.command("fetch"),r))}createPromiseList({fetches:j,children:e},t=!1){let r=[];if(t)for(let o of j)r.push(o);for(let[,o]of e){for(let a of o.fetches)r.push(a);if(!o.value)continue;let n=o.value;if(o.children.size===0){r.push(n);continue}r.push(B`${n}.then(async collection => {await Promise.all(collection.flatMap((${US(o.usedVariables)}) => (${this.createPromiseList(o)})))})`)}return B`[${B.listFrom(r)}]`}getHook(){if(!rA(this.entryNode))return{variants:new Set,hook:void 0};let j={},e=[],t=new Set;for(let[k,$]of this.preloadDependencyTree){if($.children.size===0&&$.fetches.size===0||!$.variantHasAnyFetches)continue;t.add(k);let g=$.usedVariables.map(G=>this.variables.create(G));e.push(...g),j[k]=this.declarations.dedupe("preload",B`async (${this.command("query")}, ${this.command("fetch")}, ${ad(g)??B`props`}) => await Promise.all(${this.createPromiseList($,!0)})`)}if(!t.size)return{variants:new Set,hook:void 0};let r=this.declarations.dedupe("preloadStatements",j),o=this.imports.addImport("react",{exportSpecifier:"*",importBinding:"React"}),n=this.imports.addImport("framer",{exportSpecifier:"usePreloadQuery"}),a=this.imports.addImport("framer",{exportSpecifier:"usePrefetch"}),i=B`variant`,s=B`gestures`,c=B`clearLoadingVariant`,d=B`setGestureState`,p=this.declarations.dedupe("useLoadingVariant",B`(${i}, ${s}, ${c}, ${d}, props?: Record<string, unknown>) => {${B.joinLines(B`const prequery = ${q.fn(n)}`,B`const prefetch = ${q.fn(a)}`,B`${o}.useEffect(() => {${B.joinLines(B`const promise = ${r}[${i}]`,B`if (!promise || !${s}?.[${i}]?.loading) return`,B`promise(prequery, prefetch, props)`,B`.then(() => ${q.fn(c)})`,B`.catch(() => ${q.fn(d,{isError:!0})})`)}}, [${i}])`)}}`);return{variants:t,hook:k=>q.fn(p,DA.baseVariant,k,DA.clearLoadingGesture,DA.setGestureState,ad(e))}}addStatement(j,e,t,r){let o=this.treeStore.treeIndex.getGroundNodeIdFor(e.id),n=this.treeStore.tree.get(o);if(!n||!CA(n)||ga(n.gesture))return;let a=Ig(this.preloadDependencyTree,n.id);j==="fetch"&&(a.variantHasAnyFetches=!0);let i=t.get(this.entryNode.id);i&&a.usedVariables.push(...i);let s=a;for(let c of JS(e,t,j==="fetch")){let d=Ig(s.children,c);if(c===e.id){j==="query"&&(d.value=r),j==="fetch"&&d.fetches.add(r);for(let[k,$]of t){let g=d.dependencies.get(k)??[];g.push(...$),d.dependencies.set(k,g)}}let p=t.get(c);p&&d.usedVariables.push(...p),s.children.set(c,d),s=d}this.preloadDependencyTree.set(n.id,a)}getVariableDependencies(j){let e=[],t=new Map;for(let r of j)e.push(this.variables.create(r)),HS(t,r.providerId??this.entryNode.id,r);return{destructured:ad(e),dependencies:t}}};oi=new WeakMap;function JS(A,j,e){if(A.cache.ancestorRepeaterIds){if(e){let t=[...A.cache.ancestorRepeaterIds,A.id];for(let r=A.cache.ancestorRepeaterIds.length-1;r>=0;r--){let o=A.cache.ancestorRepeaterIds[r];if(o&&j.has(o))break;t.splice(r,1)}return t}return[...A.cache.ancestorRepeaterIds,A.id]}return[A.id]}function HS(A,j,e){let t=A.get(j)??[];t.push(e),A.set(j,t)}function QS(A){return{id:A,value:void 0,dependencies:new Map,usedVariables:[],children:new Map,fetches:new q.Set,variantHasAnyFetches:!1}}function Ig(A,j){return A.get(j)??QS(j)}function Fg(...A){let j=[];for(let e of A)e&&j.push(OA(e));return new q(j.join(", "))}function ad(A){if(A.length!==0)return A.reduce((j,e)=>(j[OA(e)]=e,j),{})}function US(A){return A.length===0?B``:A.reduce((j,e)=>(j[e.id]=pa(e.id,e.providerId,!1),j),new yj)}function sd(A,j){if(A===void 0)return"";let e=`<${j}>${A}</${j}>`,r=Ut(e).querySelector(j);return r instanceof HTMLElement?r.innerHTML:""}function Gg(A,j){let e={headStart:"",headEnd:"",bodyEnd:"",bodyStart:""};for(let t of zu){let r=[],o=A[t];if(o&&r.push(o),j)for(let n in j){let a=j[n]?.[t];a?.html&&!a.disabled&&r.push(`<!-- Plugin: ${n} --> ${a.html}`)}e[t]=r.map(n=>WS(n,t)).join(`
`)}return e}function WS(A,j){if(j==="headStart"||j==="headEnd")return sd(A,"head");if(j==="bodyStart"||j==="bodyEnd")return sd(A,"body");mi(j)}var ld=A=>A;function ArA(A){return A.filter(Zj)}var Ps=B`params`,Sg={type:"siteMetadata",localIdName:"siteMetadata",localId:_e("siteMetadata","siteMetadata")};function vrA(A){return{type:"webPageMetadata",localIdName:A,localId:_e("webPageMetadata",A)}}var TrA=ld(async(A,j)=>{let{assetMap:e,treeStore:t,modulesStore:r}=j,o=new Zn(e),n=new ar,a=new sr("siteMetadata",r,n),i=new sn(A),s=new dr(n),c=new to(A,a,n,void 0,t,r),d=new ri(A,t,i,s,n,a,o),p=new Ai(n,i,d,o,c),k=new ji(A,i,t,a,n,s,p,r,"siteMetadata"),$=new Nt(s,void 0,a,i,k,void 0,p,r,"siteMetadata"),g=bg(A,o,$,i,k,void 0,void 0);return[{type:"siteMetadata",revision:void 0,source:Cg(g,a,s,k,$,i,null),artifacts:{assets:o.keys}}]}),PrA=ld(async(A,j,e)=>{let{treeStore:t,modulesStore:r,assetMap:o}=j,{serializationId:n}=e,a=new Zn(o),i=new ar,s=new sr("webPageMetadata",r,i),c=new sn(A),d=new dr(i),p=new to(A,s,i,void 0,t,r),k=new ri(A,t,c,d,i,s,a),$=new Ai(i,c,k,a,p),g=new ji(A,c,t,s,i,d,$,r,"webPageMetadata"),G=new Nt(d,void 0,s,c,g,void 0,$,r,"webPageMetadata"),I=A.dataIdentifier?V.dataForIdentifier(A.dataIdentifier):null,S=bg(A,a,G,c,g,zS(t.tree,A,s),XS(s));S.viewport=await YS(A);let T=Object.entries(A.getBreakpointValues()).map(([P,_])=>({hash:ep(P),mediaQuery:Su(_)}));S.breakpoints=T;let v=qk(A);return S.elements=v,S.serializationId=n,[{type:"webPageMetadata",source:Cg(S,s,d,g,G,c,I),artifacts:{assets:a.keys},revision:A.moduleSourceRevision}]}),yg=/^[a-z_$][\w$]*$/i;function MrA(A){let j=new q.Set;function e(t){let r=Z6(),o=t.matchAll(r);for(let[,n]of o)n&&yg.test(n)&&j.add(new q(n))}for(let t in A.webMetadata){let r=t,o=A.webMetadata[r];switch(r){case"title":case"description":case"socialImage":M(o)&&e(o),pA(o)&&j.add(new q(o.id));break;case"favicon":case"faviconDark":case"appleTouchIcon":case"googleAnalyticsTrackingId":case"reducedMotion":case"language":case"languageTitle":case"noIndex":case"noIndexSite":case"canonicalURL":case"customCanonicalURL":case"optOutOfHTMLPlugin":case"automaticLocale":case"preserveQueryParams":case"enableFormsUTMTracking":case"editorBarDisabled":break;default:}}for(let t in A.customHTML){let r=t,o=A.customHTML[r];switch(r){case"headStart":case"headEnd":case"bodyStart":case"bodyEnd":M(o)&&e(o);break;default:}}if(A.titleLocalized)for(let t of Object.values(A.titleLocalized))M(t.value)&&e(t.value);if(A.descriptionLocalized)for(let t of Object.values(A.descriptionLocalized))M(t.value)&&e(t.value);return j}function bg(A,j,e,t,r,o,n){let a={},i=r.add(Ot(A,A.webMetadata?.title,e,t)??o,A.titleLocalized,(p,k)=>(E(k.variables),Ot(A,A.titleLocalized?.[p]?.value,k.valueTransforms,k.variables)));oA(i)||(a.title=i);let s=r.add(Ot(A,A.webMetadata?.description,e,t)??n,A.descriptionLocalized,(p,k)=>(E(k.variables),Ot(A,A.descriptionLocalized?.[p]?.value,k.valueTransforms,k.variables)));if(oA(s)||(a.description=s),A.webMetadata?.favicon){let p=j.resolve(A.webMetadata.favicon);E(p,"Favicon is not a valid asset reference"),a.favicon=p.src}let c=A.webMetadata?.socialImage;if(pA(c)){let p=Lj(c.id,A.id),k=t.create(p);a.socialImage=e.wrapInToImageSrc(k)}else if(c){let p=j.resolve(c);E(p,"Social image is not a valid asset reference"),a.socialImage=p.src}A.webMetadata?.noIndex===!0?a.robots="noindex":a.robots="max-image-preview:large",A.webMetadata?.noIndexSite!==void 0&&(a.framerSearch={index:!A.webMetadata?.noIndexSite});let d=Gg(A.customHTML??{},Dr(A)?A.pluginCustomHTML:void 0);if(d.headStart){let p=Ot(A,d.headStart,e,t,"escape");p&&(a.customHTMLHeadStart=p)}if(d.headEnd){let p=Ot(A,d.headEnd,e,t,"escape");p&&(a.customHTMLHeadEnd=p)}if(d.bodyStart){let p=Ot(A,d.bodyStart,e,t,"escape");p&&(a.customHTMLBodyStart=p)}if(d.bodyEnd){let p=Ot(A,d.bodyEnd,e,t,"escape");p&&(a.customHTMLBodyEnd=p)}return a}function Cg(A,j,e,t,r,o,n){let a=[];for(let s of o.variables){let c=B`${Ps}?.${s}`,d=n?.properties[String(s)];if(d&&d.type==="enum"){let k=r.wrapInValueTransform(c,{name:"enumToDisplayName"},d);c=B`${c} !== undefined ? ${k} : undefined`}let p=B`const ${s} = ${c}`;a.push(p)}let i=B.joinLines(B`export default function metadata(${Ps}, ${DA.activeLocale}) {`,...a,B`return ${A}`,B`}`);return B.joinSections(B.linesFrom(j.statements),...t.list(),...e.list(),i,B`export const metadataVersion = 1`)}function Ot(A,j,e,t,r){if(xe(j))return;let o=Z6();return nr.replaceAll(j,o,(n,a)=>{let[i,s]=bu(a,r);if(!yg.test(i))return n;let c=Lj(i,A.id),d=t.create(c),p=d;return p=e.wrapInTemplateFilters(p,s),B`${d} !== undefined ? ${p} : ${n}`})}function _rA(A,j,e){let t=e?.title,r=vg(A,j);return t||r}function zS(A,j,e){let t=e.addImport(`../${Sg.localId}`,{exportSpecifier:"default",importBinding:"siteMetadata"}),r=B`${t}(${Ps}, ${DA.activeLocale}).title`,o=vg(A,j);return B`${r} || ${o}`}function XS(A){let j=A.addImport(`../${Sg.localId}`,{exportSpecifier:"default",importBinding:"siteMetadata"});return B`${j}(${Ps}, ${DA.activeLocale}).description`}function vg(A,j){if(Dj(j)){let r=V.dataForIdentifier(j.dataIdentifier);if(r?.name)return r.name+" Detail"}let e=Vk(A,j);return mo(e??"/")}async function YS(A){if(J(A)){let j=A.isLoaded()?A:await A.load();return j?j.getReplicaVariants().length>0?"width=device-width":`width=${j.getPrimaryVariant().width}`:"width=device-width"}return"width=device-width"}function qrA(A){Jt(B6(A),"Array gallery control must be Array of Object controls");let j=A.control,e;for(let t in j.controls){Jt(!e,"Multiple item properties found in gallery control");let r=j.controls[t];Jt(r?.type==="responsiveimage"),e=[t,r]}return Jt(e,"Gallery control must have at least one item property"),e}function KrA(A,j){if(!p6(j)||!j.value)return;let e=j.value[A];if(e?.type==="image")return e}function VrA(A){return A?A.filter(j=>!ZS(j)):[]}function ZS(A){if(!p6(A)||!A.value)return!1;let j=Object.values(A.value);if(j.length!==1)return!1;let e=j[0];return yp(e)?oA(e.value):!1}function Tg(A){if(!B6(A))return!1;let j=Object.values(A.control.controls);return j.length!==1?!1:j[0]?.type==="responsiveimage"}function WrA(A){return`${A??"Field"} is required`}function zrA(A,j){return`Exceeded max length by ${Sk(A-j,"character","characters")}`}function XrA(A){return`Must have at least ${A.minCount} ${Pg(A)}`}function YrA(A){return`Must have at most ${A.maxCount} ${Pg(A)}`}var ZrA="Slug value is already taken and must be unique";function Pg(A){return Tg(A)?"images":"items"}export{wm as a,Gl as b,Hm as c,Zm as d,zy as e,oh as f,En as g,ih as h,tb as i,Ce as j,hv as k,fn as l,yl as m,Rv as n,jE as o,eE as p,Vv as q,$n as r,Jv as s,vh as t,Hv as u,Qv as v,Uv as w,Wv as x,zv as y,oT as z,nT as A,ve as B,iT as C,aT as D,sT as E,lT as F,cT as G,dT as H,_h as I,pT as J,iE as K,Pl as L,Br as M,FT as N,GT as O,Nh as P,Da as Q,sE as R,xT as S,Ml as T,OT as U,wT as V,LT as W,_l as X,qT as Y,Na as Z,XT as _,YT as $,ZT as aa,no as ba,oP as ca,dE as da,pE as ea,cP as fa,kE as ga,Vb as ha,Dm as ia,uE as ja,mE as ka,fE as la,Nm as ma,aC as na,Rl as oa,gl as pa,un as qa,eC as ra,tC as sa,hl as ta,Pa as ua,rC as va,xm as wa,Il as xa,lh as ya,mn as za,kC as Aa,Qm as Ba,VC as Ca,zm as Da,JC as Ea,HC as Fa,QC as Ga,UC as Ha,WC as Ia,zC as Ja,Av as Ka,BE as La,wa as Ma,HP as Na,U as Oa,La as Pa,hE as Qa,Cj as Ra,J_ as Sa,H_ as Ta,Q_ as Ua,U_ as Va,SE as Wa,yE as Xa,bE as Ya,rR as Za,PE as _a,wl as $a,hD as ab,qa as bb,LD as cb,Ka as db,qD as eb,NE as fb,xE as gb,OE as hb,Va as ib,KE as jb,Ha as kb,Qa as lb,io as mb,HE as nb,WE as ob,zE as pb,Wa as qb,Af as rb,jf as sb,Gx as tb,Mx as ub,ef as vb,Wx as wb,tf as xb,za as yb,Sn as zb,nf as Ab,af as Bb,A8 as Cb,lf as Db,Xa as Eb,Ya as Fb,yn as Gb,kf as Hb,ev as Ib,tv as Jb,Ym as Kb,Gh as Lb,Ma as Mb,DR as Nb,i1 as Ob,a1 as Pb,s1 as Qb,l1 as Rb,$f as Sb,uo as Tb,As as Ub,tt as Vb,mo as Wb,ew as Xb,gw as Yb,hw as Zb,Rw as _b,Iw as $b,XR as ac,YR as bc,ZR as cc,AI as dc,Fw as ec,Gw as fc,Sw as gc,yw as hc,bw as ic,If as jc,eI as kc,Cw as lc,vw as mc,Tw as nc,Pw as oc,Mw as pc,_w as qc,_a as rc,Sf as sc,Cn as tc,bf as uc,Cf as vc,Tf as wc,Pf as xc,b4 as yc,C4 as zc,Nf as Ac,wf as Bc,J4 as Cc,H4 as Dc,Q4 as Ec,U4 as Fc,W4 as Gc,ns as Hc,Lf as Ic,nI as Jc,qf as Kc,Vf as Lc,KL as Mc,VL as Nc,Jf as Oc,JL as Pc,Hf as Qc,Uf as Rc,Rq as Sc,ic as Tc,EI as Uc,Iq as Vc,Fq as Wc,Gq as Xc,Tn as Yc,Wf as Zc,Pn as _c,nc as $c,Sq as ad,yq as bd,bq as cd,Cq as dd,$I as ed,vq as fd,Tq as gd,Xf as hd,Yf as id,Zq as jd,A2 as kd,Zf as ld,A$ as md,e$ as nd,t$ as od,kc as pd,k$ as qd,WI as rd,Vc as sd,ZW as td,CG as ud,Jc as vd,QB as wd,UB as xd,Zn as yd,Ai as zd,Cs as Ad,g0 as Bd,h0 as Cd,y0 as Dd,Nt as Ed,hg as Fd,ri as Gd,Gg as Hd,ld as Id,ArA as Jd,Sg as Kd,vrA as Ld,TrA as Md,PrA as Nd,MrA as Od,_rA as Pd,vg as Qd,YS as Rd,qrA as Sd,KrA as Td,VrA as Ud,ZS as Vd,Tg as Wd,WrA as Xd,zrA as Yd,XrA as Zd,YrA as _d,ZrA as $d,YB as ae,ss as be,EJ as ce,fJ as de,Fr as ee,fH as fe,ds as ge,N$ as he,ps as ie,gF as je,L$ as ke,q$ as le,K$ as me,a5 as ne,P5 as oe,J$ as pe,H$ as qe,Q$ as re,M5 as se,_5 as te,D5 as ue,bF as ve,N5 as we,fo as xe,x5 as ye,O5 as ze,V$ as Ae,E$ as Be,iF as Ce,ls as De,uc as Ee,mc as Fe,H5 as Ge,Q5 as He,U5 as Ie,W5 as Je,z5 as Ke,X5 as Le,vF as Me,Y5 as Ne,U$ as Oe,hc as Pe,Z$ as Qe,AB as Re,Pt as Se,lQ as Te,Bo as Ue,cQ as Ve,tB as We,On as Xe,FQ as Ye,qF as Ze,GQ as _e,KF as $e,VF as af,Ic as bf,rB as cf,SQ as df,yQ as ef,qJ as ff,I$ as gf,F$ as hf,KJ as if,QF as jf,UF as kf,xQ as lf,G$ as mf,QJ as nf,_n as of,Tc as pf,Pc as qf,Mc as rf,aH as sf,sH as tf,T$ as uf,QU as vf,IB as wf,FB as xf,UU as yf,WU as zf,zU as Af,PB as Bf,_B as Cf,fG as Df,$G as Ef,M$ as Ff,Hc as Gf,_G as Hf,zB as If,NG as Jf,_$ as Kf,XB as Lf,OG as Mf,ZB as Nf,hz as Of,LG as Pf,Uc as Qf,qG as Rf,tX as Sf,EX as Tf,VG as Uf,JG as Vf,t0 as Wf,DX as Xf,r0 as Yf,i0 as Zf,UX as _f,a0 as $f,WX as ag,zX as bg,c0 as cg,k0 as dg,sS as eg,kS as fg,_Y as gg,wX as hg,WG as ig,Ss as jg,Ad as kg,VY as lg,Yc as mg,Zc as ng,jd as og,tZ as pg,rZ as qg};
//# sourceMappingURL=https://app.framerstatic.com/chunk-6JY3SS4N.mjs.map
